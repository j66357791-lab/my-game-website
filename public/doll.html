<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â®ÉÂ®ÉÁ≥ªÁªü - Â§©ÂàõÊó∂‰ª£</title>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* ËøôÈáå‰øùÊåÅÊÇ®ÂéüÊúâÁöÑÊâÄÊúâCSSÊ†∑Âºè‰∏çÂèò */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Quicksand', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #FFE5F1 0%, #FFD1DC 25%, #FFC0CB 50%, #FFB6C1 75%, #FFA07A 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Â¢ûÂº∫Âä®ÊÄÅËÉåÊôØÂ®ÉÂ®É */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        .bg-doll {
            position: absolute;
            font-size: 3rem;
            opacity: 0.2;
            animation-timing-function: ease-in-out;
            animation-iteration-count: infinite;
        }
        
        /* ‰∏çÂêåËøêÂä®ËΩ®ËøπÁöÑÂ®ÉÂ®É */
        .bg-doll.wave {
            animation: wave-motion 8s ease-in-out infinite;
        }
        
        @keyframes wave-motion {
            0%, 100% { transform: translateX(0) translateY(0) rotate(0deg); }
            25% { transform: translateX(30px) translateY(-20px) rotate(15deg); }
            50% { transform: translateX(60px) translateY(0) rotate(0deg); }
            75% { transform: translateX(30px) translateY(20px) rotate(-15deg); }
        }
        
        .bg-doll.jump {
            animation: jump-motion 6s ease-in-out infinite;
        }
        
        @keyframes jump-motion {
            0%, 100% { transform: translateY(0) scale(1); }
            25% { transform: translateY(-30px) scale(1.1); }
            50% { transform: translateY(-60px) scale(0.9); }
            75% { transform: translateY(-30px) scale(1.05); }
        }
        
        .bg-doll.spin {
            animation: spin-motion 10s linear infinite;
        }
        
        @keyframes spin-motion {
            from { transform: rotate(0deg) translateX(50px) rotate(0deg); }
            to { transform: rotate(360deg) translateX(50px) rotate(-360deg); }
        }
        
        .bg-doll.dance {
            animation: dance-motion 12s ease-in-out infinite;
        }
        
        @keyframes dance-motion {
            0%, 100% { transform: translateX(0) translateY(0) rotate(0deg) scale(1); }
            20% { transform: translateX(20px) translateY(-30px) rotate(30deg) scale(1.1); }
            40% { transform: translateX(-20px) translateY(-20px) rotate(-30deg) scale(0.9); }
            60% { transform: translateX(30px) translateY(10px) rotate(45deg) scale(1.05); }
            80% { transform: translateX(-30px) translateY(-10px) rotate(-45deg) scale(0.95); }
        }
        
        .bg-doll.float {
            animation: float-motion 15s ease-in-out infinite;
        }
        
        @keyframes float-motion {
            0% { transform: translateX(0) translateY(100vh) rotate(0deg); }
            25% { transform: translateX(25vw) translateY(75vh) rotate(90deg); }
            50% { transform: translateX(50vw) translateY(50vh) rotate(180deg); }
            75% { transform: translateX(75vw) translateY(25vh) rotate(270deg); }
            100% { transform: translateX(100vw) translateY(0) rotate(360deg); }
        }
        
        /* Á≤âËâ≤Ê≥°Ê≥°ËÉåÊôØ */
        .bubble {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 182, 193, 0.4));
            animation: bubble-float 15s infinite ease-in-out;
        }
        
        @keyframes bubble-float {
            0%, 100% {
                transform: translateY(100vh) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            50% {
                transform: translateY(50vh) scale(1);
                opacity: 0.3;
            }
            90% {
                opacity: 0.6;
            }
        }
        
        /* ‰∏ªÂÆπÂô® */
        .main-container {
            position: relative;
            z-index: 10;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* È°∂ÈÉ®ÂØºËà™Ê†è */
        .top-nav {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 240, 245, 0.95) 100%);
            border-radius: 30px;
            padding: 20px 30px;
            margin-bottom: 25px;
            box-shadow: 0 15px 35px rgba(255, 182, 193, 0.25);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 182, 193, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            animation: logo-bounce 2s ease-in-out infinite;
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
        }
        
        @keyframes logo-bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }
        
        .logo-text {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(45deg, #FF69B4, #FF1493, #FFA07A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(255, 105, 180, 0.2);
        }
        
        .nav-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 6px 15px rgba(255, 105, 180, 0.25);
            position: relative;
            overflow: hidden;
        }
        
        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .nav-btn:hover::before {
            left: 100%;
        }
        
        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 105, 180, 0.35);
        }
        
        .user-info {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 240, 245, 0.9));
            padding: 12px 20px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 6px 15px rgba(255, 182, 193, 0.2);
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #FFA07A, #FF69B4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 10px rgba(255, 160, 122, 0.3);
        }
        
        .user-details {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-weight: 600;
            color: #8B008B;
            font-size: 1rem;
        }
        
        .user-points {
            background: linear-gradient(135deg, #FFA500, #FF8C00);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.85rem;
            box-shadow: 0 3px 8px rgba(255, 165, 0, 0.3);
        }
        
        /* Ê†áÁ≠æÂØºËà™ */
        .tab-navigation {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95));
            border-radius: 25px;
            padding: 15px 20px;
            margin-bottom: 25px;
            box-shadow: 0 10px 25px rgba(255, 182, 193, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .tab-list {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .tab-item {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            color: #8B008B;
            border: 2px solid transparent;
            padding: 12px 22px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .tab-item::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #FF69B4, #FF1493);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .tab-item:hover::after {
            width: 80%;
        }
        
        .tab-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.3);
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
        }
        
        .tab-item.active {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border-color: #FF1493;
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.35);
        }
        
        .tab-item.active::after {
            width: 80%;
            background: white;
        }
        
        /* ÂÜÖÂÆπÂå∫Âüü */
        .content-area {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95));
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(255, 182, 193, 0.25);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 182, 193, 0.3);
            min-height: 500px;
        }
        
        .tab-content {
            display: none;
            animation: content-fade-in 0.5s ease-out;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes content-fade-in {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section-title {
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(45deg, #FF69B4, #FF1493, #FFA07A);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(255, 105, 180, 0.2);
        }
        
        .section-subtitle {
            color: #8B008B;
            font-size: 1.1rem;
            opacity: 0.8;
        }
        
        /* ÊàëÁöÑÂ®ÉÂ®ÉÁâàÂùó - ÂÆ∂Âõ≠È£éÊ†º */
        .doll-home {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 30px;
            padding: 40px;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }
        
        .doll-home::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 182, 193, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 105, 180, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .doll-shelf {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
            position: relative;
            z-index: 1;
        }
        
        .doll-spot {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.8), rgba(255, 240, 245, 0.8));
            border-radius: 25px;
            padding: 25px;
            text-align: center;
            border: 3px solid #FFD1DC;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(255, 182, 193, 0.2);
        }
        
        .doll-spot:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 0 20px 40px rgba(255, 182, 193, 0.35);
            border-color: #FF69B4;
        }
        
        /* 3DÂ®ÉÂ®ÉÂ±ïÁ§∫Âå∫Âüü */
        .doll-spot-display {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            position: relative;
            perspective: 1000px;
        }
        
        .doll-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: rotateY(15deg) rotateX(10deg);
        }
        
        .doll-spot:hover .doll-3d {
            transform: rotateY(25deg) rotateX(15deg) translateZ(10px);
        }
        
        .doll-3d-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backface-visibility: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .doll-3d-front {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            font-size: 3.5rem;
            transform: translateZ(20px);
        }
        
        .doll-3d-back {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            font-size: 2.5rem;
            transform: rotateY(180deg) translateZ(20px);
            color: #8B008B;
            font-weight: bold;
        }
        
        .doll-3d-side {
            background: linear-gradient(135deg, #FFB6C1, #FFA07A);
            transform: rotateY(90deg) translateZ(60px);
            width: 40px;
            height: 100%;
            border-radius: 20px;
        }
        
        .doll-3d-top {
            background: linear-gradient(135deg, #FFA07A, #FF69B4);
            transform: rotateX(90deg) translateZ(60px);
            width: 100%;
            height: 40px;
            border-radius: 20px;
        }
        
        /* 3DÂ®ÉÂ®ÉÂä®Áîª */
        @keyframes doll-float {
            0%, 100% { 
                transform: translateY(0) rotateY(15deg) rotateX(10deg);
            }
            50% { 
                transform: translateY(-10px) rotateY(25deg) rotateX(5deg);
            }
        }
        
        .doll-3d {
            animation: doll-float 6s ease-in-out infinite;
        }
        
        /* ‰∏çÂêåÁ∫ßÂà´ÁöÑÂ®ÉÂ®ÉÊ†∑Âºè */
        .doll-level-1 .doll-3d-front {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.4);
        }
        
        .doll-level-2 .doll-3d-front {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            box-shadow: 0 15px 30px rgba(255, 105, 180, 0.4);
        }
        
        .doll-level-3 .doll-3d-front {
            background: linear-gradient(135deg, #FFB6C1, #FFA07A);
            box-shadow: 0 15px 30px rgba(255, 20, 147, 0.4);
        }
        
        .doll-spot-info {
            color: #8B008B;
            font-weight: 600;
        }
        
        .doll-spot-name {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        
        .doll-spot-id {
            font-size: 0.85rem;
            color: #FF69B4;
            margin-bottom: 8px;
        }
        
        .doll-spot-earnings {
            background: linear-gradient(135deg, #FFA500, #FF8C00);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .empty-doll-spot {
            border: 3px dashed #FFD1DC;
            background: rgba(255, 182, 193, 0.05);
        }
        
        .empty-doll-spot .doll-spot-display {
            background: rgba(255, 182, 193, 0.1);
            font-size: 2rem;
            color: #FFD1DC;
        }
        
        /* ËÉåÂåÖÊåâÈíÆ - Êñ∞Â¢û */
        .bag-button-container {
            text-align: center;
            margin-top: 30px;
            position: relative;
            z-index: 1;
        }
        
        .bag-button {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 25px rgba(255, 105, 180, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .bag-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .bag-button:hover::before {
            left: 100%;
        }
        
        .bag-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 105, 180, 0.4);
        }
        
        .bag-button:active {
            transform: translateY(-1px);
        }
        
        /* ËÉåÂåÖÂºπÁ™ó - Êñ∞Â¢û */
        .bag-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .bag-modal.active {
            display: flex;
            animation: modal-fade-in 0.3s ease-out;
        }
        
        @keyframes modal-fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .bag-modal-content {
            background: linear-gradient(135deg, #2C3E50, #34495E);
            border-radius: 30px;
            padding: 30px;
            max-width: 1200px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 112, 67, 0.3);
            position: relative;
            animation: modal-slide-up 0.3s ease-out;
        }
        
        @keyframes modal-slide-up {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .bag-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 112, 67, 0.3);
        }
        
        .bag-modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bag-modal-close {
            background: none;
            border: none;
            color: #ECF0F1;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .bag-modal-close:hover {
            background: rgba(255, 112, 67, 0.2);
            transform: rotate(90deg);
        }
        
        /* ËÉåÂåÖÂÜÖÂÆπÂå∫Âüü */
        .bag-modal-body {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }
        
        .bag-modal-sidebar {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 20px;
            padding: 20px;
            height: fit-content;
        }
        
        .bag-modal-categories {
            margin-bottom: 20px;
        }
        
        .bag-modal-category-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bag-modal-category-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .bag-modal-category-item {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 112, 67, 0.2);
            border-radius: 10px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bag-modal-category-item:hover {
            background: rgba(255, 112, 67, 0.1);
            border-color: rgba(255, 112, 67, 0.4);
        }
        
        .bag-modal-category-item.active {
            background: linear-gradient(135deg, #FF7043, #FFB74D, #FFC107);
            border-color: #FF7043;
            color: white;
        }
        
        .bag-modal-category-icon {
            font-size: 1.1rem;
        }
        
        .bag-modal-category-name {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .bag-modal-category-count {
            margin-left: auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 8px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .bag-modal-stats {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 112, 67, 0.2);
            border-radius: 10px;
            padding: 15px;
        }
        
        .bag-modal-stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        
        .bag-modal-stat-item:last-child {
            margin-bottom: 0;
        }
        
        .bag-modal-stat-label {
            color: #ECF0F1;
            font-size: 0.9rem;
        }
        
        .bag-modal-stat-value {
            color: #FFC107;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .bag-modal-main {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 20px;
            padding: 20px;
        }
        
        .bag-modal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }
        
        .bag-modal-item {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 112, 67, 0.2);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .bag-modal-item:hover {
            background: rgba(255, 112, 67, 0.1);
            border-color: rgba(255, 112, 67, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 112, 67, 0.3);
        }
        
        .bag-modal-item.selected {
            background: rgba(255, 112, 67, 0.2);
            border-color: #FF7043;
            box-shadow: 0 0 20px rgba(255, 112, 67, 0.3);
        }
        
        .bag-modal-item-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }
        
        .bag-modal-item-name {
            font-weight: 600;
            color: white;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .bag-modal-item-count {
            color: #FFC107;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .bag-modal-item-quality {
            position: absolute;
            top: 5px;
            right: 5px;
            background: linear-gradient(135deg, #FF7043, #FFB74D, #FFC107);
            color: white;
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .bag-modal-item-quality.common {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
        }
        
        .bag-modal-item-quality.rare {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .bag-modal-item-quality.epic {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .bag-modal-item-quality.legendary {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        /* Â®ÉÂ®ÉÁâπÊÆäÊ†∑Âºè */
        .bag-modal-doll-item {
            position: relative;
        }
        
        .bag-modal-doll-level {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .bag-modal-doll-attributes {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.7rem;
            color: #FFC107;
        }
        
        /* Ë£ÖÂ§áÁâπÊÆäÊ†∑Âºè */
        .bag-modal-equipment-item {
            position: relative;
        }
        
        .bag-modal-equipment-slot {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        .bag-modal-equipment-bonus {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            color: #FFC107;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        /* Ë¥≠‰π∞Â®ÉÂ®ÉÁâàÂùó */
        .purchase-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .purchase-card {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 30px;
            padding: 30px;
            text-align: center;
            border: 3px solid #FFD1DC;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .purchase-card.featured {
            border: 3px solid #FF69B4;
            box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
        }
        
        .purchase-card.featured::before {
            content: 'üî• ÁÉ≠Èó®';
            position: absolute;
            top: -8px;
            right: 20px;
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 6px 15px rgba(255, 105, 180, 0.3);
            animation: featured-pulse 2s ease-in-out infinite;
        }
        
        @keyframes featured-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .purchase-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(255, 182, 193, 0.4);
        }
        
        .doll-preview {
            width: 120px;
            height: 120px;
            margin: 20px auto;
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            animation: preview-float 4s ease-in-out infinite;
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.3);
        }
        
        @keyframes preview-float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
        
        .doll-info-panel {
            background: rgba(255, 182, 193, 0.1);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 182, 193, 0.2);
        }
        
        .info-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .info-label {
            color: #8B008B;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .info-value {
            color: #FF69B4;
            font-weight: 700;
            font-size: 1rem;
        }
        
        .purchase-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            position: relative;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .purchase-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .purchase-btn:hover::before {
            left: 100%;
        }
        
        .purchase-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255, 105, 180, 0.4);
        }
        
        .purchase-btn:disabled {
            background: linear-gradient(135deg, #D3D3D3, #A9A9A9);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .stock-info {
            margin-top: 15px;
            padding: 12px;
            background: rgba(255, 182, 193, 0.1);
            border-radius: 15px;
        }
        
        .stock-text {
            color: #FF69B4;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .stock-progress {
            width: 100%;
            height: 12px;
            background: #FFE4E1;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .stock-bar {
            height: 100%;
            background: linear-gradient(90deg, #FF69B4, #FF1493);
            transition: width 0.5s ease;
            border-radius: 10px;
            position: relative;
        }
        
        .stock-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: stock-shine 2s ease-in-out infinite;
        }
        
        @keyframes stock-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        /* ÁöÆËÇ§ÂïÜÂüéÁâàÂùó */
        .skin-store-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .skin-categories {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .skin-category {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            color: #8B008B;
            border: 2px solid transparent;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .skin-category::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .skin-category:hover::before {
            left: 100%;
        }
        
        .skin-category.active {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border-color: #FF1493;
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.35);
        }
        
        .skin-category:hover:not(.active) {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.3);
        }
        
        .skin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px;
        }
        
        .skin-card {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 30px;
            padding: 30px;
            border: 2px solid #FFD1DC;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }
        
        .skin-card.featured::before {
            content: 'üî• ÈôêÈáè';
            position: absolute;
            top: 15px;
            right: -25px;
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            padding: 5px 30px;
            transform: rotate(45deg);
            font-weight: 600;
            font-size: 0.8rem;
            box-shadow: 0 4px 10px rgba(255, 105, 180, 0.3);
            animation: featured-pulse 2s ease-in-out infinite;
        }
        
        .skin-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 25px 50px rgba(255, 182, 193, 0.4);
        }
        
        .skin-preview {
            width: 180px;
            height: 180px;
            margin: 0 auto 25px;
            position: relative;
            perspective: 1000px;
        }
        
        .skin-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: rotateY(15deg) rotateX(10deg);
            animation: skin-rotate 10s linear infinite;
        }
        
        @keyframes skin-rotate {
            from { transform: rotateY(0deg) rotateX(0deg); }
            to { transform: rotateY(360deg) rotateX(0deg); }
        }
        
        .skin-card:hover .skin-3d {
            transform: rotateY(25deg) rotateX(15deg) translateZ(10px);
            animation-play-state: paused;
        }
        
        .skin-3d-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backface-visibility: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .skin-3d-front {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            font-size: 5rem;
            transform: translateZ(40px);
        }
        
        .skin-3d-back {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            font-size: 3rem;
            transform: rotateY(180deg) translateZ(40px);
            color: #8B008B;
            font-weight: bold;
        }
        
        .skin-3d-side {
            background: linear-gradient(135deg, #FFB6C1, #FFA07A);
            transform: rotateY(90deg) translateZ(90px);
            width: 50px;
            height: 100%;
            border-radius: 25px;
        }
        
        .skin-3d-top {
            background: linear-gradient(135deg, #FFA07A, #FF69B4);
            transform: rotateX(90deg) translateZ(90px);
            width: 100%;
            height: 50px;
            border-radius: 25px;
        }
        
        .skin-info {
            text-align: center;
        }
        
        .skin-name {
            font-size: 1.4rem;
            color: #8B008B;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .skin-description {
            color: #FF69B4;
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.4;
        }
        
        .skin-price {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .skin-original-price {
            color: #8B008B;
            text-decoration: line-through;
            font-size: 1rem;
        }
        
        .skin-current-price {
            color: #FF1493;
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .skin-stock {
            color: #8B008B;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .skin-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            justify-content: center;
        }
        
        .skin-preview-btn, .skin-detail-btn {
            background: linear-gradient(135deg, #87CEEB, #4682B4);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .skin-preview-btn:hover, .skin-detail-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(135, 206, 235, 0.3);
        }
        
        .skin-buy-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
        }
        
        .skin-buy-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .skin-buy-btn:hover::before {
            left: 100%;
        }
        
        .skin-buy-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 30px rgba(255, 105, 180, 0.4);
        }
        
        .skin-buy-btn:disabled {
            background: linear-gradient(135deg, #D3D3D3, #A9A9A9);
            cursor: not-allowed;
        }
        
        /* Â®ÉÂ®ÉÂÆ∂Âõ≠ÁâàÂùó */
        .home-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .home-layout {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
        }
        
        .home-sidebar {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 240, 245, 0.9));
            border-radius: 25px;
            padding: 25px;
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .home-main {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 25px;
            padding: 30px;
            border: 2px solid #FFD1DC;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .home-doll-display {
            width: 200px;
            height: 200px;
            position: relative;
            perspective: 1000px;
            margin-bottom: 30px;
        }
        
        .home-doll-3d {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform: rotateY(15deg) rotateX(10deg);
        }
        
        .home-doll-3d-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            backface-visibility: hidden;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
        }
        
        .home-doll-3d-front {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            font-size: 5rem;
            transform: translateZ(30px);
        }
        
        .home-doll-3d-back {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
            font-size: 3.5rem;
            transform: rotateY(180deg) translateZ(30px);
            color: #8B008B;
            font-weight: bold;
        }
        
        .home-doll-3d-side {
            background: linear-gradient(135deg, #FFB6C1, #FFA07A);
            transform: rotateY(90deg) translateZ(100px);
            width: 60px;
            height: 100%;
            border-radius: 30px;
        }
        
        .home-doll-3d-top {
            background: linear-gradient(135deg, #FFA07A, #FF69B4);
            transform: rotateX(90deg) translateZ(100px);
            width: 100%;
            height: 60px;
            border-radius: 30px;
        }
        
        .home-doll-name {
            font-size: 1.5rem;
            color: #8B008B;
            font-weight: 600;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .home-doll-id {
            color: #FF69B4;
            font-size: 1rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .home-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .home-feature {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            border: 1px solid #FFD1DC;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .home-feature:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.3);
        }
        
        .home-feature-icon {
            font-size: 2rem;
            margin-bottom: 8px;
        }
        
        .home-feature-name {
            font-size: 0.9rem;
            color: #8B008B;
            font-weight: 600;
        }
        
        .home-social {
            margin-top: 30px;
            text-align: center;
        }
        
        .social-title {
            font-size: 1.2rem;
            color: #FF1493;
            font-weight: 600;
            margin-bottom: 15px;
        }
        
        .social-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .social-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }
        
        .social-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
        }
        
        /* ÊäΩÂ•ñÁâàÂùó */
        .lottery-container {
            max-width: 900px;
            margin: 0 auto;
            text-align: center;
        }
        
        .blind-box-container {
            margin: 40px 0;
            position: relative;
        }
        
        .blind-box {
            width: 220px;
            height: 220px;
            margin: 0 auto;
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            box-shadow: 0 20px 40px rgba(255, 105, 180, 0.3);
        }
        
        .blind-box::before {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            background: linear-gradient(45deg, #FFD700, #FFA500, #FF69B4, #FF1493);
            border-radius: 30px;
            z-index: -1;
            animation: rainbow-border 3s ease-in-out infinite;
        }
        
        @keyframes rainbow-border {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        .blind-box:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 25px 50px rgba(255, 105, 180, 0.4);
        }
        
        .blind-box.shake {
            animation: shake-box 0.5s ease-in-out;
        }
        
        @keyframes shake-box {
            0%, 100% { transform: translateX(0) rotate(0deg); }
            25% { transform: translateX(-15px) rotate(-8deg); }
            75% { transform: translateX(15px) rotate(8deg); }
        }
        
        .blind-box.opening {
            animation: box-open 1s ease-in-out forwards;
        }
        
        @keyframes box-open {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(0) rotate(360deg); opacity: 0; }
        }
        
        .lottery-info {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 182, 193, 0.1));
            border-radius: 25px;
            padding: 25px;
            margin: 30px 0;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .lottery-cost {
            font-size: 1.8rem;
            font-weight: 700;
            color: #FF1493;
            margin-bottom: 15px;
        }
        
        .rare-dolls-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .rare-doll-item {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 223, 0, 0.1));
            border: 2px solid #FFD700;
            border-radius: 20px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .rare-doll-item.claimed {
            opacity: 0.5;
            border-color: #999;
        }
        
        .rare-doll-item.claimed::after {
            content: 'Â∑≤Ëé∑Âæó';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .rare-doll-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 215, 0, 0.3);
        }
        
        .rare-doll-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }
        
        .rare-doll-number {
            color: #8B008B;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 5px;
        }
        
        .rare-doll-status {
            font-size: 0.8rem;
            color: #FF69B4;
            font-weight: 500;
        }
        
        /* ÂêàÊàêÁâàÂùó */
        .synthesis-workshop {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .available-dolls {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 240, 245, 0.1));
            border-radius: 25px;
            padding: 25px;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .available-dolls-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #FF1493;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .available-dolls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .available-doll-item {
            background: white;
            border: 2px solid #FFD1DC;
            border-radius: 20px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .available-doll-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(255, 182, 193, 0.3);
        }
        
        .available-doll-item.selected {
            border: 2px solid #FF69B4;
            background: rgba(255, 105, 180, 0.1);
        }
        
        .available-doll-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }
        
        .available-doll-name {
            font-size: 0.9rem;
            color: #8B008B;
            font-weight: 600;
        }
        
        .synthesis-area {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 40px;
            align-items: center;
            margin: 40px 0;
        }
        
        .synthesis-slot {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 240, 245, 0.05));
            border: 3px dashed #FFD1DC;
            border-radius: 25px;
            padding: 30px;
            text-align: center;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }
        
        .synthesis-slot.filled {
            border: 3px solid #FF69B4;
            background: linear-gradient(135deg, rgba(255, 105, 180, 0.1), rgba(255, 20, 147, 0.1));
        }
        
        .synthesis-slot.selected {
            border: 3px solid #FFD700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .synthesis-slot:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(255, 182, 193, 0.3);
        }
        
        .synthesis-arrow {
            font-size: 3.5rem;
            color: #FF69B4;
            animation: arrow-pulse 2s ease-in-out infinite;
        }
        
        @keyframes arrow-pulse {
            0%, 100% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.2); opacity: 1; }
        }
        
        .synthesis-formula {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 240, 245, 0.1));
            border-radius: 25px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .formula-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #FF1493;
            margin-bottom: 20px;
        }
        
        .formula-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .formula-item {
            background: white;
            padding: 10px 15px;
            border-radius: 15px;
            border: 2px solid #FFD1DC;
            font-weight: 600;
            color: #8B008B;
            box-shadow: 0 4px 10px rgba(255, 182, 193, 0.2);
        }
        
        .formula-plus {
            font-size: 1.8rem;
            color: #FF69B4;
        }
        
        .success-rate-display {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            color: #006400;
            padding: 12px 25px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1.1rem;
            display: inline-block;
            margin: 15px 0;
            box-shadow: 0 6px 15px rgba(144, 238, 144, 0.3);
        }
        
        .cane-counter {
            background: linear-gradient(135deg, #8B4513, #A0522D);
            color: white;
            padding: 8px 16px;
            border-radius: 15px;
            font-weight: 600;
            margin-top: 10px;
            display: inline-block;
        }
        
        .synthesis-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .synthesis-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }
        
        .synthesis-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
        }
        
        .synthesis-btn:disabled {
            background: linear-gradient(135deg, #D3D3D3, #A9A9A9);
            cursor: not-allowed;
        }
        
        /* Â®ÉÂ®É‰πãÁéãÁâàÂùó */
        .doll-king-kingdom {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* Ê∏∏ÊàèÁªüËÆ°‰ø°ÊÅØ */
        .game-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            border: 2px solid #FFD1DC;
        }
        
        .stat-value {
            font-size: 1.5rem;
            color: #FF1493;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #FF6B6B;
            font-size: 0.9rem;
        }
        
        /* Ê∏∏Êàè‰∏ªÂÆπÂô® */
        .game-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-top: 30px;
        }
        
        /* Ê∏∏ÊàèÁä∂ÊÄÅÈù¢Êùø */
        .game-status-panel {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 240, 245, 0.95));
            border-radius: 25px;
            padding: 25px;
            border: 2px solid rgba(255, 182, 193, 0.3);
            box-shadow: 0 10px 25px rgba(255, 182, 193, 0.2);
        }
        
        .game-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid rgba(255, 182, 193, 0.3);
            padding-bottom: 15px;
        }
        
        .game-tab {
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            color: #8B008B;
            border: none;
            padding: 10px 20px;
            border-radius: 15px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .game-tab.active {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border-color: #FF1493;
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.35);
        }
        
        .game-tab:hover:not(.active) {
            background: linear-gradient(135deg, #FFC0CB, #FFB6C1);
        }
        
        /* Â±ûÊÄßËÆ≠ÁªÉÂå∫Âüü */
        .training-section {
            display: none;
        }
        
        .training-section.active {
            display: block;
            animation: content-fade-in 0.5s ease-out;
        }
        
        .training-grid {
            display: grid;
            gap: 15px;
        }
        
        .training-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            border: 2px solid #FFD1DC;
            transition: all 0.3s ease;
        }
        
        .training-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 182, 193, 0.3);
        }
        
        .training-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .training-name {
            font-size: 1.1rem;
            color: #8B008B;
            font-weight: 600;
        }
        
        .training-value {
            font-size: 1.2rem;
            color: #FF1493;
            font-weight: 700;
        }
        
        .training-progress {
            height: 8px;
            background: #FFE4E1;
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .training-progress-bar {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .strength-bar { background: linear-gradient(90deg, #FF6B6B, #FF8E53); }
        .agility-bar { background: linear-gradient(90deg, #4CAF50, #8BC34A); }
        .intelligence-bar { background: linear-gradient(90deg, #2196F3, #03A9F4); }
        .defense-bar { background: linear-gradient(90deg, #FF9800, #FFC107); }
        .luck-bar { background: linear-gradient(90deg, #9C27B0, #E91E63); }
        
        .training-cost {
            color: #FF69B4;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        
        .train-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .train-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
        }
        
        .train-btn:disabled {
            background: linear-gradient(135deg, #D3D3D3, #A9A9A9);
            cursor: not-allowed;
        }
        
        /* ÂÖ≥Âç°ÊåëÊàòÂå∫Âüü */
        .levels-section {
            display: none;
        }
        
        .levels-section.active {
            display: block;
            animation: content-fade-in 0.5s ease-out;
        }
        
        .levels-grid {
            display: grid;
            gap: 20px;
        }
        
        .level-card {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #FFD1DC;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .level-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.3);
        }
        
        .level-card.locked {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .level-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .level-name {
            font-size: 1.2rem;
            color: #8B008B;
            font-weight: 600;
        }
        
        .level-difficulty {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .level-requirements {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .level-req-item {
            color: #8B008B;
        }
        
        .level-req-value {
            color: #FF69B4;
            font-weight: 600;
        }
        
        .level-rewards {
            background: rgba(255, 182, 193, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .reward-title {
            color: #8B008B;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .reward-items {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .reward-item {
            background: white;
            padding: 5px 10px;
            border-radius: 10px;
            border: 1px solid #FFD1DC;
            font-size: 0.8rem;
            color: #FF69B4;
        }
        
        .challenge-btn {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s ease;
        }
        
        .challenge-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
        }
        
        .challenge-btn:disabled {
            background: linear-gradient(135deg, #D3D3D3, #A9A9A9);
            cursor: not-allowed;
        }
        
        /* Ë£ÖÂ§áÁÆ°ÁêÜÂå∫Âüü */
        .equipment-section {
            display: none;
        }
        
        .equipment-section.active {
            display: block;
            animation: content-fade-in 0.5s ease-out;
        }
        
        .equipment-slots {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .equipment-slot {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 240, 245, 0.9));
            border: 3px solid #FFD1DC;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .equipment-slot:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.3);
            border-color: #FF69B4;
        }
        
        .equipment-slot.equipped {
            border: 3px solid #FFD700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(255, 165, 0, 0.1));
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }
        
        .equipment-slot.equipped::after {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 5px;
            background: #FFD700;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .equipment-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .equipment-name {
            font-size: 0.9rem;
            color: #8B008B;
            font-weight: 600;
        }
        
        .equipment-stats {
            font-size: 0.8rem;
            color: #FF69B4;
            margin-top: 5px;
        }
        
        .king-doll-showcase {
            margin: 40px 0;
            position: relative;
        }
        
        .king-doll-display {
            width: 250px;
            height: 250px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, #FFD700, #FFA500);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 6rem;
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.4);
            animation: king-glow 3s ease-in-out infinite;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .king-doll-display.equipped {
            background: linear-gradient(135deg, #FF1493, #FF69B4);
            box-shadow: 0 25px 50px rgba(255, 20, 147, 0.4);
        }
        
        .king-doll-display::before {
            content: '';
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.3), transparent 70%);
            border-radius: 50%;
            animation: king-aura 2s ease-in-out infinite;
        }
        
        @keyframes king-glow {
            0%, 100% { box-shadow: 0 20px 40px rgba(255, 215, 0, 0.4); }
            50% { box-shadow: 0 25px 50px rgba(255, 215, 0, 0.6); }
        }
        
        @keyframes king-aura {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }
        
        .king-doll-info {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .king-doll-name {
            font-size: 1.5rem;
            color: #8B008B;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .king-doll-id {
            color: #FF69B4;
            font-size: 1rem;
        }
        
        .combat-power-section {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 142, 83, 0.1));
            border-radius: 30px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255, 107, 107, 0.3);
        }
        
        .combat-power-title {
            font-size: 1.8rem;
            color: #FF6B6B;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .combat-power-display {
            background: linear-gradient(135deg, #FF6B6B, #FF8E53);
            color: white;
            padding: 20px 40px;
            border-radius: 25px;
            font-size: 2rem;
            font-weight: 700;
            display: inline-block;
            margin: 20px 0;
            box-shadow: 0 10px 25px rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .combat-power-display::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: power-shine 3s ease-in-out infinite;
        }
        
        @keyframes power-shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .power-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .power-stat {
            background: white;
            padding: 15px;
            border-radius: 20px;
            border: 2px solid #FFD1DC;
            text-align: center;
        }
        
        .power-stat-label {
            color: #8B008B;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .power-stat-value {
            color: #FF69B4;
            font-weight: 600;
            font-size: 1.5rem;
        }
        
        /* Â®ÉÂ®É‰πãÁéãÂ±ûÊÄßÂ±ïÁ§∫ */
        .doll-king-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .king-doll-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 240, 245, 0.9));
            border-radius: 15px;
            padding: 20px;
            color: #8B008B;
            text-align: center;
            box-shadow: 0 5px 15px rgba(255, 182, 193, 0.1);
            transition: transform 0.3s ease;
        }
        
        .king-doll-card:hover {
            transform: translateY(-5px);
        }
        
        .king-doll-image {
            width: 120px;
            height: 120px;
            margin: 0 auto 15px;
            background: linear-gradient(135deg, #FFD1DC, #FFC0CB);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
        }
        
        .king-doll-name {
            font-size: 1.2rem;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .king-attributes {
            margin-top: 15px;
            text-align: left;
        }
        
        .king-attribute {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }
        
        .king-attribute-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-top: 2px;
            overflow: hidden;
        }
        
        .king-attribute-fill {
            height: 100%;
            border-radius: 4px;
        }
        
        .strength-fill { background: #ff5252; }
        .agility-fill { background: #4caf50; }
        .intelligence-fill { background: #2196f3; }
        .luck-fill { background: #ff9800; }
        
        /* ÂàÜÁ∫¢ÁâàÂùó */
        .dividend-lounge {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .dividend-info-card {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #8B008B;
            padding: 35px;
            border-radius: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .dividend-info-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            animation: rotate-glow 20s linear infinite;
        }
        
        @keyframes rotate-glow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .dividend-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .dividend-amount {
            font-size: 2.5rem;
            font-weight: 700;
            color: #8B008B;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
        }
        
        .dividend-period {
            font-size: 1.1rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .dividend-history {
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 240, 245, 0.1));
            border-radius: 25px;
            padding: 25px;
            border: 2px solid rgba(255, 182, 193, 0.3);
        }
        
        .history-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #FF1493;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .history-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: white;
            border-radius: 15px;
            border: 1px solid #FFD1DC;
            transition: all 0.3s ease;
        }
        
        .history-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(255, 182, 193, 0.2);
        }
        
        .history-item:last-child {
            margin-bottom: 0;
        }
        
        .history-date {
            color: #8B008B;
            font-weight: 600;
        }
        
        .history-amount {
            color: #FF69B4;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        .qualification-badge {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 20px;
            box-shadow: 0 6px 15px rgba(255, 215, 0, 0.3);
        }
        
        /* Â®ÉÂ®É‰πãÁéãË∑≥ËΩ¨ÊåâÈíÆ */
        .king-redirect-btn {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
            position: relative;
            overflow: hidden;
            margin: 20px auto;
            display: inline-block;
        }
        
        .king-redirect-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .king-redirect-btn:hover::before {
            left: 100%;
        }
        
        .king-redirect-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(255, 215, 0, 0.4);
        }
        
        .king-redirect-btn:active {
            transform: translateY(-1px);
        }
        
        /* Ê®°ÊÄÅÊ°Ü */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .modal.active {
            display: flex;
            animation: modal-fade-in 0.3s ease-out;
        }
        
        @keyframes modal-fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .modal-content {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 30px;
            padding: 40px;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
            border: 3px solid #FFD1DC;
            position: relative;
            animation: modal-slide-up 0.3s ease-out;
        }
        
        @keyframes modal-slide-up {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #FFD1DC;
        }
        
        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #FF1493;
        }
        
        .close-btn {
            background: none;
            border: none;
            color: #FF69B4;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-btn:hover {
            background: rgba(255, 105, 180, 0.1);
            transform: rotate(90deg);
        }
        
        .rules-content {
            color: #8B008B;
            line-height: 1.8;
        }
        
        .rules-section {
            margin-bottom: 25px;
        }
        
        .rules-section h3 {
            color: #FF1493;
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: 600;
        }
        
        .rules-section ul {
            margin-left: 25px;
        }
        
        .rules-section li {
            margin-bottom: 10px;
            position: relative;
        }
        
        .rules-section li::before {
            content: 'üéÄ';
            position: absolute;
            left: -20px;
        }
        
        /* Ê¥ªÂä®È°µÈù¢ */
        .activities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .activity-card {
            background: linear-gradient(135deg, #FFF0F5, #FFE4E1);
            border-radius: 25px;
            padding: 25px;
            border: 2px solid #FFD1DC;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, #FF69B4, #FF1493, #FFA07A);
            animation: activity-bar 3s ease-in-out infinite;
        }
        
        @keyframes activity-bar {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }
        
        .activity-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(255, 182, 193, 0.3);
        }
        
        .activity-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #FF1493;
            margin-bottom: 15px;
        }
        
        .activity-description {
            color: #8B008B;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .activity-time {
            color: #FF69B4;
            font-weight: 500;
            font-size: 0.9rem;
        }
        
        /* Ê∂àÊÅØÊèêÁ§∫ */
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 20px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            animation: message-slide-in 0.3s ease-out;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 300px;
        }
        
        @keyframes message-slide-in {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .message.success {
            background: linear-gradient(135deg, #90EE90, #98FB98);
            color: #006400;
        }
        
        .message.error {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
        }
        
        .message.info {
            background: linear-gradient(135deg, #87CEEB, #4682B4);
            color: white;
        }
        
        /* ÊàòÊñóÁªìÊûúÊ®°ÊÄÅÊ°Ü */
        .battle-result {
            text-align: center;
            padding: 20px;
        }
        
        .battle-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out infinite;
        }
        
        .battle-title {
            font-size: 1.8rem;
            color: #FF1493;
            margin-bottom: 15px;
        }
        
        .battle-rewards {
            background: rgba(255, 182, 193, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
        }
        
        /* ÂìçÂ∫îÂºè */
        @media (max-width: 768px) {
            .top-nav {
                flex-direction: column;
                gap: 15px;
            }
            
            .logo-text {
                font-size: 1.8rem;
            }
            
            .nav-buttons {
                justify-content: center;
            }
            
            .tab-list {
                justify-content: flex-start;
                overflow-x: auto;
                padding-bottom: 10px;
            }
            
            .tab-item {
                white-space: nowrap;
                font-size: 0.85rem;
                padding: 10px 15px;
            }
            
            .synthesis-area {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .synthesis-arrow {
                transform: rotate(90deg);
            }
            
            .home-layout {
                grid-template-columns: 1fr;
            }
            
            .skin-grid {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .doll-spot-display {
                width: 100px;
                height: 100px;
            }
            
            .doll-3d-front {
                font-size: 2.5rem;
            }
            
            .doll-3d-back {
                font-size: 1.8rem;
            }
            
            .skin-preview {
                width: 100px;
                height: 100px;
            }
            
            .skin-3d-front {
                font-size: 3rem;
            }
            
            .skin-3d-back {
                font-size: 2.2rem;
            }
            
            .home-doll-display {
                width: 150px;
                height: 150px;
            }
            
            .home-doll-3d-front {
                font-size: 4rem;
            }
            
            .home-doll-3d-back {
                font-size: 2.5rem;
            }
            
            .king-doll-display {
                width: 200px;
                height: 200px;
                font-size: 5rem;
            }
            
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .game-tabs {
                flex-wrap: wrap;
            }
            
            .equipment-slots {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .bag-modal-body {
                grid-template-columns: 1fr;
            }
            
            .bag-modal-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Â¢ûÂº∫Âä®ÊÄÅËÉåÊôØ -->
    <div class="bg-animation" id="bgAnimation"></div>
    
    <!-- ‰∏ªÂÆπÂô® -->
    <div class="main-container">
        <!-- È°∂ÈÉ®ÂØºËà™ -->
        <nav class="navbar">
            <div class="nav-container">
                <div class="logo-section">
                    <div class="logo-icon">üéÆ</div>
                    <div class="logo-text">Â§©ÂàõÊó∂‰ª£</div>
                </div>
                
                <div class="nav-right">
                    <!-- Êï∞ÊçÆÊ∫êÂàáÊç¢ÊåâÈíÆ -->
                    <button class="data-source-toggle" id="dataSourceToggle" onclick="toggleDataSource()">
                        <i class="fas fa-database"></i>
                        <span id="dataSourceText">Êú¨Âú∞Ê®°Âºè</span>
                    </button>
                    
                    <div class="settings-btn" id="settingsBtn">
                        <i class="fas fa-cog"></i>
                    </div>
                    
                    <div class="user-info" id="userInfo">
                        <div class="user-avatar">üë§</div>
                        <div class="user-details">
                            <div class="user-name" id="userName">Áé©ÂÆ∂</div>
                            <div class="user-points">üí∞ <span id="userPoints">0</span></div>
                        </div>
                        
                        <div class="user-dropdown">
                            <a href="index.html" class="user-dropdown-item">
                                <i class="fas fa-home"></i>
                                <span>ËøîÂõûÈ¶ñÈ°µ</span>
                            </a>
                            <a href="user-center.html" class="user-dropdown-item">
                                <i class="fas fa-user"></i>
                                <span>‰∏™‰∫∫ËµÑÊñô</span>
                            </a>
                            <a href="achievements.html" class="user-dropdown-item">
                                <i class="fas fa-trophy"></i>
                                <span>ÊàêÂ∞±</span>
                            </a>
                            <a href="inventory.html" class="user-dropdown-item">
                                <i class="fas fa-box"></i>
                                <span>Áâ©ÂìÅÊ†è</span>
                            </a>
                            <a href="bag.html" class="user-dropdown-item">
                                <i class="fas fa-shopping-bag"></i>
                                <span>ÊàëÁöÑËÉåÂåÖ</span>
                            </a>
                            <a href="mall.html" class="user-dropdown-item">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Â§©ÂàõÂïÜÂüé</span>
                            </a>
                            <a href="market.html" class="user-dropdown-item">
                                <i class="fas fa-store"></i>
                                <span>‰∫§ÊòìÂ∏ÇÂú∫</span>
                            </a>
                            <a href="dice.html" class="user-dropdown-item">
                                <i class="fas fa-dice"></i>
                                <span>Âπ∏ËøêÈ™∞Â≠ê</span>
                            </a>
                            <a href="grandma.html" class="user-dropdown-item">
                                <i class="fas fa-skull"></i>
                                <span>ÊÅêÊÄñÂ•∂Â•∂</span>
                            </a>
                            
                            <div class="user-dropdown-divider"></div>
                            
                            <a href="#" class="user-dropdown-item" id="logoutBtn">
                                <i class="fas fa-sign-out-alt"></i>
                                <span>ÈÄÄÂá∫ÁôªÂΩï</span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </nav>
        
        <!-- Ê†áÁ≠æÂØºËà™ -->
        <div class="tab-navigation">
            <div class="tab-list">
                <button class="tab-item active" onclick="switchTab('my-dolls')">üè† ÊàëÁöÑÂ®ÉÂ®É</button>
                <button class="tab-item" onclick="switchTab('purchase')">üõçÔ∏è Ë¥≠‰π∞Â®ÉÂ®É</button>
                <button class="tab-item" onclick="switchTab('skin-store')">üé® ÁöÆËÇ§ÂïÜÂüé</button>
                <button class="tab-item" onclick="switchTab('doll-home')">üè° Â®ÉÂ®ÉÂÆ∂Âõ≠</button>
                <button class="tab-item" onclick="switchTab('lottery')">üéÅ Á®ÄÊúâÊäΩÂ•ñ</button>
                <button class="tab-item" onclick="switchTab('synthesis')">‚öóÔ∏è Â®ÉÂ®ÉÂêàÊàê</button>
                <button class="tab-item" onclick="switchTab('doll-king')">üëë Â®ÉÂ®É‰πãÁéã</button>
                <button class="tab-item" onclick="switchTab('dividend')">üíé Á®ÄÊúâÂàÜÁ∫¢</button>
            </div>
        </div>
        
        <!-- ÂÜÖÂÆπÂå∫Âüü -->
        <div class="content-area">
            <!-- ÊàëÁöÑÂ®ÉÂ®ÉÁâàÂùó -->
            <div id="my-dolls" class="tab-content active">
                <div class="section-header">
                    <h2 class="section-title">üè† ÊàëÁöÑÂ®ÉÂ®ÉÊî∂Ëóè</h2>
                    <p class="section-subtitle">Âú®ËøôÈáåÊü•ÁúãÊÇ®Êã•ÊúâÁöÑÊâÄÊúâÂ®ÉÂ®É</p>
                </div>
                
                <div class="doll-home">
                    <div class="doll-shelf" id="dollShelf">
                        <!-- Â®ÉÂ®ÉÂ±ïÁ§∫Êû∂ -->
                    </div>
                    
                    <!-- ËÉåÂåÖÊåâÈíÆ - Êñ∞Â¢û -->
                    <div class="bag-button-container">
                        <button class="bag-button" onclick="openBagModal()">
                            <i class="fas fa-shopping-bag"></i>
                            <span>ÊâìÂºÄËÉåÂåÖ</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Ë¥≠‰π∞Â®ÉÂ®ÉÁâàÂùó -->
            <div id="purchase" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üõçÔ∏è Â®ÉÂ®ÉÂïÜÂ∫ó</h2>
                    <p class="section-subtitle">ÈÄâÊã©ÊÇ®ÂñúÊ¨¢ÁöÑÂ®ÉÂ®ÉÂºÄÂßãÊî∂ÈõÜ‰πãÊóÖ</p>
                </div>
                
                <div class="purchase-grid">
                    <!-- ‰∏ÄÁ∫ßÂ®ÉÂ®É -->
                    <div class="purchase-card featured">
                        <div class="doll-preview">üß∏</div>
                        <h3 style="color: #8B008B; font-size: 1.4rem; margin-bottom: 15px;">ÂèØÁà±ÂÖ•Èó®Ê¨æ</h3>
                        <div class="doll-info-panel">
                            <div class="info-row">
                                <span class="info-label">üí∞ ‰ª∑Ê†º</span>
                                <span class="info-value">50 Â§©ÂàõÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üíé ÊØèÊó•Êî∂Áõä</span>
                                <span class="info-value">0.84-0.92 ÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">‚è∞ Â≠òÊ¥ªÊó∂Èïø</span>
                                <span class="info-value">60 Â§©</span>
                            </div>
                        </div>
                        <button class="purchase-btn" onclick="purchaseDoll(1)">Á´ãÂç≥Ë¥≠‰π∞</button>
                        <div class="stock-info">
                            <div class="stock-text">Ââ©‰ΩôÂ∫ìÂ≠ò: <span id="level1Stock">200</span>/500</div>
                            <div class="stock-progress">
                                <div class="stock-bar" id="level1StockBar" style="width: 40%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ‰∫åÁ∫ßÂ®ÉÂ®É -->
                    <div class="purchase-card">
                        <div class="doll-preview">üéÄ</div>
                        <h3 style="color: #8B008B; font-size: 1.4rem; margin-bottom: 15px;">Á≤æÁæéÂçáÁ∫ßÊ¨æ</h3>
                        <div class="doll-info-panel">
                            <div class="info-row">
                                <span class="info-label">üí∞ ‰ª∑Ê†º</span>
                                <span class="info-value">200 Â§©ÂàõÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üíé ÊØèÊó•Êî∂Áõä</span>
                                <span class="info-value">3.05-3.25 ÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">‚è∞ Â≠òÊ¥ªÊó∂Èïø</span>
                                <span class="info-value">70 Â§©</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üìã Ë¥≠‰π∞Ë¶ÅÊ±Ç</span>
                                <span class="info-value">‰∏ÄÁ∫ßÂ®ÉÂ®É‚â•10Âè™</span>
                            </div>
                        </div>
                        <button class="purchase-btn" onclick="purchaseDoll(2)" disabled>ÊöÇÊú™ÂºÄÊîæ</button>
                        <div class="stock-info">
                            <div class="stock-text">ÈúÄË¶ÅÈÄöËøáÂêàÊàêËé∑Âæó</div>
                        </div>
                    </div>
                    
                    <!-- ‰∏âÁ∫ßÂ®ÉÂ®É -->
                    <div class="purchase-card">
                        <div class="doll-preview">üëë</div>
                        <h3 style="color: #8B008B; font-size: 1.4rem; margin-bottom: 15px;">Ë±™ÂçéÁ§ºÈÅáÊ¨æ</h3>
                        <div class="doll-info-panel">
                            <div class="info-row">
                                <span class="info-label">üí∞ ‰ª∑Ê†º</span>
                                <span class="info-value">500 Â§©ÂàõÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üíé ÊØèÊó•Êî∂Áõä</span>
                                <span class="info-value">6-6.3 ÁßØÂàÜ</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">‚è∞ Â≠òÊ¥ªÊó∂Èïø</span>
                                <span class="info-value">90 Â§©</span>
                            </div>
                            <div class="info-row">
                                <span class="info-label">üìã Ë¥≠‰π∞Ë¶ÅÊ±Ç</span>
                                <span class="info-value">‰∏ÄÁ∫ß‚â•20Âè™ ‰∫åÁ∫ß‚â•10Âè™</span>
                            </div>
                        </div>
                        <button class="purchase-btn" onclick="purchaseDoll(3)" disabled>ÊöÇÊú™ÂºÄÊîæ</button>
                        <div class="stock-info">
                            <div class="stock-text">ÈúÄË¶ÅÈÄöËøáÂêàÊàêËé∑Âæó</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÁöÆËÇ§ÂïÜÂüéÁâàÂùó -->
            <div id="skin-store" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üé® Â®ÉÂ®ÉÁöÆËÇ§ÂïÜÂüé</h2>
                    <p class="section-subtitle">‰∏∫ÊÇ®ÁöÑÂ®ÉÂ®ÉË¥≠‰π∞Á≤æÁæéÁöÆËÇ§ÔºåÂ±ïÁé∞Áã¨Áâπ‰∏™ÊÄß</p>
                </div>
                
                <div class="skin-store-container">
                    <div class="skin-categories">
                        <div class="skin-category active" onclick="filterSkins('all')">ÂÖ®ÈÉ®ÁöÆËÇ§</div>
                        <div class="skin-category" onclick="filterSkins('bear')">ÁÜäÂ§ßÁÜä‰∫åÁ≥ªÂàó</div>
                        <div class="skin-category" onclick="filterSkins('festival')">ËäÇÊó•ÈôêÂÆö</div>
                        <div class="skin-category" onclick="filterSkins('rare')">Á®ÄÊúâÁèçËóè</div>
                    </div>
                    
                    <div class="skin-grid" id="skinGrid">
                        <!-- ÁöÆËÇ§Âç°ÁâáÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
            
            <!-- Â®ÉÂ®ÉÂÆ∂Âõ≠ÁâàÂùó -->
            <div id="doll-home" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üè° Â®ÉÂ®ÉÂÆ∂Âõ≠</h2>
                    <p class="section-subtitle">ÊâìÈÄ†Â±û‰∫éÊÇ®ÂíåÂ®ÉÂ®ÉÁöÑÊ∏©È¶®ÂÆ∂Âõ≠</p>
                </div>
                
                <div class="home-container">
                    <div class="home-layout">
                        <div class="home-sidebar">
                            <h3 style="color: #FF1493; margin-bottom: 20px; text-align: center;">ÂÆ∂Âõ≠‰ø°ÊÅØ</h3>
                            <div class="home-doll-info">
                                <div class="home-doll-name" id="homeDollName">ÊàëÁöÑÂ®ÉÂ®É</div>
                                <div class="home-doll-id" id="homeDollId">ÁºñÂè∑: DOLL2024001</div>
                            </div>
                            
                            <div class="home-features">
                                <div class="home-feature">
                                    <div class="home-feature-icon">üè†</div>
                                    <div class="home-feature-name">ÊàøÂ±ãË£Ö‰øÆ</div>
                                </div>
                                <div class="home-feature">
                                    <div class="home-feature-icon">üå≥</div>
                                    <div class="home-feature-name">Â∫≠Èô¢Â∏ÉÁΩÆ</div>
                                </div>
                                <div class="home-feature">
                                    <div class="home-feature-icon">üçΩÔ∏è</div>
                                    <div class="home-feature-name">È§êÂéÖÁÆ°ÁêÜ</div>
                                </div>
                                <div class="home-feature">
                                    <div class="home-feature-icon">üé™</div>
                                    <div class="home-feature-name">Â®±‰πêËÆæÊñΩ</div>
                                </div>
                            </div>
                            
                            <div class="home-social">
                                <div class="social-title">Á§æ‰∫§ÂäüËÉΩ</div>
                                <div class="social-buttons">
                                    <button class="social-btn">Â•ΩÂèãÂàóË°®</button>
                                    <button class="social-btn">ËÆøÈóÆÂÆ∂Âõ≠</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="home-main">
                            <div class="home-doll-display">
                                <div class="home-doll-3d">
                                    <div class="home-doll-3d-face home-doll-3d-front">üè†</div>
                                    <div class="home-doll-3d-face home-doll-3d-back">ÂÆ∂Âõ≠</div>
                                    <div class="home-doll-3d-face home-doll-3d-side"></div>
                                    <div class="home-doll-3d-face home-doll-3d-top"></div>
                                </div>
                            </div>
                            <p style="color: #8B008B; text-align: center; margin-top: 20px;">Â®ÉÂ®ÉÂÆ∂Âõ≠Á≥ªÁªüÊ≠£Âú®ÂºÄÂèë‰∏≠ÔºåÊï¨ËØ∑ÊúüÂæÖÔºÅ</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÊäΩÂ•ñÁâàÂùó -->
            <div id="lottery" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üéÅ Á®ÄÊúâÂ®ÉÂ®ÉÊäΩÂ•ñ</h2>
                    <p class="section-subtitle">ÊØèÊ¨°ÊäΩÂ•ñÂøÖÂá∫Â®ÉÂ®ÉÔºåÊúâÊú∫‰ºöËé∑ÂæóÁ®ÄÊúâËóèÂìÅ</p>
                </div>
                
                <div class="lottery-container">
                    <div class="blind-box-container">
                        <div class="blind-box" id="blindBox" onclick="startLottery()">
                            üéÅ
                        </div>
                        <p style="color: #8B008B; font-size: 1.2rem; margin-top: 20px;">ÁÇπÂáªÁõ≤ÁõíÂºÄÂßãÊäΩÂ•ñ</p>
                    </div>
                    
                    <div class="lottery-info">
                        <div class="lottery-cost">ÂΩìÂâçÊäΩÂ•ñË¥πÁî®: <span id="lotteryCost">60</span> Â§©ÂàõÁßØÂàÜ</div>
                        <p style="color: #8B008B; margin-bottom: 15px;">ÊØèÊ¨°ÂøÖÂá∫Â®ÉÂ®ÉÔºåÁ®ÄÊúâÂ®ÉÂ®ÉÊ¶ÇÁéá10%</p>
                    </div>
                    
                    <div class="rare-dolls-showcase" id="rareDollsShowcase">
                        <!-- Á®ÄÊúâÂ®ÉÂ®ÉÂ±ïÁ§∫ -->
                    </div>
                </div>
            </div>
            
            <!-- ÂêàÊàêÁâàÂùó -->
            <div id="synthesis" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">‚öóÔ∏è Â®ÉÂ®ÉÂêàÊàêÂ∑•Âùä</h2>
                    <p class="section-subtitle">Â∞Ü‰ΩéÁ∫ßÂ®ÉÂ®ÉÂêàÊàê‰∏∫Êõ¥È´òÁ∫ßÁöÑÂ®ÉÂ®É</p>
                </div>
                
                <div class="synthesis-workshop">
                    <div class="available-dolls">
                        <div class="available-dolls-title">ÈÄâÊã©ÊÇ®ÁöÑ‰∏ÄÁ∫ßÂ®ÉÂ®ÉËøõË°åÂêàÊàê</div>
                        <div class="available-dolls-grid" id="availableDollsGrid">
                            <!-- ÂèØÁî®Â®ÉÂ®ÉÂàóË°® -->
                        </div>
                    </div>
                    
                    <div class="synthesis-area">
                        <div class="synthesis-slot" id="synthesisSlot1" onclick="selectDoll(1)">
                            <div style="font-size: 3rem; color: #FFD1DC;">üß∏</div>
                            <p style="color: #8B008B; margin-top: 10px;">ÈÄâÊã©Â®ÉÂ®É</p>
                        </div>
                        
                        <div class="synthesis-arrow">‚ûï</div>
                        
                        <div class="synthesis-slot" id="synthesisSlot2" onclick="selectDoll(2)">
                            <div style="font-size: 3rem; color: #FFD1DC;">üß∏</div>
                            <p style="color: #8B008B; margin-top: 10px;">ÈÄâÊã©Â®ÉÂ®É</p>
                        </div>
                    </div>
                    
                    <div class="synthesis-formula">
                        <div class="formula-title">ÂêàÊàêÂÖ¨Âºè</div>
                        <div class="formula-display">
                            <div class="formula-item">‰∏ÄÁ∫ßÂ®ÉÂ®É</div>
                            <div class="formula-plus">+</div>
                            <div class="formula-item">‰∏ÄÁ∫ßÂ®ÉÂ®É</div>
                            <div class="formula-plus">+</div>
                            <div class="formula-item">10Ê†πÊãêÊùñ</div>
                        </div>
                        <div class="success-rate-display">ÊàêÂäüÁéá: <span id="successRate">10</span>%</div>
                        <div class="cane-counter">ÂΩìÂâçÊãêÊùñ: <span id="caneCount">10</span> Ê†π</div>
                    </div>
                    
                    <div class="synthesis-controls">
                        <button class="synthesis-btn" onclick="addCane()">Ê∑ªÂä†ÊãêÊùñ (+10)</button>
                        <button class="synthesis-btn" onclick="startSynthesis()">ÂºÄÂßãÂêàÊàê</button>
                    </div>
                </div>
            </div>
            
            <!-- Â®ÉÂ®É‰πãÁéãÁâàÂùó -->
            <div id="doll-king" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üëë Â®ÉÂ®É‰πãÁéãÊåëÊàòËµõ</h2>
                    <p class="section-subtitle">ÂüπÂÖª‰Ω†ÁöÑÂ®ÉÂ®ÉÔºåÊåëÊàòÂêÑÁßçÂÖ≥Âç°ÔºåÊàê‰∏∫ÁúüÊ≠£ÁöÑÂ®ÉÂ®É‰πãÁéãÔºÅ</p>
                </div>
                
                <!-- Ê∏∏ÊàèÁªüËÆ°‰ø°ÊÅØ -->
                <div class="game-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalPower">0</div>
                        <div class="stat-label">ÊÄªÊàòÂäõ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="currentLevel">1</div>
                        <div class="stat-label">ÂΩìÂâçÂÖ≥Âç°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalWins">0</div>
                        <div class="stat-label">ËÉúÂà©Âú∫Ê¨°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="trainingPoints">50</div>
                        <div class="stat-label">ËÆ≠ÁªÉÁÇπÊï∞</div>
                    </div>
                </div>
                
                <div class="king-redirect-section">
                    <p style="color: #8B008B; text-align: center; margin-bottom: 20px; font-size: 1.1rem;">
                        üéÆ Â®ÉÂ®É‰πãÁéãÂäüËÉΩÂ∑≤ÂçáÁ∫ß‰∏∫Áã¨Á´ãÈ°µÈù¢ÔºåÊèê‰æõÊõ¥‰∏∞ÂØåÁöÑÊ∏∏Êàè‰ΩìÈ™åÔºÅ
                    </p>
                    <button class="king-redirect-btn" onclick="openDollKingPage()">
                        <i class="fas fa-crown"></i>
                        <span>ËøõÂÖ•Â®ÉÂ®É‰πãÁéã</span>
                    </button>
                </div>
                
                <div class="game-container">
                    <!-- Ê∏∏ÊàèÁä∂ÊÄÅÈù¢Êùø -->
                    <div class="game-status-panel">
                        <div class="game-tabs">
                            <button class="game-tab active" onclick="switchGameTab('training')">üèãÔ∏è Â±ûÊÄßËÆ≠ÁªÉ</button>
                            <button class="game-tab" onclick="switchGameTab('levels')">‚öîÔ∏è ÂÖ≥Âç°ÊåëÊàò</button>
                            <button class="game-tab" onclick="switchGameTab('equipment')">üéí Ë£ÖÂ§áÁÆ°ÁêÜ</button>
                        </div>
                        
                        <!-- Â±ûÊÄßËÆ≠ÁªÉÂå∫Âüü -->
                        <div id="training" class="training-section active">
                            <div class="training-grid">
                                <div class="training-item">
                                    <div class="training-header">
                                        <div class="training-name">üí™ ÂäõÈáèËÆ≠ÁªÉ</div>
                                        <div class="training-value" id="strengthValue">10</div>
                                    </div>
                                    <div class="training-progress">
                                        <div class="training-progress-bar strength-bar" id="strengthBar" style="width: 20%"></div>
                                    </div>
                                    <div class="training-cost">Ê∂àËÄó: 5ËÆ≠ÁªÉÁÇπÊï∞</div>
                                    <button class="train-btn" onclick="trainAttribute('strength')">ÂºÄÂßãËÆ≠ÁªÉ</button>
                                </div>
                                
                                <div class="training-item">
                                    <div class="training-header">
                                        <div class="training-name">üèÉ ÊïèÊç∑ËÆ≠ÁªÉ</div>
                                        <div class="training-value" id="agilityValue">10</div>
                                    </div>
                                    <div class="training-progress">
                                        <div class="training-progress-bar agility-bar" id="agilityBar" style="width: 20%"></div>
                                    </div>
                                    <div class="training-cost">Ê∂àËÄó: 5ËÆ≠ÁªÉÁÇπÊï∞</div>
                                    <button class="train-btn" onclick="trainAttribute('agility')">ÂºÄÂßãËÆ≠ÁªÉ</button>
                                </div>
                                
                                <div class="training-item">
                                    <div class="training-header">
                                        <div class="training-name">üß† Êô∫ÂäõËÆ≠ÁªÉ</div>
                                        <div class="training-value" id="intelligenceValue">10</div>
                                    </div>
                                    <div class="training-progress">
                                        <div class="training-progress-bar intelligence-bar" id="intelligenceBar" style="width: 20%"></div>
                                    </div>
                                    <div class="training-cost">Ê∂àËÄó: 5ËÆ≠ÁªÉÁÇπÊï∞</div>
                                    <button class="train-btn" onclick="trainAttribute('intelligence')">ÂºÄÂßãËÆ≠ÁªÉ</button>
                                </div>
                                
                                <div class="training-item">
                                    <div class="training-header">
                                        <div class="training-name">üõ°Ô∏è Èò≤Âæ°ËÆ≠ÁªÉ</div>
                                        <div class="training-value" id="defenseValue">10</div>
                                    </div>
                                    <div class="training-progress">
                                        <div class="training-progress-bar defense-bar" id="defenseBar" style="width: 20%"></div>
                                    </div>
                                    <div class="training-cost">Ê∂àËÄó: 5ËÆ≠ÁªÉÁÇπÊï∞</div>
                                    <button class="train-btn" onclick="trainAttribute('defense')">ÂºÄÂßãËÆ≠ÁªÉ</button>
                                </div>
                                
                                <div class="training-item">
                                    <div class="training-header">
                                        <div class="training-name">üçÄ Âπ∏ËøêËÆ≠ÁªÉ</div>
                                        <div class="training-value" id="luckValue">10</div>
                                    </div>
                                    <div class="training-progress">
                                        <div class="training-progress-bar luck-bar" id="luckBar" style="width: 20%"></div>
                                    </div>
                                    <div class="training-cost">Ê∂àËÄó: 5ËÆ≠ÁªÉÁÇπÊï∞</div>
                                    <button class="train-btn" onclick="trainAttribute('luck')">ÂºÄÂßãËÆ≠ÁªÉ</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÂÖ≥Âç°ÊåëÊàòÂå∫Âüü -->
                        <div id="levels" class="levels-section">
                            <div class="levels-grid" id="levelsGrid">
                                <!-- ÂÖ≥Âç°Â∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                            </div>
                        </div>
                        
                        <!-- Ë£ÖÂ§áÁÆ°ÁêÜÂå∫Âüü -->
                        <div id="equipment" class="equipment-section">
                            <div class="equipment-slots" id="equipmentSlots">
                                <!-- Ë£ÖÂ§áÊßΩÂ∞ÜÈÄöËøáJSÂä®ÊÄÅÁîüÊàê -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Â®ÉÂ®ÉÂ±ïÁ§∫Âå∫Âüü -->
                    <div class="king-doll-showcase">
                        <div class="king-doll-display" id="kingDollDisplay">üß∏</div>
                        <div class="king-doll-info">
                            <div class="king-doll-name" id="kingDollName">ÊàëÁöÑÂ®ÉÂ®É</div>
                            <div class="king-doll-id" id="kingDollId">ÁºñÂè∑: DOLL2024001</div>
                        </div>
                        
                        <div class="combat-power-section">
                            <div class="combat-power-title">‚öîÔ∏è ÊàòÂäõÁ≥ªÁªü</div>
                            <div class="combat-power-display">ÊÄªÊàòÂäõ: <span id="combatPower">100</span></div>
                            <div class="power-stats">
                                <div class="power-stat">
                                    <div class="power-stat-label">ÂäõÈáè</div>
                                    <div class="power-stat-value" id="attackPower">25</div>
                                </div>
                                <div class="power-stat">
                                    <div class="power-stat-label">ÊïèÊç∑</div>
                                    <div class="power-stat-value" id="agilityPower">25</div>
                                </div>
                                <div class="power-stat">
                                    <div class="power-stat-label">Êô∫Âäõ</div>
                                    <div class="power-stat-value" id="intelligencePower">25</div>
                                </div>
                                <div class="power-stat">
                                    <div class="power-stat-label">Èò≤Âæ°</div>
                                    <div class="power-stat-value" id="defensePower">25</div>
                                </div>
                                <div class="power-stat">
                                    <div class="power-stat-label">Âπ∏Ëøê</div>
                                    <div class="power-stat-value" id="luckPower">25</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÂàÜÁ∫¢ÁâàÂùó -->
            <div id="dividend" class="tab-content">
                <div class="section-header">
                    <h2 class="section-title">üíé Á®ÄÊúâÂ®ÉÂ®ÉÂàÜÁ∫¢</h2>
                    <p class="section-subtitle">Êã•ÊúâÁ®ÄÊúâÂ®ÉÂ®ÉÂç≥ÂèØÂèÇ‰∏éÂπ≥Âè∞ÂàÜÁ∫¢</p>
                </div>
                
                <div class="dividend-lounge">
                    <div class="qualification-badge">üèÜ ÂàÜÁ∫¢ËµÑÊ†ºÂ∑≤Ëé∑Âæó</div>
                    <div class="dividend-info-card">
                        <div class="dividend-title">ÊÅ≠ÂñúÊÇ®Ëé∑ÂæóÂàÜÁ∫¢ËµÑÊ†º</div>
                        <div class="dividend-amount">¬• <span id="dividendAmount">0.00</span></div>
                        <div class="dividend-period">Êú¨ÊúüÂàÜÁ∫¢Âë®Êúü: 30Â§©</div>
                    </div>
                    
                    <div class="dividend-history">
                        <div class="history-title">ÂàÜÁ∫¢ÂéÜÂè≤</div>
                        <div class="history-list" id="dividendHistory">
                            <div class="history-item">
                                <span class="history-date">2024-01-15</span>
                                <span class="history-amount">+¬•125.50</span>
                            </div>
                            <div class="history-item">
                                <span class="history-date">2024-01-10</span>
                                <span class="history-amount">+¬•98.30</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ËÉåÂåÖÂºπÁ™ó - Êñ∞Â¢û -->
    <div class="bag-modal" id="bagModal">
        <div class="bag-modal-content">
            <div class="bag-modal-header">
                <div class="bag-modal-title">
                    <i class="fas fa-shopping-bag"></i>
                    <span>ÊàëÁöÑËÉåÂåÖ</span>
                </div>
                <button class="bag-modal-close" onclick="closeBagModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="bag-modal-body">
                <div class="bag-modal-sidebar">
                    <div class="bag-modal-categories">
                        <div class="bag-modal-category-title">
                            <i class="fas fa-list"></i>
                            <span>Áâ©ÂìÅÂàÜÁ±ª</span>
                        </div>
                        <div class="bag-modal-category-list" id="bagModalCategoryList">
                            <div class="bag-modal-category-item active" data-category="all" onclick="switchBagCategory('all')">
                                <i class="fas fa-th"></i>
                                <span class="bag-modal-category-name">ÂÖ®ÈÉ®</span>
                                <span class="bag-modal-category-count" id="bagModalAllCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="doll" onclick="switchBagCategory('doll')">
                                <i class="fas fa-doll"></i>
                                <span class="bag-modal-category-name">Â®ÉÂ®É</span>
                                <span class="bag-modal-category-count" id="bagModalDollCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="item" onclick="switchBagCategory('item')">
                                <i class="fas fa-cube"></i>
                                <span class="bag-modal-category-name">ÈÅìÂÖ∑</span>
                                <span class="bag-modal-category-count" id="bagModalItemCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="equipment" onclick="switchBagCategory('equipment')">
                                <i class="fas fa-shield-alt"></i>
                                <span class="bag-modal-category-name">Ë£ÖÂ§á</span>
                                <span class="bag-modal-category-count" id="bagModalEquipmentCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="skin" onclick="switchBagCategory('skin')">
                                <i class="fas fa-palette"></i>
                                <span class="bag-modal-category-name">ÁöÆËÇ§</span>
                                <span class="bag-modal-category-count" id="bagModalSkinCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="currency" onclick="switchBagCategory('currency')">
                                <i class="fas fa-coins"></i>
                                <span class="bag-modal-category-name">Ë¥ßÂ∏Å</span>
                                <span class="bag-modal-category-count" id="bagModalCurrencyCount">0</span>
                            </div>
                            <div class="bag-modal-category-item" data-category="other" onclick="switchBagCategory('other')">
                                <i class="fas fa-ellipsis-h"></i>
                                <span class="bag-modal-category-name">ÂÖ∂‰ªñ</span>
                                <span class="bag-modal-category-count" id="bagModalOtherCount">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bag-modal-stats">
                        <div class="bag-modal-stat-item">
                            <span class="bag-modal-stat-label">ÊÄªÁâ©ÂìÅ</span>
                            <span class="bag-modal-stat-value" id="bagModalTotalItems">0</span>
                        </div>
                        <div class="bag-modal-stat-item">
                            <span class="bag-modal-stat-label">ÊÄª‰ª∑ÂÄº</span>
                            <span class="bag-modal-stat-value" id="bagModalTotalValue">0</span>
                        </div>
                        <div class="bag-modal-stat-item">
                            <span class="bag-modal-stat-label">ËÉåÂåÖÂÆπÈáè</span>
                            <span class="bag-modal-stat-value">100/100</span>
                        </div>
                    </div>
                </div>
                
                <div class="bag-modal-main">
                    <div class="bag-modal-grid" id="bagModalGrid">
                        <!-- ËÉåÂåÖÁâ©ÂìÅÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
                    </div>
                </div>
            </div>
        </div>
    </body>

    <!-- APIÈÖçÁΩÆÊñá‰ª∂ -->
    <script src="api-config.js"></script>
    <script src="api-service.js"></script>
    <script src="data-adapter.js"></script>
    <script src="points-system.js"></script>
    <script src="user-system.js"></script>
    <script src="common.js"></script>
    
    <script>
        // Â®ÉÂ®ÉÁ≥ªÁªü - ÂÆåÊï¥‰ºòÂåñÁâà
        const DollSystem = {
            // Ê∏∏ÊàèÁä∂ÊÄÅ
            gameState: {
                userDolls: [],
                lotteryCost: 60,
                synthesisCaneCount: 10,
                successRate: 10,
                level1Stock: 200,
                totalLevel1Stock: 500,
                selectedDolls: [null, null],
                equippedItems: {},
                combatPower: 100,
                rareDolls: [
                    { id: 'RD001', icon: 'ü¶Ñ', status: 'available' },
                    { id: 'RD002', icon: 'üåü', status: 'available' },
                    { id: 'RD003', icon: 'üåü', status: 'available' },
                    { id: 'RD004', icon: 'üåü', status: 'available' },
                    { id: 'RD005', icon: 'üåà', status: 'available' },
                    { id: 'RD006', icon: 'ü¶ã', status: 'available' },
                    { id: 'RD007', icon: 'ü¶ã', status: 'available' },
                    { id: 'RD008', icon: 'ü¶ã', status: 'available' },
                    { id: 'RD009', icon: 'ü¶ã', status: 'available' },
                    { id: 'RD010', icon: 'ü¶ã', status: 'available' }
                ],
                // ÂçáÁ∫ßÁöÆËÇ§Êï∞ÊçÆ
                skins: [
                    {
                        id: 'bear-big',
                        name: 'ÁÜäÂ§ßÊ£ÆÊûóË£Ö',
                        icon: 'üêª',
                        description: 'Êù•Ëá™Ê£ÆÊûóÁöÑÂèØÁà±ÁÜäÂ§ßÔºåÊÜ®ÂéöÂèØÁà±',
                        originalPrice: 299,
                        currentPrice: 99,
                        stock: 10,
                        totalStock: 10,
                        category: 'bear',
                        featured: true,
                        rarity: 'rare',
                        attributes: {
                            strength: 5,
                            agility: 3,
                            intelligence: 4,
                            luck: 6
                        }
                    },
                    {
                        id: 'bear-small',
                        name: 'ÁÜä‰∫åËúÇËúúË£Ö',
                        icon: 'üêª‚Äç‚ùÑÔ∏è',
                        description: 'Áà±ÂêÉËúÇËúúÁöÑÁÜä‰∫åÔºåÂëÜËêåÊúâË∂£',
                        originalPrice: 299,
                        currentPrice: 99,
                        stock: 10,
                        totalStock: 10,
                        category: 'bear',
                        featured: true,
                        rarity: 'rare',
                        attributes: {
                            strength: 4,
                            agility: 5,
                            intelligence: 3,
                            luck: 7
                        }
                    },
                    {
                        id: 'princess',
                        name: 'ÂÖ¨‰∏ªË£ô',
                        icon: 'üë∏',
                        description: '‰ºòÈõÖÁöÑÂÖ¨‰∏ªË£ôÔºåÈ´òË¥µÂÖ∏ÈõÖ',
                        originalPrice: 599,
                        currentPrice: 199,
                        stock: 5,
                        totalStock: 5,
                        category: 'festival',
                        featured: true,
                        rarity: 'legendary',
                        attributes: {
                            strength: 6,
                            agility: 4,
                            intelligence: 7,
                            luck: 8
                        }
                    },
                    {
                        id: 'superhero',
                        name: 'Ë∂ÖÁ∫ßËã±ÈõÑ',
                        icon: 'ü¶∏',
                        description: 'ÂãáÊï¢ÁöÑË∂ÖÁ∫ßËã±ÈõÑÔºåÊó†ÊâÄ‰∏çËÉΩ',
                        originalPrice: 799,
                        currentPrice: 299,
                        stock: 3,
                        totalStock: 3,
                        category: 'rare',
                        featured: true,
                        rarity: 'legendary',
                        attributes: {
                            strength: 8,
                            agility: 6,
                            intelligence: 5,
                            luck: 7
                        }
                    }
                ],
                // Êñ∞Â¢ûÂÆ∂Âõ≠Êï∞ÊçÆ
                homeDoll: {
                    id: 'DOLL2024001',
                    name: 'ÊàëÁöÑÂ®ÉÂ®É',
                    icon: 'üè†'
                },
                // Êñ∞Â¢ûÂ®ÉÂ®É‰πãÁéãÊ∏∏ÊàèÊï∞ÊçÆ
                kingGame: {
                    // Â®ÉÂ®ÉÂ±ûÊÄß
                    attributes: {
                        strength: 10,
                        agility: 10,
                        intelligence: 10,
                        defense: 10,
                        luck: 10
                    },
                    // Ê∏∏ÊàèËøõÂ∫¶
                    currentLevel: 1,
                    totalWins: 0,
                    trainingPoints: 50,
                    // Ë£ÖÂ§á
                    equipment: {
                        weapon: false,
                        armor: false,
                        boots: false,
                        helmet: false,
                        amulet: false,
                        ring: false
                    },
                    // ÂÖ≥Âç°Êï∞ÊçÆ
                    levels: [
                        {
                            id: 1,
                            name: "Êñ∞ÊâãËÆ≠ÁªÉËê•",
                            difficulty: "ÁÆÄÂçï",
                            requiredPower: 50,
                            enemyPower: 40,
                            rewards: {
                                trainingPoints: 10,
                                exp: 20
                            },
                            unlocked: true
                        },
                        {
                            id: 2,
                            name: "Ê£ÆÊûóÂÜíÈô©",
                            difficulty: "ÊôÆÈÄö",
                            requiredPower: 100,
                            enemyPower: 90,
                            rewards: {
                                trainingPoints: 20,
                                exp: 40
                            },
                            unlocked: false
                        },
                        {
                            id: 3,
                            name: "ÂüéÂ†°ÊåëÊàò",
                            difficulty: "Âõ∞Èöæ",
                            requiredPower: 180,
                            enemyPower: 170,
                            rewards: {
                                trainingPoints: 30,
                                exp: 60
                            },
                            unlocked: false
                        },
                        {
                            id: 4,
                            name: "Â∑®ÈæôÂ∑¢Á©¥",
                            difficulty: "‰∏ìÂÆ∂",
                            requiredPower: 300,
                            enemyPower: 290,
                            rewards: {
                                trainingPoints: 50,
                                exp: 100
                            },
                            unlocked: false
                        },
                        {
                            id: 5,
                            name: "ÊúÄÁªàËØïÁÇº",
                            difficulty: "ÁéãËÄÖ",
                            requiredPower: 500,
                            enemyPower: 480,
                            rewards: {
                                trainingPoints: 100,
                                exp: 200
                            },
                            unlocked: false
                        }
                    ]
                },
                // ËÉåÂåÖÂºπÁ™óÊï∞ÊçÆ - Êñ∞Â¢û
                bagModalData: {
                    currentCategory: 'all',
                    bagItems: []
                }
            },
            
            // ÂàùÂßãÂåñ
            init() {
                console.log('=== Â®ÉÂ®ÉÁ≥ªÁªüÂàùÂßãÂåñ ===');
                
                // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
                if (!this.checkLogin()) {
                    return;
                }
                
                // ÂàùÂßãÂåñÁ≤íÂ≠êÊïàÊûú
                this.initParticles();
                
                // ÂàùÂßãÂåñ‰∫ã‰ª∂ÁõëÂê¨
                this.initEventListeners();
                
                // Âä†ËΩΩÁî®Êà∑Êï∞ÊçÆ
                this.loadUserData();
                
                // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ
                this.updateUserInfo();
                
                // ÂàùÂßãÂåñÁßØÂàÜÁ≥ªÁªü
                if (window.pointsSystem) {
                    window.pointsSystem.subscribe((data) => {
                        this.updatePointsDisplay(data.newPoints);
                    });
                    
                    // ÁõëÂê¨ÁßØÂàÜÊõ¥Êñ∞‰∫ã‰ª∂
                    window.addEventListener('pointsUpdated', (e) => {
                        this.updatePointsDisplay(e.detail.newPoints);
                    });
                }
                
                // ÂºÄÂßãÊØèÊó•Êî∂ÁõäËÆ°ÁÆó
                this.startDailyEarnings();
                
                console.log('Â®ÉÂ®ÉÁ≥ªÁªüÂàùÂßãÂåñÂÆåÊàê');
            },
            
            // Ê£ÄÊü•ÁôªÂΩïÁä∂ÊÄÅ
            checkLogin() {
                const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                const currentUser = localStorage.getItem('currentUser');
                
                if (!isLoggedIn || !currentUser) {
                    window.location.href = 'login.html';
                    return false;
                }
                
                return true;
            },
            
            // ÂàùÂßãÂåñÁ≤íÂ≠êÊïàÊûú
            initParticles() {
                const particlesContainer = document.getElementById('particles');
                const particleCount = 25;
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.textContent = dollEmojis[i % dollEmojis.length];
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    particle.style.fontSize = (Math.random() * 2 + 2) + 'rem';
                    particle.style.animationDelay = Math.random() * 10 + 's';
                    particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                    particlesContainer.appendChild(particle);
                }
            },
            
            // ÂàùÂßãÂåñ‰∫ã‰ª∂ÁõëÂê¨
            initEventListeners() {
                // Áî®Êà∑‰∏ãÊãâËèúÂçï
                const userInfo = document.getElementById('userInfo');
                if (userInfo) {
                    userInfo.addEventListener('click', (e) => {
                        e.stopPropagation();
                        userInfo.classList.toggle('active');
                    });
                    
                    // ÁÇπÂáªÂÖ∂‰ªñÂú∞ÊñπÂÖ≥Èó≠Áî®Êà∑‰∏ãÊãâËèúÂçï
                    document.addEventListener('click', () => {
                        userInfo.classList.remove('active');
                    });
                }
                
                // ÈÄÄÂá∫ÁôªÂΩï
                const logoutBtn = document.getElementById('logoutBtn');
                if (logoutBtn) {
                    logoutBtn.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.logout();
                    });
                }
                
                // ËÆæÁΩÆÊåâÈíÆ
                const settingsBtn = document.getElementById('settingsBtn');
                if (settingsBtn) {
                    settingsBtn.addEventListener('click', () => {
                        this.showNotification('info', 'ËÆæÁΩÆ', 'ËÆæÁΩÆÂäüËÉΩÂºÄÂèë‰∏≠...');
                    });
                }
                
                // ÂàÜÁ±ªÂàáÊç¢
                const categoryItems = document.querySelectorAll('.category-item');
                categoryItems.forEach(item => {
                    item.addEventListener('click', () => {
                        this.switchCategory(item.dataset.category);
                    });
                });
                
                // Â®ÉÂ®ÉÊìç‰ΩúÊåâÈíÆ
                const sortBtn = document.getElementById('sortBtn');
                const buyBtn = document.getElementById('buyBtn');
                if (sortBtn) {
                    sortBtn.addEventListener('click', () => {
                        this.sortDolls();
                    });
                }
                
                if (buyBtn) {
                    buyBtn.addEventListener('click', () => {
                        this.showBuyDollModal();
                    });
                }
                
                // Ê†áÁ≠æÂØºËà™
                const tabItems = document.querySelectorAll('.tab-item');
                tabItems.forEach(tab => {
                    tab.addEventListener('click', () => {
                        this.switchTab(tab.id.replace('-', ''));
                    });
                });
                
                // ËÉåÂåÖÊåâÈíÆ
                const bagButton = document.querySelector('.bag-button');
                if (bagButton) {
                    bagButton.addEventListener('click', () => {
                        this.openBagModal();
                    });
                }
                
                // Â®ÉÂ®É‰πãÁéãË∑≥ËΩ¨ÊåâÈíÆ
                const kingRedirectBtn = document.querySelector('.king-redirect-btn');
                if (kingRedirectBtn) {
                    kingRedirectBtn.addEventListener('click', () => {
                        this.openDollKingPage();
                    });
                }
                
                // ËÉåÂåÖÂºπÁ™óÁõ∏ÂÖ≥
                const bagModalClose = document.getElementById('bagModalClose');
                const bagModalCancel = document.getElementById('bagModalCancel');
                const publishClose = document.getElementById('publishClose');
                const publishForm = document.getElementById('publishForm');
                
                if (bagModalClose) {
                    bagModalClose.addEventListener('click', () => {
                        this.closeBagModal();
                    });
                }
                
                if (bagModalCancel) {
                    bagModalCancel.addEventListener('click', () => {
                        this.closeBagModal();
                    });
                }
                
                if (publishForm) {
                    publishForm.addEventListener('submit', (e) => {
                        e.preventDefault();
                        this.publishItem();
                    });
                }
            },
            
            // Êõ¥Êñ∞Áî®Êà∑‰ø°ÊÅØ
            updateUserInfo() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userName = document.getElementById('userName');
                const userPoints = document.getElementById('userPoints');
                
                if (user && userName && userPoints) {
                    userName.textContent = user.name;
                    // ‰ΩøÁî®ÁßØÂàÜÁ≥ªÁªüËé∑ÂèñÁßØÂàÜ
                    const points = window.pointsSystem ? 
                        window.pointsSystem.getPoints() : 
                        (user.points || 0);
                    userPoints.textContent = points;
                }
            },
            
            // Êõ¥Êñ∞ÁßØÂàÜÊòæÁ§∫
            updatePointsDisplay(points) {
                const userPoints = document.getElementById('userPoints');
                if (userPoints) {
                    userPoints.textContent = points;
                }
            },
            
            // Âä†ËΩΩÁî®Êà∑Êï∞ÊçÆ
            loadUserData() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰ªélocalStorageÂä†ËΩΩÂ®ÉÂ®ÉÊï∞ÊçÆ
                const savedDolls = localStorage.getItem(`userDolls_${userId}`);
                if (savedDolls) {
                    this.gameState.userDolls = JSON.parse(savedDolls);
                } else {
                    // Â¶ÇÊûúÊ≤°Êúâ‰øùÂ≠òÁöÑÊï∞ÊçÆÔºåÁîüÊàêÈªòËÆ§Êï∞ÊçÆ
                    this.generateDefaultDolls();
                }
                
                // Âä†ËΩΩÂÖ∂‰ªñÊ∏∏ÊàèÁä∂ÊÄÅ
                const savedState = localStorage.getItem(`dollGameState_${userId}`);
                if (savedState) {
                    const state = JSON.parse(savedState);
                    Object.assign(this.gameState, state);
                }
                
                // Âä†ËΩΩÂ®ÉÂ®É‰πãÁéãÊ∏∏ÊàèÊï∞ÊçÆ
                const savedKingGame = localStorage.getItem(`kingGame_${userId}`);
                if (savedKingGame) {
                    this.gameState.kingGame = JSON.parse(savedKingGame);
                }
                
                // ÂàùÂßãÂåñÈªòËÆ§ÁöÆËÇ§
                this.initDefaultSkins();
                
                // ‰ªédollÁ≥ªÁªüÂêåÊ≠•Â®ÉÂ®ÉÊï∞ÊçÆÂà∞ËÉåÂåÖ
                this.syncDollsToBag();
                
                // ‰ªéË£ÖÂ§áÂêåÊ≠•Ë£ÖÂ§áÊï∞ÊçÆÂà∞ËÉåÂåÖ
                this.syncEquipmentToBag();
                
                // ‰ªéÂ®ÉÂ®É‰πãÁéãÂêåÊ≠•Ë£ÖÂ§áÊï∞ÊçÆÂà∞ËÉåÂåÖ
                this.syncKingGameEquipmentToBag();
                
                // ‰ªéÂ®ÉÂ®É‰πãÁéãÂêåÊ≠•Â®ÉÂ®ÉÊï∞ÊçÆÂà∞ËÉåÂåÖ
                this.syncKingGameDollsToBag();
                
                // ‰ªéÂ®ÉÂ®É‰πãÁéãÂêåÊ≠•Áé∞ÈáëÁ∫¢ÂåÖÂà∞ËÉåÂåÖ
                this.syncKingGameRedPacketsToBag();
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateMyDolls();
                this.updateStockDisplay();
                this.updateCombatPower();
                this.updateKingDollDisplay();
                this.updateKingGameDisplay();
                this.updateKingGameDisplay();
            },
            
            // ÁîüÊàêÈªòËÆ§Â®ÉÂ®ÉÊï∞ÊçÆ
            generateDefaultDolls() {
                this.gameState.userDolls = [
                    {
                        id: 'doll_1',
                        name: 'Âü∫Á°ÄÂ®ÉÂ®É',
                        icon: 'üß∏',
                        category: 'basic',
                        level: 1,
                        dailyEarnings: '0.84-0.92',
                        lifespan: 60,
                        purchaseDate: new Date().toISOString(),
                        status: 'active',
                        attributes: {
                            strength: 10,
                            agility: 10,
                            intelligence: 10,
                            luck: 10
                        }
                    }
                ];
                
                // ‰øùÂ≠òÂà∞localStorage
                this.saveUserData();
            },
            
            // ‰øùÂ≠òÁî®Êà∑Êï∞ÊçÆ
            saveUserData() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰øùÂ≠òÂ®ÉÂ®ÉÊï∞ÊçÆ
                localStorage.setItem(`userDolls_${userId}`, JSON.stringify(this.gameState.userDolls));
                
                // ‰øùÂ≠òÊ∏∏ÊàèÁä∂ÊÄÅ
                localStorage.setItem(`dollGameState_${userId}`, JSON.stringify({
                    lotteryCost: this.gameState.lotteryCost,
                    synthesisCaneCount: this.gameState.synthesisCaneCount,
                    successRate: this.gameState.successRate,
                    level1Stock: this.gameState.level1Stock,
                    totalLevel1Stock: this.gameState.totalLevel1Stock,
                    selectedDolls: this.gameState.selectedDolls,
                    equippedItems: this.gameState.equippedItems,
                    combatPower: this.gameState.combatPower,
                    rareDolls: this.gameState.rareDolls,
                    skins: this.gameState.skins,
                    homeDoll: this.gameState.homeDoll,
                    kingGame: this.gameState.kingGame
                }));
                
                // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                this.saveBagData();
            },
            
            // ÂàùÂßãÂåñÈªòËÆ§ÁöÆËÇ§
            initDefaultSkins() {
                // Â¶ÇÊûúÊ≤°ÊúâÁöÆËÇ§Êï∞ÊçÆÔºåÊ∑ªÂä†ÈªòËÆ§ÁöÆËÇ§
                if (this.gameState.skins.length === 0) {
                    this.gameState.skins = [
                        {
                            id: 'bear-big',
                            name: 'ÁÜäÂ§ßÊ£ÆÊûóË£Ö',
                            icon: 'üêª',
                            description: 'Êù•Ëá™Ê£ÆÊûóÁöÑÂèØÁà±ÁÜäÂ§ßÔºåÊÜ®ÂéöÂèØÁà±',
                            originalPrice: 299,
                            currentPrice: 99,
                            stock: 10,
                            totalStock: 10,
                            category: 'bear',
                            featured: true,
                            rarity: 'rare'
                        },
                        {
                            id: 'bear-small',
                            name: 'ÁÜä‰∫åËúÇËúúË£Ö',
                            icon: 'üêª‚Äç‚ùÑÔ∏è',
                            description: 'Áà±ÂêÉËúÇËúúÁöÑÁÜä‰∫åÔºåÂëÜËêåÊúâË∂£',
                            originalPrice: 299,
                            currentPrice: 99,
                            stock: 10,
                            totalStock: 10,
                            category: 'bear',
                            featured: true,
                            rarity: 'rare'
                        }
                    ];
                }
            },
            
            // ÂàáÊç¢Ê†áÁ≠æ
            switchTab(tabName) {
                // ÁßªÈô§ÊâÄÊúâÊ¥ªÂä®Áä∂ÊÄÅ
                document.querySelectorAll('.tab-item').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // Ê∑ªÂä†Êñ∞ÁöÑÊ¥ªÂä®Áä∂ÊÄÅ
                event.target.classList.add('active');
                document.getElementById(tabName).classList.add('active');
                
                // ÁâπÊÆäÂ§ÑÁêÜ
                if (tabName === 'lottery') {
                    this.initRareDolls();
                } else if (tabName === 'synthesis') {
                    this.updateAvailableDolls();
                } else if (tabName === 'doll-king') {
                    this.updateKingDollDisplay();
                    this.updateKingGameDisplay();
                    this.updateKingGameDisplay();
                } else if (tabName === 'dividend') {
                    this.updateDividendDisplay();
                }
            },
            
            // ÂàáÊç¢ÂàÜÁ±ª
            switchCategory(category) {
                this.currentCategory = category;
                
                // Êõ¥Êñ∞ÂàÜÁ±ªUI
                document.querySelectorAll('.category-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-category="${category}"]`).classList.add('active');
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateMyDolls();
            },
            
            // Êõ¥Êñ∞ÊàëÁöÑÂ®ÉÂ®ÉÊòæÁ§∫
            updateMyDolls() {
                const shelf = document.getElementById('dollShelf');
                
                if (this.gameState.userDolls.length === 0) {
                    shelf.innerHTML = `
                        <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: #8B008B;">
                            <div style="font-size: 4rem; margin-bottom: 20px; opacity: 0.5;">üéÄ</div>
                            <h3 style="font-size: 1.5rem; margin-bottom: 15px;">ÊÇ®ËøòÊ≤°ÊúâÂ®ÉÂ®É</h3>
                            <p style="font-size: 1.1rem;">Âø´ÂéªÂïÜÂ∫óË¥≠‰π∞ÊÇ®ÁöÑÁ¨¨‰∏Ä‰∏™Â®ÉÂ®ÉÂêßÔºÅ</p>
                        </div>
                    `;
                } else {
                    shelf.innerHTML = this.gameState.userDolls.map(doll => `
                        <div class="doll-spot doll-level-${doll.level}">
                            <div class="doll-spot-display">
                                <div class="doll-3d">
                                    <div class="doll-3d-face doll-3d-front">${doll.icon}</div>
                                    <div class="doll-3d-face doll-3d-back">Á≠âÁ∫ß${doll.level}</div>
                                    <div class="doll-3d-face doll-3d-side"></div>
                                    <div class="doll-3d-face doll-3d-top"></div>
                                </div>
                            </div>
                            <div class="doll-spot-info">
                                <div class="doll-spot-name">${doll.name}</div>
                                <div class="doll-spot-id">ÁºñÂè∑Ôºö${doll.id}</div>
                                <div class="doll-spot-earnings">Êó•Êî∂ÁõäÔºö${doll.dailyEarnings}</div>
                            </div>
                        </div>
                    `).join('');
                }
            },
            
            // Ë¥≠‰π∞Â®ÉÂ®É - ‰øÆÊîπÔºöÂ¢ûÂä†Â±ûÊÄßÂÄºÂπ∂ÂêåÊ≠•Âà∞ËÉåÂåÖ
            purchaseDoll(level) {
                const prices = { 1: 50, 2: 200, 3: 500 };
                const price = prices[level];
                
                // Ê£ÄÊü•ÁßØÂàÜ
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                if (user.points < price) {
                    this.showNotification('error', 'ÁßØÂàÜ‰∏çË∂≥ÔºÅ', `ÈúÄË¶Å ${price} ÁßØÂàÜÔºåÂΩìÂâçÂè™Êúâ ${user.points} ÁßØÂàÜ`);
                    return;
                }
                
                if (level === 1 && this.gameState.level1Stock <= 0) {
                    this.showNotification('error', 'Â∫ìÂ≠ò‰∏çË∂≥ÔºÅ', 'ËØ•Â®ÉÂ®ÉÂ∑≤ÂîÆÁΩÑ');
                    return;
                }
                
                // Êâ£Èô§ÁßØÂàÜ
                user.points -= price;
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateUserInfo();
                
                // ÂàõÂª∫Â®ÉÂ®É - Êñ∞Â¢ûÔºö‰∏∫Â®ÉÂ®ÉÊ∑ªÂä†Â±ûÊÄßÂÄº
                const dollId = 'DOLL' + Date.now();
                const baseAttributes = {
                    strength: Math.floor(Math.random() * 3) + 3, // 3-5
                    agility: Math.floor(Math.random() * 3) + 3, // 3-5
                    intelligence: Math.floor(Math.random() * 3) + 3, // 3-5
                    luck: Math.floor(Math.random() * 3) + 3 // 3-5
                };
                
                // Ê†πÊçÆÂ®ÉÂ®ÉÁ≠âÁ∫ßË∞ÉÊï¥Â±ûÊÄß
                if (level === 2) {
                    baseAttributes.strength += 2;
                    baseAttributes.agility += 2;
                    baseAttributes.intelligence += 2;
                    baseAttributes.luck += 2;
                } else if (level === 3) {
                    baseAttributes.strength += 4;
                    baseAttributes.agility += 4;
                    baseAttributes.intelligence += 4;
                    baseAttributes.luck += 4;
                }
                
                const doll = {
                    id: dollId,
                    level: level,
                    name: `${level}Á∫ßÂ®ÉÂ®É`,
                    icon: level === 1 ? 'üß∏' : level === 2 ? 'üéÄ' : 'üëë',
                    dailyEarnings: level === 1 ? '0.84-0.92' : level === 2 ? '3.05-3.25' : '6-6.3',
                    lifespan: level === 1 ? 60 : level === 2 ? 70 : 90,
                    purchaseDate: new Date().toISOString(),
                    status: 'active',
                    attributes: baseAttributes
                };
                
                this.gameState.userDolls.push(doll);
                
                // ÂêåÊ≠•Âà∞ËÉåÂåÖ - Êñ∞Â¢û
                this.addDollToBag(doll);
                
                // Êõ¥Êñ∞Â∫ìÂ≠ò
                if (level === 1) {
                    this.gameState.level1Stock--;
                    this.updateStockDisplay();
                }
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateMyDolls();
                this.updateKingDollDisplay();
                this.updateKingGameDisplay();
                this.updateKingGameDisplay();
                
                this.showNotification('success', 'Ë¥≠‰π∞ÊàêÂäü', `ÊàêÂäüË¥≠‰π∞${level}Á∫ßÂ®ÉÂ®ÉÔºåÁºñÂè∑Ôºö${dollId}`);
                
                // ÊòæÁ§∫Ë¥≠‰π∞ÊàêÂäüÂä®Áîª
                this.showPurchaseAnimation(doll);
            },
            
            // ÊòæÁ§∫Ë¥≠‰π∞Âä®Áîª
            showPurchaseAnimation(doll) {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '2000';
                modal.innerHTML = `
                    <div class="modal-content" style="text-align: center; padding: 50px;">
                        <div style="font-size: 5rem; margin-bottom: 20px; animation: bounce 1s ease-in-out infinite;">${doll.icon}</div>
                        <h2 style="color: #FF1493; margin-bottom: 15px;">ÊÅ≠ÂñúËé∑ÂæóÊñ∞Â®ÉÂ®ÉÔºÅ</h2>
                        <p style="color: #8B008B; font-size: 1.2rem; margin-bottom: 10px;">${doll.name}</p>
                        <p style="color: #FF69B4; font-weight: 600; margin-bottom: 30px;">ÁºñÂè∑Ôºö${doll.id}</p>
                        <div style="background: rgba(255, 182, 193, 0.1); border-radius: 15px; padding: 15px; margin: 20px 0;">
                            <h3 style="color: #8B008B; margin-bottom: 10px;">Â®ÉÂ®ÉÂ±ûÊÄß</h3>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: left;">
                                <div>ÂäõÈáè: ${doll.attributes.strength}</div>
                                <div>ÊïèÊç∑: ${doll.attributes.agility}</div>
                                <div>Êô∫Âäõ: ${doll.attributes.intelligence}</div>
                                <div>Âπ∏Ëøê: ${doll.attributes.luck}</div>
                            </div>
                        </div>
                        </div>
                        <p style="color: #8B008B; margin-bottom: 30px;">ÊÇ®Â∑≤Ëé∑ÂæóÂàÜÁ∫¢ËµÑÊ†ºÔºÅ</p>
                        <button class="purchase-btn" onclick="this.closest('.modal').remove()">Á°ÆÂÆö</button>
                    </div>
                `;
                document.body.appendChild(modal);
                
                setTimeout(() => {
                    modal.remove();
                }, 5000);
            },
            
            // Ê∑ªÂä†Â®ÉÂ®ÉÂà∞ËÉåÂåÖ - Êñ∞Â¢û
            addDollToBag(doll) {
                // Ê£ÄÊü•ËÉåÂåÖ‰∏≠ÊòØÂê¶Â∑≤Â≠òÂú®ËØ•Â®ÉÂ®É
                const existingDoll = this.bagModalData.bagItems.find(item => 
                    item.id === doll.id && item.category === 'doll'
                );
                
                if (!existingDoll) {
                    // Ê∑ªÂä†Â®ÉÂ®ÉÂà∞ËÉåÂåÖ
                    this.bagModalData.bagItems.push({
                        id: doll.id,
                        name: doll.name || `${doll.level}Á∫ßÂ®ÉÂ®É`,
                        icon: doll.icon || 'üß∏',
                        category: 'doll',
                        count: 1,
                        value: doll.level === 1 ? 50 : (doll.level === 2 ? 200 : 500),
                        quality: doll.level === 1 ? 'common' : (doll.level === 2 ? 'rare' : 'epic'),
                        description: `Á≠âÁ∫ß${doll.level}ÁöÑÂ®ÉÂ®ÉÔºåÊØèÊó•Êî∂Áõä${doll.dailyEarnings}`,
                        obtainTime: doll.purchaseDate || new Date().toISOString(),
                        usable: true,
                        sellable: true,
                        dollData: doll,
                        attributes: doll.attributes || {
                            strength: 10,
                            agility: 10,
                            intelligence: 10,
                            luck: 10
                        }
                    });
                    
                    // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                    this.saveBagData();
                }
            },
            
            // ÂêåÊ≠•Ë£ÖÂ§áÂà∞ËÉåÂåÖ - Êñ∞Â¢û
            syncEquipmentToBag() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰ªéË£ÖÂ§áÁ≥ªÁªüËé∑ÂèñË£ÖÂ§áÊï∞ÊçÆ
                const savedEquipment = localStorage.getItem(`equipment_${userId}`);
                if (savedEquipment) {
                    const equipment = JSON.parse(savedEquipment);
                    
                    equipment.forEach(item => {
                        // Ê£ÄÊü•ËÉåÂåÖ‰∏≠ÊòØÂê¶Â∑≤Â≠òÂú®ËØ•Ë£ÖÂ§á
                        const existingEquipment = this.bagModalData.bagItems.find(bagItem => 
                            bagItem.id === item.id && bagItem.category === 'equipment'
                        );
                        
                        if (!existingEquipment) {
                            // Ê∑ªÂä†Ë£ÖÂ§áÂà∞ËÉåÂåÖ
                            this.bagModalData.bagItems.push({
                                id: item.id,
                                name: item.name,
                                icon: item.icon,
                                category: 'equipment',
                                count: 1,
                                value: item.value || 100,
                                quality: 'rare',
                                description: item.description || 'Ë£ÖÂ§á',
                                obtainTime: new Date().toISOString(),
                                usable: true,
                                sellable: true,
                                equipmentType: item.type,
                                equipmentStats: item.stats,
                                originalPrice: item.price
                            });
                        }
                    });
                }
                
                // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                this.saveBagData();
            },
            
            // ÂêåÊ≠•Â®ÉÂ®É‰πãÁéãË£ÖÂ§áÂà∞ËÉåÂåÖ - Êñ∞Â¢û
            syncKingGameEquipmentToBag() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰ªéÂ®ÉÂ®É‰πãÁéãËé∑ÂèñË£ÖÂ§áÊï∞ÊçÆ
                const savedKingGame = localStorage.getItem(`kingGame_${userId}`);
                if (savedKingGame) {
                    const kingGame = JSON.parse(savedKingGame);
                    
                    // Ê£ÄÊü•Ë£ÖÂ§á
                    const equipmentTypes = ['weapon', 'armor', 'boots', 'helmet', 'amulet', 'ring'];
                    const equipmentIcons = {
                        weapon: '‚öîÔ∏è',
                        armor: 'üõ°Ô∏è',
                        boots: 'üëü',
                        helmet: '‚õëÔ∏è',
                        amulet: 'üìø',
                        ring: 'üíç'
                    };
                    const equipmentNames = {
                        weapon: 'Ê≠¶Âô®',
                        armor: 'Êä§Áî≤',
                        boots: 'Èù¥Â≠ê',
                        helmet: 'Â§¥Áõî',
                        amulet: 'Êä§Ë∫´Á¨¶',
                        ring: 'ÊàíÊåá'
                    };
                    const equipmentStats = {
                        weapon: { strength: 5, critRate: 2 },
                        armor: { defense: 5, health: 20 },
                        boots: { agility: 5, defense: 3 },
                        helmet: { intelligence: 3, magicPower: 5 },
                        amulet: { magicPower: 8, magic: 5, magicCritRate: 3 },
                        ring: { strength: 3, agility: 3, intelligence: 3, luck: 3 }
                    };
                    
                    equipmentTypes.forEach(type => {
                        if (kingGame.equipment && kingGame.equipment[type]) {
                            // Ê£ÄÊü•ËÉåÂåÖ‰∏≠ÊòØÂê¶Â∑≤Â≠òÂú®ËØ•Ë£ÖÂ§á
                            const existingEquipment = this.bagModalData.bagItems.find(item => 
                                item.id === kingGame.equipment[type] && item.category === 'equipment'
                            );
                            
                            if (!existingEquipment) {
                                // Ê∑ªÂä†Ë£ÖÂ§áÂà∞ËÉåÂåÖ
                                this.bagModalData.bagItems.push({
                                    id: `equipment_${type}`,
                                    name: equipmentNames[type],
                                    icon: equipmentIcons[type],
                                    category: 'equipment',
                                    count: 1,
                                    value: 100,
                                    quality: 'rare',
                                    description: `${equipmentNames[type]} - Êù•Ëá™Â®ÉÂ®É‰πãÁéã`,
                                    obtainTime: new Date().toISOString(),
                                    usable: true,
                                    sellable: true,
                                    equipmentType: type,
                                    equipmentStats: equipmentStats[type],
                                    originalPrice: 100
                                });
                            }
                        }
                    });
                }
                
                // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                this.saveBagData();
            },
            
            // ÂêåÊ≠•Â®ÉÂ®É‰πãÁéãÂ®ÉÂ®ÉÂà∞ËÉåÂåÖ - Êñ∞Â¢û
            syncKingGameDollsToBag() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰ªéÂ®ÉÂ®ÉÁ≥ªÁªüËé∑ÂèñÂ®ÉÂ®ÉÊï∞ÊçÆ
                const savedDolls = localStorage.getItem(`userDolls_${userId}`);
                if (savedDolls) {
                    const dolls = JSON.parse(savedDolls);
                    
                    dolls.forEach(doll => {
                        // Ê£ÄÊü•ËÉåÂåÖ‰∏≠ÊòØÂê¶Â∑≤Â≠òÂú®ËØ•Â®ÉÂ®É
                        const existingDoll = this.bagModalData.bagItems.find(item => 
                            item.id === doll.id && item.category === 'doll'
                        );
                        
                        if (!existingDoll) {
                            // Ê∑ªÂä†Â®ÉÂ®ÉÂà∞ËÉåÂåÖ
                            this.bagModalData.bagItems.push({
                                id: doll.id,
                                name: doll.name || `${doll.level}Á∫ßÂ®ÉÂ®É`,
                                icon: doll.icon || 'üß∏',
                                category: 'doll',
                                count: 1,
                                value: doll.level === 1 ? 50 : (doll.level === 2 ? 200 : 500),
                                quality: doll.level === 1 ? 'common' : (doll.level === 2 ? 'rare' : 'epic'),
                                description: `Á≠âÁ∫ß${doll.level}ÁöÑÂ®ÉÂ®ÉÔºåÊØèÊó•Êî∂Áõä${doll.dailyEarnings}`,
                                obtainTime: doll.purchaseDate || new Date().toISOString(),
                                usable: true,
                                sellable: true,
                                dollData: doll,
                                attributes: doll.attributes || {
                                    strength: 10,
                                    agility: 10,
                                    intelligence: 10,
                                    luck: 10
                                }
                            });
                        }
                    });
                }
                
                // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                this.saveBagData();
            },
            
            // ÂêåÊ≠•Â®ÉÂ®É‰πãÁéãÁé∞ÈáëÁ∫¢ÂåÖÂà∞ËÉåÂåÖ - Êñ∞Â¢û
            syncKingGameRedPacketsToBag() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                
                // ‰ªélocalStorageÂä†ËΩΩÁé∞ÈáëÁ∫¢ÂåÖÊï∞ÊçÆ
                const savedRedPackets = localStorage.getItem(`redPackets_${userId}`);
                if (savedRedPackets) {
                    const redPackets = JSON.parse(savedRedPackets);
                    
                    redPackets.forEach(packet => {
                        // Ê£ÄÊü•ËÉåÂåÖ‰∏≠ÊòØÂê¶Â∑≤Â≠òÂú®ËØ•Á∫¢ÂåÖ
                        const existingPacket = this.bagModalData.bagItems.find(item => 
                            item.id === packet.id && item.category === 'currency'
                        );
                        
                        if (!existingPacket) {
                            // Ê∑ªÂä†Á∫¢ÂåÖÂà∞ËÉåÂåÖ
                            this.bagModalData.bagItems.push({
                                id: packet.id,
                                name: 'Áé∞ÈáëÁ∫¢ÂåÖ',
                                icon: 'üßß',
                                category: 'currency',
                                count: 1,
                                value: packet.amount,
                                quality: 'legendary',
                                description: `Áé∞ÈáëÁ∫¢ÂåÖ ¬•${packet.amount}`,
                                obtainTime: packet.obtainTime,
                                usable: true,
                                sellable: true,
                                isRedPacket: true,
                                amount: packet.amount
                            });
                        }
                    });
                }
                
                // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ
                this.saveBagData();
            },
            
            // ‰øùÂ≠òËÉåÂåÖÊï∞ÊçÆ - Êñ∞Â¢û
            saveBagData() {
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const userId = user.id || user.username;
                localStorage.setItem(`bagItems_${userId}`, JSON.stringify(this.bagModalData.bagItems));
            },
            
            // ÂàáÊç¢ËÉåÂåÖÂàÜÁ±ª - Êñ∞Â¢û
            switchBagCategory(category) {
                this.bagModalData.currentCategory = category;
                
                // Êõ¥Êñ∞ÂàÜÁ±ªUI
                document.querySelectorAll('.bag-modal-category-item').forEach(item => {
                    item.classList.remove('active');
                });
                document.querySelector(`[data-category="${category}"]`).classList.add('active');
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateBagModalDisplay();
            },
            
            // Êõ¥Êñ∞ËÉåÂåÖÂºπÁ™óÊòæÁ§∫ - Êñ∞Â¢û
            updateBagModalDisplay() {
                const bagGrid = document.getElementById('bagModalGrid');
                if (!bagGrid) return;
                
                // ËøáÊª§Áâ©ÂìÅ
                let filteredItems = this.bagModalData.bagItems;
                if (this.bagModalData.currentCategory !== 'all') {
                    filteredItems = this.bagModalData.bagItems.filter(item => 
                        item.category === this.bagModalData.currentCategory
                    );
                }
                
                // Â¶ÇÊûúÊ≤°ÊúâÁâ©ÂìÅ
                if (filteredItems.length === 0) {
                    bagGrid.innerHTML = `
                        <div class="empty-state" style="grid-column: 1 / -1;">
                            <div class="empty-icon">üéí</div>
                            <div class="empty-title">ËÉåÂåÖÊòØÁ©∫ÁöÑ</div>
                            <div class="empty-desc">ÊÇ®ËøòÊ≤°Êúâ‰ªª‰ΩïÁâ©ÂìÅ</div>
                        </div>
                    `;
                    return;
                }
                
                // ÁîüÊàêÁâ©ÂìÅÁΩëÊ†º - Êñ∞Â¢û
                bagGrid.innerHTML = filteredItems.map(item => {
                    const qualityClass = item.quality || 'common';
                    const qualityText = this.getQualityText(item.quality);
                    
                    // Ê†πÊçÆÁâ©ÂìÅÁ±ªÂûãÁîüÊàê‰∏çÂêåÁöÑHTML - Êñ∞Â¢û
                    let itemHtml = '';
                    
                    if (item.category === 'doll') {
                        // Â®ÉÂ®ÉÁâ©ÂìÅ - Êñ∞Â¢û
                        itemHtml = `
                            <div class="bag-modal-item bag-modal-doll-item" data-id="${item.id}">
                                ${item.quality ? `<div class="bag-modal-item-quality ${qualityClass}">${qualityText}</div>` : ''}
                                <div class="bag-modal-doll-level">Lv.${item.dollData ? item.dollData.level : 1}</div>
                                <div class="bag-modal-item-icon">${item.icon}</div>
                                <div class="bag-modal-item-name">${item.name}</div>
                                <div class="bag-modal-doll-attributes">
                                    <span>Êîª:${item.attributes.strength}</span>
                                    <span>Êïè:${item.attributes.agility}</span>
                                    <span>Êô∫:${item.attributes.intelligence}</span>
                                    <span>Âπ∏:${item.attributes.luck}</span>
                                </div>
                            </div>
                        `;
                    } else if (item.category === 'equipment') {
                        // Ë£ÖÂ§áÁâ©ÂìÅ - Êñ∞Â¢û
                        itemHtml = `
                            <div class="bag-modal-item bag-modal-equipment-item" data-id="${item.id}">
                                ${item.quality ? `<div class="bag-modal-item-quality ${qualityClass}">${qualityText}</div>` : ''}
                                <div class="bag-modal-equipment-slot">${item.equipmentType}</div>
                                <div class="bag-modal-item-icon">${item.icon}</div>
                                <div class="bag-modal-item-name">${item.name}</div>
                                <div class="bag-modal-equipment-bonus">${this.formatEquipmentStats(item.equipmentStats)}</div>
                            </div>
                        `;
                    } else if (item.category === 'currency') {
                        // Áé∞ÈáëÁâ©ÂìÅ - Êñ∞Â¢û
                        itemHtml = `
                            <div class="bag-modal-item" data-id="${item.id}">
                                ${item.quality ? `<div class="bag-modal-item-quality ${qualityClass}">${qualityText}</div>` : ''}
                                <div class="bag-modal-item-icon">${item.icon}</div>
                                <div class="bag-modal-item-name">${item.name}</div>
                                <div class="bag-modal-item-count">¬•${item.amount.toFixed(2)}</div>
                            </div>
                        `;
                    } else {
                        // ÊôÆÈÄöÁâ©ÂìÅ - Êñ∞Â¢û
                        itemHtml = `
                            <div class="bag-modal-item" data-id="${item.id}">
                                ${item.quality ? `<div class="bag-modal-item-quality ${qualityClass}">${qualityText}</div>` : ''}
                                <div class="bag-modal-item-icon">${item.icon}</div>
                                <div class="bag-modal-item-name">${item.name}</div>
                                <div class="bag-modal-item-count">√ó${item.count}</div>
                            </div>
                        `;
                    }
                    
                    return itemHtml;
                }).join('');
                
                // Êõ¥Êñ∞ÁªüËÆ° - Êñ∞Â¢û
                this.updateBagModalStats();
            },
            
            // Ê†ºÂºèÂåñË£ÖÂ§áÂ±ûÊÄß - Êñ∞Â¢û
            formatEquipmentStats(stats) {
                return Object.entries(stats).map(([key, value]) => {
                    const statName = {
                        'strength': 'ÂäõÈáè',
                        'defense': 'Èò≤Âæ°',
                        'health': 'ÁîüÂëΩÂÄº',
                        'speed': 'ÊîªÈÄü',
                        'magicPower': 'Ê≥ïÂº∫',
                        'magic': 'Ê≥ïÂäõÂÄº',
                        'critRate': 'Êö¥ÂáªÁéá',
                        'critDamage': 'Êö¥Âáª‰º§ÂÆ≥',
                        'magicCritRate': 'Ê≥ïÊúØÊö¥ÂáªÁéá',
                        'magicCritDamage': 'Ê≥ïÊúØÊö¥Âáª‰º§ÂÆ≥'
                    };
                    
                    const statName = statName[key] || key;
                    const statValue = value;
                    
                    return `${statName}: +${statValue}`;
                }).join(' ');
            },
            
            // Ëé∑ÂèñÂìÅË¥®ÊñáÊú¨ - Êñ∞Â¢û
            getQualityText(quality) {
                const qualityTexts = {
                    'common': 'ÊôÆÈÄö',
                    'rare': 'Á®ÄÊúâ',
                    'epic': 'Âè≤ËØó',
                    'legendary': '‰º†ËØ¥'
                };
                return qualityTexts[quality] || 'ÊôÆÈÄö';
            },
            
            // Êõ¥Êñ∞ËÉåÂåÖÂºπÁ™óÁªüËÆ° - Êñ∞Â¢û
            updateBagModalStats() {
                // Êõ¥Êñ∞ÂàÜÁ±ªÊï∞Èáè
                const categories = ['all', 'doll', 'item', 'equipment', 'skin', 'currency', 'other'];
                categories.forEach(category => {
                    const count = category === 'all' ? 
                        this.bagModalData.bagItems.length : 
                        this.bagModalData.bagItems.filter(item => item.category === category).length;
                    
                    const countElement = document.getElementById(`bagModal${category.charAt(0).toUpperCase() + category.slice(1)}Count`);
                    if (countElement) {
                        countElement.textContent = count;
                    }
                });
                
                // Êõ¥Êñ∞ÊÄªÁâ©ÂìÅÂíåÊÄª‰ª∑ÂÄº
                const totalItems = this.bagModalData.bagItems.reduce((sum, item) => sum + item.count, 0);
                const totalValue = this.bagModalData.bagItems.reduce((sum, item) => sum + (item.value * item.count), 0);
                
                const totalItemsElement = document.getElementById('bagModalTotalItems');
                const totalValueElement = document.getElementById('bagModalTotalValue');
                
                if (totalItemsElement) totalItemsElement.textContent = totalItems;
                if (totalValueElement) totalValueElement.textContent = totalValue;
            },
            
            // Ëé∑ÂèñÂìÅË¥®ÊñáÊú¨ - Êñ∞Â¢û
            getQualityText(quality) {
                const qualityTexts = {
                    'common': 'ÊôÆÈÄö',
                    'rare': 'Á®ÄÊúâ',
                    'epic': 'Âè≤ËØó',
                    'legendary': '‰º†ËØ¥'
                };
                return qualityTexts[quality] || 'ÊôÆÈÄö';
            },
            
            // Êõ¥Êñ∞Â®ÉÂ®É‰πãÁéãÊòæÁ§∫ - Êñ∞Â¢û
            updateKingDollDisplay() {
                const display = document.getElementById('kingDollDisplay');
                const game = this.gameState.kingGame;
                
                if (display) {
                    display.classList.add('equipped');
                    display.textContent = 'üëë';
                } else {
                    display.classList.remove('equipped');
                    display.textContent = 'üß∏';
                }
            },
            
            // Êõ¥Êñ∞Â®ÉÂ®É‰πãÁéãÊ∏∏ÊàèÊòæÁ§∫ - Êñ∞Â¢û
            updateKingGameDisplay() {
                const game = this.gameState.kingGame;
                
                // Êõ¥Êñ∞Â®ÉÂ®É‰πãÁéãÊòæÁ§∫
                this.updateKingDollDisplay();
                
                // Êõ¥Êñ∞Ê∏∏ÊàèÁªüËÆ°
                document.getElementById('totalPower').textContent = this.calculateTotalPower();
                document.getElementById('currentLevel').textContent = game.currentLevel;
                document.getElementById('totalWins').textContent = game.totalWins;
                document.getElementById('trainingPoints').textContent = game.trainingPoints;
                
                // Êõ¥Êñ∞Â±ûÊÄßÊòæÁ§∫
                this.updateAttributesDisplay();
                
                // Êõ¥Êñ∞Ë£ÖÂ§áÊòæÁ§∫
                this.updateEquipmentDisplay();
                
                // Êõ¥Êñ∞ÊàòÂäõÊòæÁ§∫
                this.updateCombatPower();
            },
            
            // ËÆ°ÁÆóÊÄªÊàòÂäõ - Êñ∞Â¢û
            calculateTotalPower() {
                const game = this.gameState.kingGame;
                const basePower = game.attributes.strength + game.attributes.defense + 
                                    game.attributes.health + game.attributes.speed + 
                                    game.attributes.magicPower + game.attributes.magic;
                
                // Ë£ÖÂ§áÂä†Êàê
                let equipmentBonus = 0;
                Object.keys(game.equipment).forEach(type => {
                    if (game.equipment[type]) {
                        const item = game.shopItems.find(shopItem => shopItem.type === type && shopItem.owned);
                        if (item) {
                            Object.values(item.stats).forEach(value => {
                                equipmentBonus += value;
                            });
                        }
                    }
                });
                
                return basePower + equipmentBonus;
            },
            
            // Êõ¥Êñ∞Â±ûÊÄßÊòæÁ§∫ - Êñ∞Â¢û
            updateAttributesDisplay() {
                const game = this.gameState.kingGame;
                
                // Êõ¥Êñ∞Êï∞ÂÄº
                document.getElementById('strengthValue').textContent = game.attributes.strength;
                document.getElementById('agilityValue').textContent = game.attributes.agility;
                document.getElementById('intelligenceValue').textContent = game.attributes.intelligence;
                document.getElementById('defenseValue').textContent = game.attributes.defense;
                document.getElementById('healthValue').textContent = game.attributes.health;
                document.getElementById('speedValue').textContent = game.attributes.speed;
                document.getElementById('magicPowerValue').textContent = game.attributes.magicPower;
                document.getElementById('magicValue').textContent = game.attributes.magic;
                document.getElementById('critValue').textContent = game.attributes.critRate + '%';
                document.getElementById('critDamageValue').textContent = game.attributes.critDamage + '%';
                document.getElementById('magicCritRateValue').textContent = game.attributes.magicCritRate + '%';
                document.getElementById('magicCritDamageValue').textContent = game.attributes.magicCritDamage + '%';
                
                // Êõ¥Êñ∞ËøõÂ∫¶Êù°ÔºàÂÅáËÆæÊúÄÂ§ßÂÄº‰∏∫100Ôºâ
                const maxValue = 100;
                document.getElementById('strengthBar').style.width = (game.attributes.strength / maxValue * 100) + '%';
                document.getElementById('agilityBar').style.width = (game.attributes.agility / maxValue * 100) + '%';
                document.getElementById('intelligenceBar').style.width = (game.attributes.intelligence / maxValue * 100) + '%';
                document.getElementById('defenseBar').style.width = (game.attributes.defense / maxValue * 100) + '%';
                document.getElementById('healthBar').style.width = (game.attributes.health / game.attributes.maxHealth * 100) + '%';
                document.getElementById('speedBar').style.width = (game.attributes.speed / 100 * 100) + '%';
                document.getElementById('magicPowerBar').style.width = (game.attributes.magicPower / 100 * 100) + '%';
                document.getElementById('magicBar').style.width = (game.attributes.magic / 100 * 100) + '%';
                document.getElementById('critBar').style.width = (game.attributes.critRate / 100 * 100) + '%';
                document.getElementById('critDamageBar').style.width = (game.attributes.critDamage / 100 * 100) + '%';
                document.getElementById('magicCritRateBar').style.width = (game.attributes.magicCritRate / 100 * 100) + '%';
                document.getElementById('magicCritDamageBar').style.width = (game.attributes.magicCritDamage / 100 * 100) + '%';
            },
            
            // Êõ¥Êñ∞Ë£ÖÂ§áÊòæÁ§∫ - Êñ∞Â¢û
            updateEquipmentDisplay() {
                const game = this.gameState.kingGame;
                
                const equipmentSlots = document.getElementById('equipmentSlots');
                if (equipmentSlots) {
                    const equipmentTypes = ['weapon', 'armor', 'boots', 'helmet', 'amulet', 'ring'];
                    
                    equipmentSlots.innerHTML = equipmentTypes.map(type => {
                        const item = game.shopItems.find(shopItem => shopItem.type === type && shopItem.owned);
                        const equipped = game.equipment[type];
                        
                        return `
                            <div class="equipment-slot ${equipped ? 'equipped' : ''}" onclick="toggleEquipment('${type}')">
                                <div class="equipment-icon">${equipmentIcons[type]}</div>
                                <div class="equipment-name">${equipmentNames[type]}</div>
                                <div class="equipment-stats">
                                    ${item ? Object.entries(item.stats).map(([key, value]) => 
                                        `<div>${this.getStatName(key)}: +${value}</div>`
                                    ).join('')}
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            },
            
            // ÂàáÊç¢Ë£ÖÂ§á - Êñ∞Â¢û
            toggleEquipment(type) {
                const game = this.gameState.kingGame;
                const item = game.shopItems.find(shopItem => shopItem.type === type);
                
                if (!item) {
                    this.showNotification('error', 'Ë£ÖÂ§á‰∏çÂ≠òÂú®ÔºÅ', 'error');
                    return;
                }
                
                if (game.equipment[type]) {
                    // Âç∏‰∏ãË£ÖÂ§á
                    this.removeEquipmentStats(type);
                } else {
                    // Ë£ÖÂ§áË£ÖÂ§á
                    this.applyEquipmentStats(item);
                }
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateEquipmentDisplay();
                this.updateCombatPower();
            },
            
            // Â∫îÁî®Ë£ÖÂ§áÊïàÊûú - Êñ∞Â¢û
            applyEquipmentStats(item) {
                const game = this.gameState.kingGame;
                
                // Â∫îÁî®Ë£ÖÂ§áÂ±ûÊÄß
                Object.entries(item.stats).forEach(([key, value]) => {
                    if (game.attributes[key] !== undefined) {
                        game.attributes[key] += value;
                    }
                });
                
                // Ê†áËÆ∞Ë£ÖÂ§á‰∏∫Â∑≤Ë£ÖÂ§á
                game.equipment[type] = item.id;
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateEquipmentDisplay();
                this.updateCombatPower();
            },
            
            // ÁßªÈô§Ë£ÖÂ§áÊïàÊûú - Êñ∞Â¢û
            removeEquipmentStats(item) {
                const game = this.gameState.kingGame;
                
                // ÁßªÈô§Ë£ÖÂ§áÂ±ûÊÄß
                Object.entries(item.stats).forEach(([key, value]) => {
                    if (game.attributes[key] !== undefined) {
                        game.attributes[key] -= value;
                    }
                });
                
                // ÂèñÊ∂àË£ÖÂ§áÊ†áËÆ∞
                delete game.equipment[type];
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateEquipmentDisplay();
                this.updateCombatPower();
            },
            
            // Êõ¥Êñ∞ÊàòÂäõÊòæÁ§∫ - Êñ∞Â¢û
            updateCombatPower() {
                const totalPower = this.calculateTotalPower();
                document.getElementById('combatPower').textContent = totalPower;
                
                // Êõ¥Êñ∞ÂêÑÈ°πÂ±ûÊÄßÊòæÁ§∫
                const game = this.gameState.kingGame;
                
                document.getElementById('attackPower').textContent = game.attributes.strength;
                document.getElementById('defensePower').textContent = game.attributes.defense;
                document.getElementById('healthPower').textContent = game.attributes.health;
                document.getElementById('speedPower').textContent = game.attributes.speed;
                document.getElementById('magicPower').textContent = game.attributes.magicPower;
                document.getElementById('magicPower').textContent = game.attributes.magic;
                document.getElementById('critPower').textContent = game.attributes.critRate + '%';
                document.getElementById('critDamage').textContent = game.attributes.critDamage + '%';
                document.getElementById('magicCritRate').textContent = game.attributes.magicCritRate + '%';
                document.getElementById('magicCritDamage').textContent = game.attributes.magicCritDamage + '%';
                
                // Êõ¥Êñ∞ÊÄªÊàòÂäõÊòæÁ§∫
                const attackPower = game.attributes.strength;
                const defensePower = game.attributes.defense;
                const healthPower = game.attributes.health;
                const speedPower = game.attributes.speed;
                const magicPower = game.attributes.magicPower;
                const magic = game.attributes.magic;
                const critRate = game.attributes.critRate;
                const critDamage = game.attributes.critDamage;
                const magicCritRate = game.attributes.magicCritRate;
                
                document.getElementById('attackPower').textContent = attackPower;
                document.getElementById('defensePower').textContent = defensePower;
                document.getElementById('healthPower').textContent = healthPower;
                document.getElementById('speedPower').textContent = speedPower;
                document.getElementById('magicPower').textContent = magicPower;
                document.getElementById('critPower').textContent = critRate + '%';
                document.getElementById('critDamage').textContent = critDamage + '%';
                document.getElementById('magicCritRate').textContent = magicCritRate + '%';
                document.getElementById('magicCritDamage').textContent = magicCritDamage + '%';
                
                // Êõ¥Êñ∞ÊàòÂäõÊòæÁ§∫
                document.getElementById('attackPower').textContent = this.calculateAttackPower();
                document.getElementById('defensePower').textContent = this.calculateDefensePower();
                document.getElementById('healthPower').textContent = this.calculateHealthPower();
                document.getElementById('speedPower').textContent = this.calculateSpeedPower();
                document.getElementById('magicPower').textContent = this.calculateMagicPower();
            },
            
            // ËÆ°ÁÆóÊîªÂáªÂäõ
            calculateAttackPower() {
                const game = this.gameState.kingGame;
                return game.attributes.strength + (game.attributes.critRate / 100 * game.attributes.critDamage / 100);
            },
            
            // ËÆ°ÁÆóÈò≤Âæ°Âäõ
            calculateDefensePower() {
                const game = this.gameState.kingGame;
                return game.attributes.defense;
            },
            
            // ËÆ°ÁÆóÁîüÂëΩÂÄº
            calculateHealthPower() {
                const game = this.gameState.kingGame;
                return game.attributes.health;
            },
            
            // ËÆ°ÁÆóÈÄüÂ∫¶
            calculateSpeedPower() {
                const game = this.gameState.kingGame;
                return game.attributes.speed;
            },
            
            // ËÆ°ÁÆóÈ≠îÊ≥ïÂäõ
            calculateMagicPower() {
                const game = this.gameState.kingGame;
                return game.attributes.magicPower;
            },
            
            // ËÆ°ÁÆóÊ≥ïÊúØÊö¥Âáª‰º§ÂÆ≥
            calculateMagicCritDamage() {
                const game = this.gameState.kingGame;
                return game.attributes.magicCritRate / 100 * game.attributes.magicCritDamage / 100;
            },
            
            // ËÆ°ÁÆóÊ≥ïÊúØÊö¥ÂáªÁéá
            calculateMagicCritRate() {
                const game = this.gameState.kingGame;
                return game.attributes.magicCritRate;
            },
            
            // ËÆ°ÁÆóÁâ©ÁêÜÊö¥Âáª‰º§ÂÆ≥
            calculateCritDamage() {
                const game = this.gameState.kingGame;
                return game.attributes.critDamage;
            },
            
            // ËÆ°ÁÆóÁâ©ÁêÜÊö¥ÂáªÁéá
            calculateCritRate() {
                const game = this.gameState.kingGame;
                return game.attributes.critRate;
            },
            
            // ËÆ°ÁÆóÁâ©ÁêÜÊö¥Âáª‰º§ÂÆ≥
            calculateCritDamage() {
                const game = this.gameState.kingGame;
                return game.attributes.critDamage;
            },
            
            // Êõ¥Êñ∞Â±ûÊÄßÊòæÁ§∫ - Êñ∞Â¢û
            updateAttributesDisplay() {
                const game = this.gameState.kingGame;
                
                // Êõ¥Êñ∞Êï∞ÂÄº
                document.getElementById('strengthValue').textContent = game.attributes.strength;
                document.getElementById('agilityValue').textContent = game.attributes.agility;
                document.getElementById('intelligenceValue').textContent = game.attributes.intelligence;
                document.getElementById('defenseValue').textContent = game.attributes.defense;
                document.getElementById('healthValue').textContent = game.attributes.health;
                document.getElementById('speedValue').textContent = game.attributes.speed;
                document.getElementById('magicPowerValue').textContent = game.attributes.magicPower;
                document.getElementById('magicValue').textContent = game.attributes.magic;
                document.getElementById('critRate').textContent = game.attributes.critRate + '%';
                document.getElementById('critDamage').textContent = game.attributes.critDamage + '%';
                document.getElementById('magicCritRate').textContent = game.attributes.magicCritRate + '%';
                document.getElementById('magicCritDamage').textContent = game.attributes.magicCritDamage + '%';
                
                // Êõ¥Êñ∞ËøõÂ∫¶Êù°ÔºàÂÅáËÆæÊúÄÂ§ßÂÄº‰∏∫100Ôºâ
                const maxValue = 100;
                document.getElementById('strengthBar').style.width = (game.attributes.strength / maxValue * 100) + '%';
                document.getElementById('agilityBar').style.width = (game.attributes.agility / maxValue * 100) + '%';
                document.getElementById('intelligenceBar').style.width = (game.attributes.intelligence / maxValue * 100) + '%';
                document.getElementById('defenseBar').style.width = (game.attributes.defense / maxValue * 100) + '%';
                document.getElementById('healthBar').style.width = (game.attributes.health / game.attributes.maxHealth * 100) + '%';
                document.getElementById('speedBar').style.width = (game.attributes.speed / maxValue * 100) + '%';
                document.getElementById('magicPowerBar').style.width = (game.attributes.magicPower / maxValue * 100) + '%';
                document.getElementById('magicBar').style.width = (game.attributes.magic / maxValue * 100) + '%';
                document.getElementById('critBar').style.width = (game.attributes.critRate / 100) + '%';
                document.getElementById('critDamageBar').style.width = (game.attributes.critDamage / 100) + '%';
                document.getElementById('magicCritRateBar').style.width = (game.attributes.magicCritRate / 100) + '%';
                document.getElementById('magicCritDamageBar').style.width = (game.attributes.magicCritDamage / 100) + '%';
            },
            
            // Êõ¥Êñ∞ËÆ≠ÁªÉÊåâÈíÆÁä∂ÊÄÅ
            updateTrainButtons() {
                const game = this.gameState.kingGame;
                const trainButtons = document.querySelectorAll('.train-btn');
                
                trainButtons.forEach(button => {
                    if (game.trainingPoints < 5) {
                        button.disabled = true;
                        button.textContent = 'ËÆ≠ÁªÉÁÇπÊï∞‰∏çË∂≥';
                    } else {
                        button.disabled = false;
                        button.textContent = 'ÂºÄÂßãËÆ≠ÁªÉ';
                    }
                });
            },
            
            // Êõ¥Êñ∞Â®ÉÂ®É‰πãÁéãÊòæÁ§∫
            updateKingDollDisplay() {
                const display = document.getElementById('kingDollDisplay');
                const game = this.gameState.kingGame;
                
                if (display) {
                    display.classList.add('equipped');
                    display.textContent = 'üëë';
                } else {
                    display.classList.remove('equipped');
                    display.textContent = 'üß∏';
                }
            },
            
            // Êõ¥Êñ∞Â®ÉÂ®É‰πãÁéãÊ∏∏ÊàèÊòæÁ§∫
            updateKingGameDisplay() {
                const game = this.gameState.kingGame;
                
                // Êõ¥Êñ∞Â®ÉÂ®ÉÊòæÁ§∫
                this.updateKingDollDisplay();
                
                // Êõ¥Êñ∞Ê∏∏ÊàèÁªüËÆ°
                document.getElementById('totalPower').textContent = this.calculateTotalPower();
                document.getElementById('currentLevel').textContent = game.currentLevel;
                document.getElementById('totalWins').textContent = game.totalWins;
                document.getElementById('trainingPoints').textContent = game.trainingPoints;
            },
            
            // Êõ¥Êñ∞Ë£ÖÂ§áÊòæÁ§∫
            updateEquipmentDisplay() {
                const equipmentSlots = document.getElementById('equipmentSlots');
                if (equipmentSlots) {
                    const equipmentTypes = ['weapon', 'armor', 'boots', 'helmet', 'amulet', 'ring'];
                    
                    equipmentSlots.innerHTML = equipmentTypes.map(type => {
                        const item = this.gameState.kingGame.shopItems.find(shopItem => shopItem.type === type && shopItem.owned);
                        const equipped = this.gameState.kingGame.equipment[type];
                        
                        return `
                            <div class="equipment-slot ${equipped ? 'equipped' : ''}" onclick="DollSystem.toggleEquipment('${type}')">
                                <div class="equipment-icon">${equipmentIcons[type]}</div>
                                <div class="equipment-name">${equipmentNames[type]}</div>
                                <div class="equipment-stats">
                                    ${item ? Object.entries(item.stats).map(([key, value]) => 
                                        `<div>${this.getStatName(key)}: +${value}</div>`
                                    ).join('')}
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            },
            
            // Êõ¥Êñ∞ÊàòÂäõÊòæÁ§∫
            updateCombatPower() {
                const totalPower = this.calculateTotalPower();
                document.getElementById('combatPower').textContent = totalPower;
                
                // Êõ¥Êñ∞ÂêÑÈ°πÂ±ûÊÄßÊòæÁ§∫
                const game = this.gameState.kingGame;
                
                document.getElementById('attackPower').textContent = this.calculateAttackPower();
                document.getElementById('defensePower').textContent = this.calculateDefensePower();
                document.getElementById('healthPower').textContent = this.calculateHealthPower();
                document.getElementById('speedPower').textContent = this.calculateSpeedPower();
                document.getElementById('magicPower').textContent = this.calculateMagicPower();
                document.getElementById('critPower').textContent = this.calculateCritRate() + '%';
                document.getElementById('critDamage').textContent = this.calculateCritDamage() + '%';
                document.getElementById('magicCritRate').textContent = this.calculateMagicCritRate() + '%';
                document.getElementById('magicCritDamage').textContent = this.calculateMagicCritDamage() + '%';
            },
            
            // ËÆ°ÁÆóÊîªÂáªÂäõ
            calculateAttackPower() {
                const game = this.gameState.kingGame;
                return game.attributes.strength + (game.attributes.critRate / 100 * game.attributes.critDamage / 100);
            },
            
            // ËÆ°ÁÆóÈò≤Âæ°Âäõ
            calculateDefensePower() {
                const game = this.gameState.kingGame;
                return game.attributes.defense;
            },
            
            // ËÆ°ÁÆóÁîüÂëΩÂÄº
            calculateHealthPower() {
                const game = this.gameState.kingGame;
                return game.attributes.health;
            },
            
            // ËÆ°ÁÆóÈÄüÂ∫¶
            calculateSpeedPower() {
                const game = this.gameState.kingGame;
                return game.attributes.speed;
            },
            
            // ËÆ°ÁÆóÈ≠îÊ≥ïÂäõ
            calculateMagicPower() {
                const game = this.gameState.kingGame;
                return game.attributes.magicPower;
            },
            
            // ËÆ°ÁÆóÊ≥ïÊúØÊö¥Âáª‰º§ÂÆ≥
            calculateMagicCritDamage() {
                const game = this.gameState.kingGame;
                return this.calculateMagicCritDamage();
            },
            
            // ËÆ°ÁÆóÊ≥ïÊúØÊö¥ÂáªÁéá
            calculateMagicCritRate() {
                const game = this.gameState.kingGame;
                return game.attributes.magicCritRate;
            },
            
            // ËÆ°ÁÆóÁâ©ÁêÜÊö¥ÂáªÁéá
            calculateCritRate() {
                const game = this.gameState.kingGame;
                return game.attributes.critRate;
            },
            
            // ËÆ°ÁÆóÁâ©ÁêÜÊö¥Âáª‰º§ÂÆ≥
            calculateCritDamage() {
                const game = this.gameState.kingGame;
                return this.calculateCritDamage();
            },
            
            // ËÆ°ÁÆóÊ≥ïÊúØÊö¥Âáª‰º§ÂÆ≥
            calculateMagicCritDamage() {
                const game = this.gameState.kingGame;
                return this.calculateMagicCritDamage();
            },
            
            // ËÆ°ÁÆóÊÄªÊàòÂäõ
            calculateTotalPower() {
                const game = this.gameState.kingGame;
                return this.calculateTotalPower();
            },
            
            // ËÆ°ÁÆóÊÄªÊàòÂäõ - Êñ∞Â¢û
            calculateTotalPower() {
                const game = this.gameState.kingGame;
                
                // Âü∫Á°ÄÊàòÂäõ
                const basePower = game.attributes.strength + game.attributes.defense + 
                                    game.attributes.health + 
                                    game.attributes.speed + 
                                    game.attributes.magicPower + 
                                    game.attributes.magic;
                
                // Ë£ÖÂ§áÂä†Êàê
                let equipmentBonus = 0;
                Object.keys(game.equipment).forEach(type => {
                    if (game.equipment[type]) {
                        const item = game.shopItems.find(shopItem => shopItem.type === type && shopItem.owned);
                        if (item) {
                            Object.values(item.stats).forEach(value => {
                                equipmentBonus += value;
                            });
                        }
                    }
                });
                
                return basePower + equipmentBonus;
            }
            
                return basePower;
            },
            
            // Êõ¥Êñ∞ÊàòÂäõÊòæÁ§∫
            updateCombatPower() {
                const totalPower = this.calculateTotalPower();
                document.getElementById('combatPower').textContent = totalPower;
                
                // Êõ¥Êñ∞ÂêÑÈ°πÂ±ûÊÄßÊòæÁ§∫
                const game = this.gameState.kingGame;
                
                document.getElementById('attackPower').textContent = this.calculateAttackPower();
                document.getElementById('defensePower').textContent = this.calculateDefensePower();
                document.getElementById('healthPower').textContent = this.calculateHealthPower();
                document.getElementById('speedPower').textContent = this.calculateSpeedPower();
                document.getElementById('magicPower').textContent = this.calculateMagicPower();
                document.getElementById('critPower').textContent = this.calculateCritRate() + '%';
                document.getElementById('critDamage').textContent = this.calculateCritDamage() + '%';
                document.getElementById('magicCritRate').textContent = this.calculateMagicCritRate() + '%';
                document.getElementById('magicCritDamage').textContent = this.calculateMagicCritDamage() + '%';
            },
            
            // Êõ¥Êñ∞ËÆ≠ÁªÉÊåâÈíÆÁä∂ÊÄÅ
            updateTrainButtons() {
                const game = this.gameState.kingGame;
                const trainButtons = document.querySelectorAll('.train-btn');
                
                trainButtons.forEach(button => {
                    if (game.trainingPoints < 5) {
                        button.disabled = true;
                        button.textContent = 'ËÆ≠ÁªÉÁÇπÊï∞‰∏çË∂≥';
                    } else {
                        button.disabled = false;
                        button.textContent = 'ÂºÄÂßãËÆ≠ÁªÉ';
                    }
                });
            },
            
            // Â±ûÊÄßËÆ≠ÁªÉ - Êñ∞Â¢û
            trainAttribute(attribute) {
                const game = this.gameState.kingGame;
                
                if (game.trainingPoints < 5) {
                    this.showNotification('error', 'ËÆ≠ÁªÉÁÇπÊï∞‰∏çË∂≥ÔºÅ', 'ÈúÄË¶Å5ËÆ≠ÁªÉÁÇπÊï∞');
                    return;
                }
                
                // Êâ£Èô§ËÆ≠ÁªÉÁÇπÊï∞
                game.trainingPoints -= 5;
                
                // Â¢ûÂä†Â±ûÊÄßÂÄºÔºà1-3ÁÇπÈöèÊú∫Ôºâ
                const increase = Math.floor(Math.random() * 3) + 1;
                game.attributes[attribute] += increase;
                
                // ÁâπÊÆäÂ§ÑÁêÜÁîüÂëΩÂÄº
                if (attribute === 'health') {
                    game.attributes.maxHealth += increase;
                }
                
                // ‰øùÂ≠òÊï∞ÊçÆ
                this.saveUserData();
                
                // Êõ¥Êñ∞ÊòæÁ§∫
                this.updateKingGameDisplay();
                this.updateAttributesDisplay();
                
                this.showNotification('success', 'ËÆ≠ÁªÉÊàêÂäü', `${this.getAttributeName(attribute)}ÊèêÂçá‰∫Ü${increase}ÁÇπÔºÅ`);
            },
            
            // Ëé∑ÂèñÂ±ûÊÄßÂêçÁß∞
            getAttributeName(attribute) {
                const names = {
                    'strength': 'ÂäõÈáè',
                    'agility': 'ÊïèÊç∑',
                    'intelligence': 'Êô∫Âäõ',
                    'defense': 'Èò≤Âæ°',
                    'health': 'ÁîüÂëΩÂÄº',
                    'speed': 'ÊîªÈÄü',
                    'magicPower': 'Ê≥ïÂº∫',
                    'magic': 'Ê≥ïÂäõÂÄº',
                    'critRate': 'Êö¥ÂáªÁéá',
                    'critDamage': 'Êö¥Âáª‰º§ÂÆ≥',
                    'magicCritRate': 'Ê≥ïÊúØÊö¥ÂáªÁéá',
                    'magicCritDamage': 'Ê≥ïÊúØÊö¥Âáª‰º§ÂÆ≥'
                };
                return names[attribute] || attribute;
            },
            
            // ÊòæÁ§∫ÈÄöÁü•
            showNotification(type, title, message) {
                // ÁßªÈô§Áé∞ÊúâÈÄöÁü•
                const existingMessage = document.querySelector('.notification');
                if (existingMessage) {
                    existingMessage.remove();
                }
                
                // ÂàõÂª∫Êñ∞ÈÄöÁü•
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <div class="notification-icon">${type === 'success' ? '‚úì' : type === 'error' ? '‚úó' : type === 'info' : '‚ÑπÔ∏è'}</div>
                    <div class="notification-content">
                        <div class="notification-title">${title}</div>
                        <div class="notification-message">${message}</div>
                    </div>
                `;
                
                document.body.appendChild(notification);
                
                // ÊòæÁ§∫Âä®Áîª
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);
                
                // Ëá™Âä®ÈöêËóè
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            },
            
            // ÊòæÁ§∫ËßÑÂàô
            showRules() {
                document.getElementById('rulesModal').classList.add('active');
            },
            
            // ÂÖ≥Èó≠ËßÑÂàô
            closeRules() {
                document.getElementById('rulesModal').classList.remove('active');
            },
            
            // ÊòæÁ§∫Ê¥ªÂä®
            showActivities() {
                document.getElementById('activitiesModal').classList.add('active');
            },
            
            // ÂÖ≥Èó≠Ê¥ªÂä®
            closeActivities() {
                document.getElementById('activitiesModal').classList.remove('active');
            },
            
            // ÈÄÄÂá∫ÁôªÂΩï
            logout() {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('currentUser');
                this.showNotification('info', 'ÈÄÄÂá∫ÁôªÂΩï', 'ÊÇ®Â∑≤ÊàêÂäüÈÄÄÂá∫ÁôªÂΩï');
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1000);
            }
        };
        
        // È°µÈù¢Âä†ËΩΩÊó∂ÂàùÂßãÂåñ
        window.onload = function() {
            console.log('Â®ÉÂ®ÉÁ≥ªÁªüÈ°µÈù¢Âä†ËΩΩÂÆåÊàêÔºåÂºÄÂßãÂàùÂßãÂåñ');
            DollSystem.init();
        };
    </script>
</body>
</html>
