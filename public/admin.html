<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° - å¤©åˆ›æ—¶ä»£</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* è¿™é‡Œä¿æŒæ‚¨åŸæœ‰çš„æ‰€æœ‰CSSæ ·å¼ä¸å˜ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary: #FF7043;
            --secondary: #FFB74D;
            --accent: #FFC107;
            --bg-dark: #2C3E50;
            --bg-light: #34495E;
            --text-light: #ECF0F1;
            --gradient: linear-gradient(135deg, #FF7043, #FFB74D, #FFC107);
            --shadow: 0 8px 25px rgba(255, 112, 67, 0.3);
            --transition: all 0.3s ease;
            --border-radius: 20px;
        }
        
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #2C3E50, #34495E);
            min-height: 100vh;
            color: var(--text-light);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }
        
        /* åŠ¨æ€èƒŒæ™¯ç²’å­ */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--gradient);
            border-radius: 50%;
            opacity: 0.6;
            animation: particleFloat 20s linear infinite;
        }
        
        .particle.interactive {
            width: 6px;
            height: 6px;
            opacity: 0.8;
            animation: particleFloat 15s linear infinite;
        }
        
        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.6;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(-10vh) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* å¯¼èˆªæ  */
        .navbar {
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(20px);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 2px solid var(--primary);
        }
        
        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 1rem;
            font-size: 2.2rem;
            font-weight: 800;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: logoGlow 3s ease-in-out infinite;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: var(--gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            box-shadow: var(--shadow);
            animation: logoRotate 10s linear infinite;
        }
        
        @keyframes logoGlow {
            0%, 100% {
                filter: drop-shadow(0 0 20px rgba(255, 112, 67, 0.5));
            }
            50% {
                filter: drop-shadow(0 0 30px rgba(255, 112, 67, 0.8));
            }
        }
        
        @keyframes logoRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .settings-btn {
            background: rgba(255, 112, 67, 0.1);
            border: 2px solid rgba(255, 112, 67, 0.3);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            font-size: 1.2rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .settings-btn:hover {
            background: rgba(255, 112, 67, 0.2);
            transform: rotate(30deg);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 112, 67, 0.1);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            border: 2px solid rgba(255, 112, 67, 0.3);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }
        
        .user-info:hover {
            background: rgba(255, 112, 67, 0.2);
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }
        
        .user-details {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-weight: 600;
            color: white;
            font-size: 0.95rem;
        }
        
        .user-points {
            background: var(--gradient);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 112, 67, 0.3);
            border-radius: 15px;
            padding: 1rem;
            margin-top: 0.5rem;
            min-width: 200px;
            box-shadow: var(--shadow);
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: var(--transition);
            z-index: 1001;
        }
        
        .user-info.active .user-dropdown {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .user-dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            transition: var(--transition);
            cursor: pointer;
            color: var(--text-light);
            text-decoration: none;
        }
        
        .user-dropdown-item:hover {
            background: rgba(255, 112, 67, 0.1);
        }
        
        .user-dropdown-divider {
            height: 1px;
            background: rgba(255, 112, 67, 0.3);
            margin: 0.5rem 0;
        }
        
        /* ä¸»å†…å®¹ */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* é¡µé¢æ ‡é¢˜ */
        .page-header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
        }
        
        .page-title {
            font-size: 3rem;
            font-weight: 900;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
            animation: fadeInDown 1s ease;
        }
        
        .page-subtitle {
            font-size: 1.3rem;
            color: var(--text-light);
            margin-bottom: 1rem;
            opacity: 0.9;
            animation: fadeInUp 1s ease 0.3s;
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ç®¡ç†é¢æ¿å¸ƒå±€ */
        .admin-layout {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 2rem;
            height: calc(100vh - 200px);
            min-height: 600px;
        }
        
        /* ä¾§è¾¹æ  */
        .admin-sidebar {
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 112, 67, 0.3);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            overflow-y: auto;
        }
        
        .sidebar-header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255, 112, 67, 0.3);
        }
        
        .sidebar-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            margin-bottom: 0.5rem;
        }
        
        .sidebar-subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .sidebar-menu {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .menu-item {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--text-light);
            text-decoration: none;
        }
        
        .menu-item:hover {
            background: rgba(255, 112, 67, 0.2);
            border-color: rgba(255, 112, 67, 0.4);
            transform: translateX(5px);
        }
        
        .menu-item.active {
            background: var(--gradient);
            border-color: var(--primary);
            color: white;
        }
        
        .menu-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }
        
        .menu-text {
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        /* ä¸»å†…å®¹åŒº */
        .admin-main {
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 112, 67, 0.3);
            border-radius: var(--border-radius);
            padding: 2rem;
            overflow-y: auto;
        }
        
        .main-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid rgba(255, 112, 67, 0.3);
        }
        
        .main-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .main-actions {
            display: flex;
            gap: 1rem;
        }
        
        .action-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .action-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: var(--transition);
        }
        
        .stat-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        .stat-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            color: var(--accent);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 800;
            color: white;
            margin-bottom: 0.3rem;
        }
        
        .stat-label {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* æ•°æ®è¡¨æ ¼ */
        .data-table {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .table-header {
            background: rgba(255, 112, 67, 0.2);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
        }
        
        .table-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .table-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .table-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .table-content {
            overflow-x: auto;
        }
        
        .data-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th {
            background: rgba(255, 255, 255, 0.1);
            padding: 1rem;
            text-align: left;
            color: white;
            font-weight: 600;
            border-bottom: 2px solid rgba(255, 112, 67, 0.3);
        }
        
        .data-table td {
            padding: 1rem;
            color: var(--text-light);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .data-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .user-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.8rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .user-name {
            font-weight: 600;
            color: white;
        }
        
        .user-email {
            color: var(--text-light);
            font-size: 0.8rem;
        }
        
        .status-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-badge.active {
            background: rgba(46, 204, 113, 0.2);
            color: #2ecc71;
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .status-badge.inactive {
            background: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .role-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
            display: inline-block;
        }
        
        .role-badge.admin {
            background: rgba(255, 112, 67, 0.2);
            color: var(--primary);
            border: 1px solid rgba(255, 112, 67, 0.3);
        }
        
        .role-badge.user {
            background: rgba(52, 152, 219, 0.2);
            color: #3498db;
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .table-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .table-action-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .table-action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .table-action-btn.edit {
            border-color: rgba(52, 152, 219, 0.3);
        }
        
        .table-action-btn.edit:hover {
            background: rgba(52, 152, 219, 0.2);
        }
        
        .table-action-btn.delete {
            border-color: rgba(231, 76, 60, 0.3);
        }
        
        .table-action-btn.delete:hover {
            background: rgba(231, 76, 60, 0.2);
        }
        
        .table-action-btn.add-points {
            border-color: rgba(46, 204, 113, 0.3);
        }
        
        .table-action-btn.add-points:hover {
            background: rgba(46, 204, 113, 0.2);
        }
        
        .table-action-btn.deduct-points {
            border-color: rgba(231, 76, 60, 0.3);
        }
        
        .table-action-btn.deduct-points:hover {
            background: rgba(231, 76, 60, 0.2);
        }
        
        /* å¿«é€Ÿæ“ä½œé¢æ¿ */
        .quick-actions {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .quick-actions-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            margin-bottom: 1rem;
        }
        
        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
        }
        
        .quick-action-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 1rem;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            text-decoration: none;
        }
        
        .quick-action-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }
        
        .quick-action-icon {
            font-size: 1.5rem;
        }
        
        .quick-action-text {
            font-size: 0.9rem;
        }
        
        /* ç³»ç»Ÿæ—¥å¿— */
        .system-logs {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .logs-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .logs-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
        }
        
        .logs-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .logs-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .logs-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .logs-content {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 1rem;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.8rem;
            color: #00ff00;
            line-height: 1.4;
        }
        
        .log-entry {
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background: rgba(0, 255, 0, 0.1);
            border-radius: 5px;
            border-left: 3px solid #00ff00;
        }
        
        .log-time {
            color: #00ff00;
            font-weight: 600;
        }
        
        .log-level {
            color: #ffff00;
            font-weight: 600;
            margin: 0 0.5rem;
        }
        
        .log-message {
            color: #ffffff;
        }
        
        /* é€šçŸ¥ */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-dark);
            backdrop-filter: blur(20px);
            padding: 1rem 1.5rem;
            border-radius: 15px;
            box-shadow: var(--shadow);
            z-index: 1001;
            display: flex;
            align-items: center;
            gap: 1rem;
            transform: translateX(400px);
            transition: var(--transition);
            max-width: 350px;
            border-left: 4px solid var(--accent);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            border-left-color: #27AE60;
        }
        
        .notification.error {
            border-left-color: #E74C3C;
        }
        
        .notification.info {
            border-left-color: #3498DB;
        }
        
        .notification-icon {
            font-size: 1.3rem;
            color: var(--accent);
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 600;
            color: white;
            margin-bottom: 0.2rem;
        }
        
        .notification-message {
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .admin-layout {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .admin-sidebar {
                display: none;
            }
            
            .stats-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                padding: 1rem;
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .main-header {
                flex-direction: column;
                gap: 1rem;
                align-items: stretch;
            }
            
            .main-actions {
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .quick-actions-grid {
                grid-template-columns: 1fr;
            }
            
            .data-table {
                overflow-x: auto;
            }
            
            .data-table table {
                min-width: 600px;
            }
        }
    </style>
</head>
<body>
    <!-- åŠ¨æ€èƒŒæ™¯ç²’å­ -->
    <div class="particles" id="particles"></div>
    
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <div class="logo-icon">âš™ï¸</div>
                <div class="logo-text">ç®¡ç†åå°</div>
            </div>
            
            <div class="nav-right">
                <div class="settings-btn" id="settingsBtn">
                    <i class="fas fa-cog"></i>
                </div>
                
                <div class="user-info" id="userInfo">
                    <div class="user-avatar">ğŸ‘¤</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">ç®¡ç†å‘˜</div>
                        <div class="user-points">ğŸ’° <span id="userPoints">0</span></div>
                    </div>
                    
                    <div class="user-dropdown">
                        <a href="index.html" class="user-dropdown-item">
                            <i class="fas fa-home"></i>
                            <span>è¿”å›é¦–é¡µ</span>
                        </a>
                        <a href="user-center.html" class="user-dropdown-item">
                            <i class="fas fa-user"></i>
                            <span>ä¸ªäººèµ„æ–™</span>
                        </a>
                        <a href="achievements.html" class="user-dropdown-item">
                            <i class="fas fa-trophy"></i>
                            <span>æˆå°±</span>
                        </a>
                        <a href="inventory.html" class="user-dropdown-item">
                            <i class="fas fa-box"></i>
                            <span>ç‰©å“æ </span>
                        </a>
                        <a href="bag.html" class="user-dropdown-item">
                            <i class="fas fa-shopping-bag"></i>
                            <span>æˆ‘çš„èƒŒåŒ…</span>
                        </a>
                        <a href="mall.html" class="user-dropdown-item">
                            <i class="fas fa-shopping-cart"></i>
                            <span>å¤©åˆ›å•†åŸ</span>
                        </a>
                        <a href="market.html" class="user-dropdown-item">
                            <i class="fas fa-store"></i>
                            <span>äº¤æ˜“å¸‚åœº</span>
                        </a>
                        <a href="dice.html" class="user-dropdown-item">
                            <i class="fas fa-dice"></i>
                            <span>å¹¸è¿éª°å­</span>
                        </a>
                        <a href="doll.html" class="user-dropdown-item">
                            <i class="fas fa-doll"></i>
                            <span>å¨ƒå¨ƒç³»ç»Ÿ</span>
                        </a>
                        
                        <div class="user-dropdown-divider"></div>
                        
                        <a href="#" class="user-dropdown-item" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>é€€å‡ºç™»å½•</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- ä¸»å†…å®¹ -->
    <main class="main-content">
        <!-- é¡µé¢æ ‡é¢˜ -->
        <section class="page-header">
            <h1 class="page-title">ç®¡ç†åå°</h1>
            <p class="page-subtitle">ç³»ç»Ÿç®¡ç†ï¼Œæ•°æ®ç»Ÿè®¡ï¼Œç”¨æˆ·ç®¡ç†</p>
        </section>
        
        <!-- ç®¡ç†é¢æ¿å¸ƒå±€ -->
        <div class="admin-layout">
            <!-- ä¾§è¾¹æ  -->
            <aside class="admin-sidebar">
                <div class="sidebar-header">
                    <div class="sidebar-title">ç®¡ç†èœå•</div>
                    <div class="sidebar-subtitle">ç³»ç»Ÿæ§åˆ¶ä¸­å¿ƒ</div>
                </div>
                
                <div class="sidebar-menu">
                    <a href="#" class="menu-item active" data-section="dashboard" onclick="showSection('dashboard')">
                        <div class="menu-icon">ğŸ“Š</div>
                        <div class="menu-text">æ•°æ®ç»Ÿè®¡</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="users" onclick="showSection('users')">
                        <div class="menu-icon">ğŸ‘¥</div>
                        <div class="menu-text">ç”¨æˆ·ç®¡ç†</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="orders" onclick="showSection('orders')">
                        <div class="menu-icon">ğŸ›’</div>
                        <div class="menu-text">è®¢å•ç®¡ç†</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="products" onclick="showSection('products')">
                        <div class="menu-icon">ğŸ“¦</div>
                        <div class="menu-text">å•†å“ç®¡ç†</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="market" onclick="showSection('market')">
                        <div class="menu-icon">ğŸª</div>
                        <div class="menu-text">äº¤æ˜“å¸‚åœº</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="logs" onclick="showSection('logs')">
                        <div class="menu-icon">ğŸ“</div>
                        <div class="menu-text">ç³»ç»Ÿæ—¥å¿—</div>
                    </a>
                    
                    <a href="#" class="menu-item" data-section="settings" onclick="showSection('settings')">
                        <div class="menu-icon">âš™ï¸</div>
                        <div class="menu-text">ç³»ç»Ÿè®¾ç½®</div>
                    </a>
                </div>
            </aside>
            
            <!-- ä¸»å†…å®¹åŒº -->
            <div class="admin-main">
                <!-- æ•°æ®ç»Ÿè®¡ -->
                <div id="dashboardSection" class="section-content">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-chart-line"></i>
                            <span>æ•°æ®ç»Ÿè®¡</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="refreshStats()">
                                <i class="fas fa-sync"></i>
                                <span>åˆ·æ–°æ•°æ®</span>
                            </button>
                            <button class="action-btn secondary" onclick="exportStats()">
                                <i class="fas fa-download"></i>
                                <span>å¯¼å‡ºæŠ¥è¡¨</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">ğŸ‘¥</div>
                            <div class="stat-value" id="totalUsers">0</div>
                            <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">ğŸ›’</div>
                            <div class="stat-value" id="totalOrders">0</div>
                            <div class="stat-label">æ€»è®¢å•æ•°</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">ğŸ“¦</div>
                            <div class="stat-value" id="totalProducts">0</div>
                            <div class="stat-label">æ€»å•†å“æ•°</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">ğŸ’°</div>
                            <div class="stat-value" id="totalRevenue">0</div>
                            <div class="stat-label">æ€»æ”¶å…¥</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">ğŸª</div>
                            <div class="stat-value" id="totalMarketItems">0</div>
                            <div class="stat-label">å¸‚åœºå•†å“</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">ğŸ“ˆ</div>
                            <div class="stat-value" id="todayActive">0</div>
                            <div class="stat-label">ä»Šæ—¥æ´»è·ƒ</div>
                        </div>
                    </div>
                    
                    <!-- å¿«é€Ÿæ“ä½œ -->
                    <div class="quick-actions">
                        <div class="quick-actions-title">å¿«é€Ÿæ“ä½œ</div>
                        <div class="quick-actions-grid">
                            <button class="quick-action-btn" onclick="addUser()">
                                <div class="quick-action-icon">â•</div>
                                <div class="quick-action-text">æ·»åŠ ç”¨æˆ·</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="addProduct()">
                                <div class="quick-action-icon">ğŸ“¦</div>
                                <div class="quick-action-text">æ·»åŠ å•†å“</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="backupData()">
                                <div class="quick-action-icon">ğŸ’¾</div>
                                <div class="quick-action-text">å¤‡ä»½æ•°æ®</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="clearCache()">
                                <div class="quick-action-icon">ğŸ—‘ï¸</div>
                                <div class="quick-action-text">æ¸…ç†ç¼“å­˜</div>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ç”¨æˆ·ç®¡ç† -->
                <div id="usersSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-users"></i>
                            <span>ç”¨æˆ·ç®¡ç†</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="addUser()">
                                <i class="fas fa-plus"></i>
                                <span>æ·»åŠ ç”¨æˆ·</span>
                            </button>
                            <button class="action-btn secondary" onclick="exportUsers()">
                                <i class="fas fa-download"></i>
                                <span>å¯¼å‡ºç”¨æˆ·</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">ç”¨æˆ·åˆ—è¡¨</div>
                            <div class="table-actions">
                                <button class="table-btn" onclick="filterUsers()">
                                    <i class="fas fa-filter"></i>
                                    <span>ç­›é€‰</span>
                                </button>
                                <button class="table-btn" onclick="sortUsers()">
                                    <i class="fas fa-sort"></i>
                                    <span>æ’åº</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>ç”¨æˆ·ä¿¡æ¯</th>
                                        <th>è§’è‰²</th>
                                        <th>çŠ¶æ€</th>
                                        <th>ç§¯åˆ†</th>
                                        <th>æ³¨å†Œæ—¶é—´</th>
                                        <th>æœ€åç™»å½•</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTableBody">
                                    <!-- ç”¨æˆ·æ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- è®¢å•ç®¡ç† -->
                <div id="ordersSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-shopping-cart"></i>
                            <span>è®¢å•ç®¡ç†</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="refreshOrders()">
                                <i class="fas fa-sync"></i>
                                <span>åˆ·æ–°è®¢å•</span>
                            </button>
                            <button class="action-btn secondary" onclick="exportOrders()">
                                <i class="fas fa-download"></i>
                                <span>å¯¼å‡ºè®¢å•</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">è®¢å•åˆ—è¡¨</div>
                            <div class="table-actions">
                                <button class="table-btn" onclick="filterOrders()">
                                    <i class="fas fa-filter"></i>
                                    <span>ç­›é€‰</span>
                                </button>
                                <button class="table-btn" onclick="sortOrders()">
                                    <i class="fas fa-sort"></i>
                                    <span>æ’åº</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>è®¢å•ç¼–å·</th>
                                        <th>ç”¨æˆ·</th>
                                        <th>å•†å“</th>
                                        <th>æ•°é‡</th>
                                        <th>æ€»ä»·</th>
                                        <th>çŠ¶æ€</th>
                                        <th>ä¸‹å•æ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    <!-- è®¢å•æ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- å•†å“ç®¡ç† -->
                <div id="productsSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-box"></i>
                            <span>å•†å“ç®¡ç†</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="addProduct()">
                                <i class="fas fa-plus"></i>
                                <span>æ·»åŠ å•†å“</span>
                            </button>
                            <button class="action-btn secondary" onclick="exportProducts()">
                                <i class="fas fa-download"></i>
                                <span>å¯¼å‡ºå•†å“</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">å•†å“åˆ—è¡¨</div>
                            <div class="table-actions">
                                <button class="table-btn" onclick="filterProducts()">
                                    <i class="fas fa-filter"></i>
                                    <span>ç­›é€‰</span>
                                </button>
                                <button class="table-btn" onclick="sortProducts()">
                                    <i class="fas fa-sort"></i>
                                    <span>æ’åº</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>å•†å“ä¿¡æ¯</th>
                                        <th>åˆ†ç±»</th>
                                        <th>ä»·æ ¼</th>
                                        <th>åº“å­˜</th>
                                        <th>çŠ¶æ€</th>
                                        <th>åˆ›å»ºæ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody">
                                    <!-- å•†å“æ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- äº¤æ˜“å¸‚åœºç®¡ç† -->
                <div id="marketSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-store"></i>
                            <span>äº¤æ˜“å¸‚åœº</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="refreshMarket()">
                                <i class="fas fa-sync"></i>
                                <span>åˆ·æ–°å¸‚åœº</span>
                            </button>
                            <button class="action-btn secondary" onclick="exportMarket()">
                                <i class="fas fa-download"></i>
                                <span>å¯¼å‡ºå¸‚åœº</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-header">
                            <div class="table-title">å¸‚åœºå•†å“</div>
                            <div class="table-actions">
                                <button class="table-btn" onclick="filterMarket()">
                                    <i class="fas fa-filter"></i>
                                    <span>ç­›é€‰</span>
                                </button>
                                <button class="table-btn" onclick="sortMarket()">
                                    <i class="fas fa-sort"></i>
                                    <span>æ’åº</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-content">
                            <table>
                                <thead>
                                    <tr>
                                        <th>å•†å“ä¿¡æ¯</th>
                                        <th>å–å®¶</th>
                                        <th>ä»·æ ¼</th>
                                        <th>åº“å­˜</th>
                                        <th>çŠ¶æ€</th>
                                        <th>å‘å¸ƒæ—¶é—´</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="marketTableBody">
                                    <!-- å¸‚åœºæ•°æ®å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- ç³»ç»Ÿæ—¥å¿— -->
                <div id="logsSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-file-alt"></i>
                            <span>ç³»ç»Ÿæ—¥å¿—</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="refreshLogs()">
                                <i class="fas fa-sync"></i>
                                <span>åˆ·æ–°æ—¥å¿—</span>
                            </button>
                            <button class="action-btn secondary" onclick="clearLogs()">
                                <i class="fas fa-trash"></i>
                                <span>æ¸…ç©ºæ—¥å¿—</span>
                            </button>
                            <button class="action-btn secondary" onclick="downloadLogs()">
                                <i class="fas fa-download"></i>
                                <span>ä¸‹è½½æ—¥å¿—</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="system-logs">
                        <div class="logs-header">
                            <div class="logs-title">ç³»ç»Ÿæ—¥å¿—</div>
                            <div class="logs-actions">
                                <button class="logs-btn" onclick="filterLogs('info')">
                                    <i class="fas fa-info-circle"></i>
                                    <span>ä¿¡æ¯</span>
                                </button>
                                <button class="logs-btn" onclick="filterLogs('warning')">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <span>è­¦å‘Š</span>
                                </button>
                                <button class="logs-btn" onclick="filterLogs('error')">
                                    <i class="fas fa-exclamation-circle"></i>
                                    <span>é”™è¯¯</span>
                                </button>
                                <button class="logs-btn" onclick="filterLogs('all')">
                                    <i class="fas fa-list"></i>
                                    <span>å…¨éƒ¨</span>
                                </button>
                            </div>
                        </div>
                        
                        <div class="logs-content" id="logsContent">
                            <!-- æ—¥å¿—å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- ç³»ç»Ÿè®¾ç½® -->
                <div id="settingsSection" class="section-content" style="display: none;">
                    <div class="main-header">
                        <div class="main-title">
                            <i class="fas fa-cog"></i>
                            <span>ç³»ç»Ÿè®¾ç½®</span>
                        </div>
                        <div class="main-actions">
                            <button class="action-btn" onclick="saveSettings()">
                                <i class="fas fa-save"></i>
                                <span>ä¿å­˜è®¾ç½®</span>
                            </button>
                            <button class="action-btn secondary" onclick="resetSettings()">
                                <i class="fas fa-undo"></i>
                                <span>é‡ç½®è®¾ç½®</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="quick-actions">
                        <div class="quick-actions-title">ç³»ç»Ÿè®¾ç½®</div>
                        <div class="quick-actions-grid">
                            <button class="quick-action-btn" onclick="toggleMaintenance()">
                                <div class="quick-action-icon">ğŸ”§</div>
                                <div class="quick-action-text">ç»´æŠ¤æ¨¡å¼</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="toggleDebug()">
                                <div class="quick-action-icon">ğŸ›</div>
                                <div class="quick-action-text">è°ƒè¯•æ¨¡å¼</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="clearAllData()">
                                <div class="quick-action-icon">ğŸ—‘ï¸</div>
                                <div class="quick-action-text">æ¸…ç©ºæ•°æ®</div>
                            </button>
                            
                            <button class="quick-action-btn" onclick="exportAllData()">
                                <div class="quick-action-icon">ğŸ’¾</div>
                                <div class="quick-action-text">å¯¼å‡ºæ•°æ®</div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- APIé…ç½®æ–‡ä»¶ -->
    <script src="api-config.js"></script>
    <script src="api-service.js"></script>
    <script src="data-adapter.js"></script>
    <script src="points-system.js"></script>
    <script src="user-system.js"></script>
    <script src="common.js"></script>
    
    <script>
        // ç®¡ç†åå°ç³»ç»Ÿ - å®Œæ•´ç‰ˆ
        const AdminSystem = {
            // å½“å‰æ˜¾ç¤ºçš„æ¿å—
            currentSection: 'dashboard',
            
            // ç³»ç»Ÿæ•°æ®
            systemData: {
                users: [],
                orders: [],
                products: [],
                marketItems: [],
                logs: []
            },
            
            // ç³»ç»Ÿè®¾ç½®
            systemSettings: {
                maintenance: false,
                debug: false,
                logLevel: 'info'
            },
            
            // åˆå§‹åŒ–
            init() {
                console.log('=== ç®¡ç†åå°ç³»ç»Ÿåˆå§‹åŒ– ===');
                
                // æ£€æŸ¥ç™»å½•çŠ¶æ€å’Œæƒé™
                if (!this.checkAdminAccess()) {
                    return;
                }
                
                // åˆå§‹åŒ–ç²’å­æ•ˆæœ
                this.initParticles();
                
                // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
                this.initEventListeners();
                
                // åŠ è½½ç³»ç»Ÿæ•°æ®
                this.loadSystemData();
                
                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                this.updateStats();
                
                // æ˜¾ç¤ºé»˜è®¤æ¿å—
                this.showSection('dashboard');
                
                // åˆå§‹åŒ–ç³»ç»Ÿæ—¥å¿—
                this.initSystemLogs();
                
                // å®šæœŸåˆ·æ–°æ•°æ®
                this.startAutoRefresh();
                
                console.log('ç®¡ç†åå°ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ');
            },
            
            // æ£€æŸ¥ç®¡ç†å‘˜æƒé™
            checkAdminAccess() {
                try {
                    const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
                    const currentUser = localStorage.getItem('currentUser');
                    
                    if (!isLoggedIn || !currentUser) {
                        console.log('ç”¨æˆ·æœªç™»å½•ï¼Œè·³è½¬åˆ°ç™»å½•é¡µé¢');
                        window.location.href = 'login.html';
                        return false;
                    }
                    
                    const user = JSON.parse(currentUser);
                    
                    // æ£€æŸ¥æ˜¯å¦ä¸ºç®¡ç†å‘˜
                    if (user.username !== '18679012034') {
                        console.log('ç”¨æˆ·ä¸æ˜¯ç®¡ç†å‘˜ï¼Œè·³è½¬åˆ°é¦–é¡µ');
                        window.location.href = 'index.html';
                        return false;
                    }
                    
                    // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
                    this.updateUserInfo();
                    
                    return true;
                } catch (error) {
                    console.error('æ£€æŸ¥ç®¡ç†å‘˜æƒé™å¤±è´¥:', error);
                    return false;
                }
            },
            
            // æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
            updateUserInfo() {
                try {
                    const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                    const userInfo = document.getElementById('userInfo');
                    const userName = document.getElementById('userName');
                    const userPoints = document.getElementById('userPoints');
                    
                    if (user && userInfo && userName && userPoints) {
                        userName.textContent = user.name;
                        // ä½¿ç”¨ç§¯åˆ†ç³»ç»Ÿè·å–ç§¯åˆ†
                        const points = window.pointsSystem ? 
                            window.pointsSystem.getPoints() : 
                            (user.points || 0);
                        userPoints.textContent = points;
                        userInfo.style.display = 'flex';
                    } else {
                        if (userInfo) userInfo.style.display = 'none';
                    }
                } catch (error) {
                    console.error('æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
                }
            },
            
            // åˆå§‹åŒ–ç²’å­æ•ˆæœ
            initParticles() {
                try {
                    const particlesContainer = document.getElementById('particles');
                    const particleCount = 25;
                    
                    for (let i = 0; i < particleCount; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.animationDelay = Math.random() * 10 + 's';
                        particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                        particlesContainer.appendChild(particle);
                    }
                    
                    // æ·»åŠ äº¤äº’ç²’å­
                    for (let i = 0; i < 5; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle interactive';
                        particle.style.left = Math.random() * 100 + '%';
                        particle.style.animationDelay = Math.random() * 5 + 's';
                        particle.style.animationDuration = (10 + Math.random() * 5) + 's';
                        particlesContainer.appendChild(particle);
                    }
                } catch (error) {
                    console.error('åˆå§‹åŒ–ç²’å­æ•ˆæœå¤±è´¥:', error);
                }
            },
            
            // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
            initEventListeners() {
                try {
                    // ç”¨æˆ·ä¸‹æ‹‰èœå•
                    const userInfo = document.getElementById('userInfo');
                    if (userInfo) {
                        userInfo.addEventListener('click', (e) => {
                            e.stopPropagation();
                            userInfo.classList.toggle('active');
                        });
                        
                        document.addEventListener('click', () => {
                            userInfo.classList.remove('active');
                        });
                    }
                    
                    // é€€å‡ºç™»å½•
                    const logoutBtn = document.getElementById('logoutBtn');
                    if (logoutBtn) {
                        logoutBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            this.logout();
                        });
                    }
                    
                    // è®¾ç½®æŒ‰é’®
                    const settingsBtn = document.getElementById('settingsBtn');
                    if (settingsBtn) {
                        settingsBtn.addEventListener('click', () => {
                            this.showNotification('info', 'è®¾ç½®', 'è®¾ç½®åŠŸèƒ½å¼€å‘ä¸­...');
                        });
                    }
                    
                    // ä¾§è¾¹æ èœå•é¡¹
                    const menuItems = document.querySelectorAll('.menu-item');
                    menuItems.forEach(item => {
                        item.addEventListener('click', (e) => {
                            e.preventDefault();
                            const section = item.dataset.section;
                            if (section) {
                                this.showSection(section);
                            // æ›´æ–°æ´»åŠ¨çŠ¶æ€
                                menuItems.forEach(mi => mi.classList.remove('active'));
                                item.classList.add('active');
                            }
                        });
                    });
                } catch (error) {
                    console.error('åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å¤±è´¥:', error);
                }
            },
            
            // åŠ è½½ç³»ç»Ÿæ•°æ®
            loadSystemData() {
                try {
                    // åŠ è½½ç”¨æˆ·æ•°æ®
                    const allUsers = JSON.parse(localStorage.getItem('allUsers') || '[]');
                    this.systemData.users = allUsers;
                    
                    // åŠ è½½è®¢å•æ•°æ®
                    const orders = JSON.parse(localStorage.getItem('userOrders') || '[]');
                    this.systemData.orders = orders;
                    
                    // åŠ è½½å•†å“æ•°æ®
                    const products = JSON.parse(localStorage.getItem('mallProducts') || '[]');
                    this.systemData.products = products;
                    
                    // åŠ è½½å¸‚åœºæ•°æ®
                    const marketItems = JSON.parse(localStorage.getItem('marketItems') || '[]');
                    this.systemData.marketItems = marketItems;
                    
                    // åŠ è½½æ—¥å¿—æ•°æ®
                    const logs = JSON.parse(localStorage.getItem('systemLogs') || '[]');
                    this.systemData.logs = logs;
                    
                    console.log('ç³»ç»Ÿæ•°æ®åŠ è½½å®Œæˆ');
                } catch (error) {
                    console.error('åŠ è½½ç³»ç»Ÿæ•°æ®å¤±è´¥:', error);
                }
            },
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            updateStats() {
                try {
                    // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡
                    const totalUsers = document.getElementById('totalUsers');
                    if (totalUsers) {
                        totalUsers.textContent = this.systemData.users.length;
                    }
                    
                    // æ›´æ–°è®¢å•ç»Ÿè®¡
                    const totalOrders = document.getElementById('totalOrders');
                    if (totalOrders) {
                        totalOrders.textContent = this.systemData.orders.length;
                    }
                    
                    // æ›´æ–°å•†å“ç»Ÿè®¡
                    const totalProducts = document.getElementById('totalProducts');
                    if (totalProducts) {
                        totalProducts.textContent = this.systemData.products.length;
                    }
                    
                    // æ›´æ–°æ”¶å…¥ç»Ÿè®¡
                    const totalRevenue = document.getElementById('totalRevenue');
                    if (totalRevenue) {
                        const revenue = this.systemData.orders.reduce((sum, order) => sum + (order.totalPrice || 0), 0);
                        totalRevenue.textContent = revenue;
                    }
                    
                    // æ›´æ–°å¸‚åœºå•†å“ç»Ÿè®¡
                    const totalMarketItems = document.getElementById('totalMarketItems');
                    if (totalMarketItems) {
                        totalMarketItems.textContent = this.systemData.marketItems.length;
                    }
                    
                    // æ›´æ–°ä»Šæ—¥æ´»è·ƒç”¨æˆ·
                    const todayActive = document.getElementById('todayActive');
                    if (todayActive) {
                        const today = new Date().toDateString();
                        const activeUsers = this.systemData.users.filter(user => {
                            const lastLogin = user.lastLoginTime ? new Date(user.lastLoginTime).toDateString() : '';
                            return lastLogin === today;
                        }).length;
                        todayActive.textContent = activeUsers;
                    }
                } catch (error) {
                    console.error('æ›´æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // æ˜¾ç¤ºæ¿å—
            showSection(section) {
                try {
                    // éšè—æ‰€æœ‰æ¿å—
                    document.querySelectorAll('.section-content').forEach(content => {
                        content.style.display = 'none';
                    });
                    
                    // æ˜¾ç¤ºæŒ‡å®šæ¿å—
                    const sectionElement = document.getElementById(section + 'Section');
                    if (sectionElement) {
                        sectionElement.style.display = 'block';
                    }
                    
                    // æ›´æ–°å½“å‰æ¿å—
                    this.currentSection = section;
                    
                    // æ ¹æ®æ¿å—æ‰§è¡Œç›¸åº”çš„åˆå§‹åŒ–
                    switch (section) {
                        case 'dashboard':
                            this.updateStats();
                            break;
                        case 'users':
                            this.loadUsersTable();
                            break;
                        case 'orders':
                            this.loadOrdersTable();
                            break;
                        case 'products':
                            this.loadProductsTable();
                            break;
                        case 'market':
                            this.loadMarketTable();
                            break;
                        case 'logs':
                            this.refreshLogs();
                            break;
                        case 'settings':
                            this.loadSettings();
                            break;
                    }
                } catch (error) {
                    console.error('æ˜¾ç¤ºæ¿å—å¤±è´¥:', error);
                }
            },
            
            // åŠ è½½ç”¨æˆ·è¡¨æ ¼
            loadUsersTable() {
                try {
                    const tableBody = document.getElementById('usersTableBody');
                    if (!tableBody) return;
                    
                    if (this.systemData.users.length === 0) {
                        tableBody.innerHTML = `
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 2rem;">
                                    <i class="fas fa-users" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                                    <p>æš‚æ— ç”¨æˆ·æ•°æ®</p>
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    tableBody.innerHTML = this.systemData.users.map(user => {
                        const statusClass = user.isActive ? 'active' : 'inactive';
                        const statusText = user.isActive ? 'æ´»è·ƒ' : 'ç¦ç”¨';
                        const roleClass = user.username === '18679012034' ? 'admin' : 'user';
                        const roleText = user.username === '18679012034' ? 'ç®¡ç†å‘˜' : 'ç”¨æˆ·';
                        
                        return `
                            <tr>
                                <td>
                                    <div class="user-info">
                                        <div class="user-avatar">${user.name.charAt(0)}</div>
                                        <div>
                                            <div class="user-name">${user.name}</div>
                                            <div class="user-email">${user.email || 'æœªè®¾ç½®'}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="role-badge ${roleClass}">${roleText}</span>
                                </td>
                                <td>
                                    <span class="status-badge ${statusClass}">${statusText}</span>
                                </td>
                                <td>ğŸ’° ${user.points || 0}</td>
                                <td>${new Date(user.registerTime).toLocaleDateString()}</td>
                                <td>${user.lastLoginTime ? new Date(user.lastLoginTime).toLocaleDateString() : 'ä»æœªç™»å½•'}</td>
                                <td>
                                    <div class="table-actions">
                                        <button class="table-action-btn edit" onclick="editUser('${user.id || user.username}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="table-action-btn add-points" onclick="AdminSystem.addUserPoints('${user.id || user.username}')" title="å¢åŠ ç§¯åˆ†">
                                            <i class="fas fa-plus"></i>
                                        </button>
                                        <button class="table-action-btn deduct-points" onclick="AdminSystem.deductUserPoints('${user.id || user.username}')" title="æ‰£é™¤ç§¯åˆ†">
                                            <i class="fas fa-minus"></i>
                                        </button>
                                        <button class="table-action-btn delete" onclick="deleteUser('${user.id || user.username}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('åŠ è½½ç”¨æˆ·è¡¨æ ¼å¤±è´¥:', error);
                }
            },
            
            // å¢åŠ ç”¨æˆ·ç§¯åˆ†
            async addUserPoints(userId) {
                const amount = prompt('è¯·è¾“å…¥è¦å¢åŠ çš„ç§¯åˆ†æ•°é‡:');
                if (amount === null) return;
                const numAmount = parseFloat(amount);
                if (isNaN(numAmount) || numAmount <= 0) {
                    this.showNotification('error', 'é”™è¯¯', 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ­£æ•°');
                    return;
                }

                const reason = prompt('è¯·è¾“å…¥æ“ä½œåŸå› ï¼ˆå¯é€‰ï¼‰:') || 'ç®¡ç†å‘˜å¢åŠ ç§¯åˆ†';

                try {
                    const result = await window.pointsSystem.adminUpdateUserPoints(userId, numAmount, reason);
                    if (result.success) {
                        this.showNotification('success', 'æˆåŠŸ', `å·²ä¸ºç”¨æˆ·å¢åŠ  ${numAmount} ç§¯åˆ†`);
                        this.loadUsersTable(); // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.updateStats(); // æ›´æ–°ç»Ÿè®¡
                        this.loadSystemData(); // é‡æ–°åŠ è½½æ•°æ®
                    } else {
                        this.showNotification('error', 'å¤±è´¥', result.error);
                    }
                } catch (error) {
                    this.showNotification('error', 'å¤±è´¥', 'æ“ä½œå¤±è´¥: ' + error.message);
                }
            },

            // æ‰£é™¤ç”¨æˆ·ç§¯åˆ†
            async deductUserPoints(userId) {
                const amount = prompt('è¯·è¾“å…¥è¦æ‰£é™¤çš„ç§¯åˆ†æ•°é‡:');
                if (amount === null) return;
                const numAmount = parseFloat(amount);
                if (isNaN(numAmount) || numAmount <= 0) {
                    this.showNotification('error', 'é”™è¯¯', 'è¯·è¾“å…¥æœ‰æ•ˆçš„æ­£æ•°');
                    return;
                }

                const reason = prompt('è¯·è¾“å…¥æ“ä½œåŸå› ï¼ˆå¯é€‰ï¼‰:') || 'ç®¡ç†å‘˜æ‰£é™¤ç§¯åˆ†';

                try {
                    const result = await window.pointsSystem.adminUpdateUserPoints(userId, -numAmount, reason);
                    if (result.success) {
                        this.showNotification('success', 'æˆåŠŸ', `å·²ä¸ºç”¨æˆ·æ‰£é™¤ ${numAmount} ç§¯åˆ†`);
                        this.loadUsersTable(); // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.updateStats(); // æ›´æ–°ç»Ÿè®¡
                        this.loadSystemData(); // é‡æ–°åŠ è½½æ•°æ®
                    } else {
                        this.showNotification('error', 'å¤±è´¥', result.error);
                    }
                } catch (error) {
                    this.showNotification('error', 'å¤±è´¥', 'æ“ä½œå¤±è´¥: ' + error.message);
                }
            },
            
            // åŠ è½½è®¢å•è¡¨æ ¼
            loadOrdersTable() {
                try {
                    const tableBody = document.getElementById('ordersTableBody');
                    if (!tableBody) return;
                    
                    if (this.systemData.orders.length === 0) {
                        tableBody.innerHTML = `
                            <tr>
                                <td colspan="9" style="text-align: center; padding: 2rem;">
                                    <i class="fas fa-shopping-cart" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                                    <p>æš‚æ— è®¢å•æ•°æ®</p>
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    tableBody.innerHTML = this.systemData.orders.map(order => {
                        return `
                            <tr>
                                <td>${order.id}</td>
                                <td>${order.buyer}</td>
                                <td>${order.item}</td>
                                <td>${order.quantity}</td>
                                <td>ğŸ’° ${order.totalPrice}</td>
                                <td>
                                    <span class="status-badge active">${order.status}</span>
                                </td>
                                <td>${new Date(order.timestamp).toLocaleDateString()}</td>
                                <td>
                                    <div class="table-actions">
                                        <button class="table-action-btn" onclick="viewOrder('${order.id}')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="table-action-btn delete" onclick="deleteOrder('${order.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('åŠ è½½è®¢å•è¡¨æ ¼å¤±è´¥:', error);
                }
            },
            
            // åŠ è½½å•†å“è¡¨æ ¼
            loadProductsTable() {
                try {
                    const tableBody = document.getElementById('productsTableBody');
                    if (!tableBody) return;
                    
                    if (this.systemData.products.length === 0) {
                        tableBody.innerHTML = `
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 2rem;">
                                    <i class="fas fa-box" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                                    <p>æš‚æ— å•†å“æ•°æ®</p>
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    tableBody.innerHTML = this.systemData.products.map(product => {
                        return `
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 1.5rem;">${product.icon}</span>
                                        <div>
                                            <div style="font-weight: 600; color: white;">${product.name}</div>
                                            <div style="font-size: 0.8rem; color: var(--text-light);">${product.description}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>${product.category}</td>
                                <td>ğŸ’° ${product.price}</td>
                                <td>${product.stock}</td>
                                <td>
                                    <span class="status-badge active">${product.status}</span>
                                </td>
                                <td>${new Date(product.createdAt).toLocaleDateString()}</td>
                                <td>
                                    <div class="table-actions">
                                        <button class="table-action-btn edit" onclick="editProduct('${product.id}')">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button class="table-action-btn delete" onclick="deleteProduct('${product.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('åŠ è½½å•†å“è¡¨æ ¼å¤±è´¥:', error);
                }
            },
            
            // åŠ è½½å¸‚åœºè¡¨æ ¼
            loadMarketTable() {
                try {
                    const tableBody = document.getElementById('marketTableBody');
                    if (!tableBody) return;
                    
                    if (this.systemData.marketItems.length === 0) {
                        tableBody.innerHTML = `
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 2rem;">
                                    <i class="fas fa-store" style="font-size: 2rem; margin-bottom: 0.5rem; opacity: 0.5;"></i>
                                    <p>æš‚æ— å¸‚åœºæ•°æ®</p>
                                </td>
                            </tr>
                        `;
                        return;
                    }
                    
                    tableBody.innerHTML = this.systemData.marketItems.map(item => {
                        return `
                            <tr>
                                <td>
                                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                                        <span style="font-size: 1.5rem;">${item.icon}</span>
                                        <div>
                                            <div style="font-weight: 600; color: white;">${item.name}</div>
                                            <div style="font-size: 0.8rem; color: var(--text-light);">${item.description}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>${item.seller}</td>
                                <td>ğŸ’° ${item.price}</td>
                                <td>${item.quantity}</td>
                                <td>
                                    <span class="status-badge ${item.status}">${item.status}</span>
                                </td>
                                <td>${new Date(item.publishTime).toLocaleDateString()}</td>
                                <td>
                                    <div class="table-actions">
                                        <button class="table-action-btn" onclick="viewMarketItem('${item.id}')">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="table-action-btn delete" onclick="deleteMarketItem('${item.id}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('åŠ è½½å¸‚åœºè¡¨æ ¼å¤±è´¥:', error);
                }
            },
            
            // åˆ·æ–°ç»Ÿè®¡æ•°æ®
            refreshStats() {
                try {
                    this.loadSystemData();
                    this.updateStats();
                    this.showNotification('success', 'åˆ·æ–°æˆåŠŸ', 'ç»Ÿè®¡æ•°æ®å·²æ›´æ–°');
                } catch (error) {
                    console.error('åˆ·æ–°ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // å¯¼å‡ºç»Ÿè®¡æ•°æ®
            exportStats() {
                try {
                    const stats = {
                        totalUsers: this.systemData.users.length,
                        totalOrders: this.systemData.orders.length,
                        totalProducts: this.systemData.products.length,
                        totalMarketItems: this.systemData.marketItems.length,
                        totalRevenue: this.systemData.orders.reduce((sum, order) => sum + (order.totalPrice || 0), 0),
                        todayActive: this.systemData.users.filter(user => {
                            const lastLogin = user.lastLoginTime ? new Date(user.lastLoginTime).toDateString() : '';
                            return lastLogin === new Date().toDateString();
                        }).length,
                        exportTime: new Date().toISOString()
                    };
                    
                    const dataStr = JSON.stringify(stats, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `stats_${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showNotification('success', 'å¯¼å‡ºæˆåŠŸ', 'ç»Ÿè®¡æ•°æ®å·²å¯¼å‡º');
                } catch (error) {
                    console.error('å¯¼å‡ºç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // æ·»åŠ ç”¨æˆ·
            addUser() {
                try {
                    this.showNotification('info', 'æ·»åŠ ç”¨æˆ·', 'æ·»åŠ ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...');
                } catch (error) {
                    console.error('æ·»åŠ ç”¨æˆ·å¤±è´¥:', error);
                }
            },
            
            // ç¼–è¾‘ç”¨æˆ·
            editUser(userId) {
                try {
                    this.showNotification('info', 'ç¼–è¾‘ç”¨æˆ·', 'ç¼–è¾‘ç”¨æˆ·åŠŸèƒ½å¼€å‘ä¸­...');
                } catch (error) {
                    console.error('ç¼–è¾‘ç”¨æˆ·å¤±è´¥:', error);
                }
            },
            
            // åˆ é™¤ç”¨æˆ·
            deleteUser(userId) {
                try {
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥ç”¨æˆ·å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        // ä»ç³»ç»Ÿæ•°æ®ä¸­åˆ é™¤ç”¨æˆ·
                        this.systemData.users = this.systemData.users.filter(user => (user.id && user.id !== userId) || (user.username && user.username !== userId));
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('allUsers', JSON.stringify(this.systemData.users));
                        
                        // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.loadUsersTable();
                        
                        // æ›´æ–°ç»Ÿè®¡
                        this.updateStats();
                        
                        this.showNotification('success', 'åˆ é™¤æˆåŠŸ', 'ç”¨æˆ·å·²åˆ é™¤');
                    }
                } catch (error) {
                    console.error('åˆ é™¤ç”¨æˆ·å¤±è´¥:', error);
                }
            },
            
            // æ·»åŠ å•†å“
            addProduct() {
                try {
                    this.showNotification('info', 'æ·»åŠ å•†å“', 'æ·»åŠ å•†å“åŠŸèƒ½å¼€å‘ä¸­...');
                } catch (error) {
                    console.error('æ·»åŠ å•†å“å¤±è´¥:', error);
                }
            },
            
            // ç¼–è¾‘å•†å“
            editProduct(productId) {
                try {
                    this.showNotification('info', 'ç¼–è¾‘å•†å“', 'ç¼–è¾‘å•†å“åŠŸèƒ½å¼€å‘ä¸­...');
                } catch (error) {
                    console.error('ç¼–è¾‘å•†å“å¤±è´¥:', error);
                }
            },
            
            // åˆ é™¤å•†å“
            deleteProduct(productId) {
                try {
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥å•†å“å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        // ä»ç³»ç»Ÿæ•°æ®ä¸­åˆ é™¤å•†å“
                        this.systemData.products = this.systemData.products.filter(product => product.id !== productId);
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('mallProducts', JSON.stringify(this.systemData.products));
                        
                        // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.loadProductsTable();
                        
                        // æ›´æ–°ç»Ÿè®¡
                        this.updateStats();
                        
                        this.showNotification('success', 'åˆ é™¤æˆåŠŸ', 'å•†å“å·²åˆ é™¤');
                    }
                } catch (error) {
                    console.error('åˆ é™¤å•†å“å¤±è´¥:', error);
                }
            },
            
            // æŸ¥çœ‹è®¢å•
            viewOrder(orderId) {
                try {
                    const order = this.systemData.orders.find(o => o.id === orderId);
                    if (order) {
                        this.showNotification('info', 'è®¢å•è¯¦æƒ…', `
                            è®¢å•ç¼–å·ï¼š${order.id}
                            ä¹°å®¶ï¼š${order.buyer}
                            å•†å“ï¼š${order.item}
                            æ•°é‡ï¼š${order.quantity}
                            æ€»ä»·ï¼š${order.totalPrice}
                            çŠ¶æ€ï¼š${order.status}
                            ä¸‹å•æ—¶é—´ï¼š${new Date(order.timestamp).toLocaleString()}
                        `);
                    }
                } catch (error) {
                    console.error('æŸ¥çœ‹è®¢å•å¤±è´¥:', error);
                }
            },
            
            // åˆ é™¤è®¢å•
            deleteOrder(orderId) {
                try {
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥è®¢å•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        // ä»ç³»ç»Ÿæ•°æ®ä¸­åˆ é™¤è®¢å•
                        this.systemData.orders = this.systemData.orders.filter(order => order.id !== orderId);
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('userOrders', JSON.stringify(this.systemData.orders));
                        
                        // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.loadOrdersTable();
                        
                        // æ›´æ–°ç»Ÿè®¡
                        this.updateStats();
                        
                        this.showNotification('success', 'åˆ é™¤æˆåŠŸ', 'è®¢å•å·²åˆ é™¤');
                    }
                } catch (error) {
                    console.error('åˆ é™¤è®¢å•å¤±è´¥:', error);
                }
            },
            
            // æŸ¥çœ‹å¸‚åœºå•†å“
            viewMarketItem(itemId) {
                try {
                    const item = this.systemData.marketItems.find(i => i.id === itemId);
                    if (item) {
                        this.showNotification('info', 'å•†å“è¯¦æƒ…', `
                            å•†å“åç§°ï¼š${item.name}
                            å–å®¶ï¼š${item.seller}
                            ä»·æ ¼ï¼š${item.price}
                            æ•°é‡ï¼š${item.quantity}
                            çŠ¶æ€ï¼š${item.status}
                            å‘å¸ƒæ—¶é—´ï¼š${new Date(item.publishTime).toLocaleString()}
                        `);
                    }
                } catch (error) {
                    console.error('æŸ¥çœ‹å¸‚åœºå•†å“å¤±è´¥:', error);
                }
            },
            
            // åˆ é™¤å¸‚åœºå•†å“
            deleteMarketItem(itemId) {
                try {
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¯¥å¸‚åœºå•†å“å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        // ä»ç³»ç»Ÿæ•°æ®ä¸­åˆ é™¤å¸‚åœºå•†å“
                        this.systemData.marketItems = this.systemData.marketItems.filter(item => item.id !== itemId);
                        
                        // ä¿å­˜åˆ°localStorage
                        localStorage.setItem('marketItems', JSON.stringify(this.systemData.marketItems));
                        
                        // é‡æ–°åŠ è½½è¡¨æ ¼
                        this.loadMarketTable();
                        
                        // æ›´æ–°ç»Ÿè®¡
                        this.updateStats();
                        
                        this.showNotification('success', 'åˆ é™¤æˆåŠŸ', 'å¸‚åœºå•†å“å·²åˆ é™¤');
                    }
                } catch (error) {
                    console.error('åˆ é™¤å¸‚åœºå•†å“å¤±è´¥:', error);
                }
            },
            
            // åˆå§‹åŒ–ç³»ç»Ÿæ—¥å¿—
            initSystemLogs() {
                try {
                    // æ·»åŠ åˆå§‹åŒ–æ—¥å¿—
                    this.addLog('info', 'ç³»ç»Ÿå¯åŠ¨', 'ç®¡ç†åå°ç³»ç»Ÿå·²å¯åŠ¨');
                    
                    // æ˜¾ç¤ºæ—¥å¿—
                    this.refreshLogs();
                } catch (error) {
                    console.error('åˆå§‹åŒ–ç³»ç»Ÿæ—¥å¿—å¤±è´¥:', error);
                }
            },
            
            // æ·»åŠ æ—¥å¿—
            addLog(level, message, data = {}) {
                try {
                    const log = {
                        id: Date.now(),
                        level: level,
                        message: message,
                        data: data,
                        timestamp: new Date().toISOString()
                    };
                    
                    this.systemData.logs.push(log);
                    
                    // é™åˆ¶æ—¥å¿—æ•°é‡
                    if (this.systemData.logs.length > 1000) {
                        this.systemData.logs = this.systemData.logs.slice(-1000);
                    }
                    
                    // ä¿å­˜åˆ°localStorage
                    localStorage.setItem('systemLogs', JSON.stringify(this.systemData.logs));
                    
                    // å¦‚æœå½“å‰åœ¨æ—¥å¿—æ¿å—ï¼Œåˆ·æ–°æ˜¾ç¤º
                    if (this.currentSection === 'logs') {
                        this.refreshLogs();
                    }
                } catch (error) {
                    console.error('æ·»åŠ æ—¥å¿—å¤±è´¥:', error);
                }
            },
            
            // åˆ·æ–°æ—¥å¿—
            refreshLogs() {
                try {
                    const logsContent = document.getElementById('logsContent');
                    if (!logsContent) return;
                    
                    if (this.systemData.logs.length === 0) {
                        logsContent.innerHTML = `
                            <div class="log-entry">
                                <span class="log-time">[${new Date().toLocaleTimeString()}]</span>
                                <span class="log-level">INFO</span>
                                <span class="log-message">æš‚æ— æ—¥å¿—ä¿¡æ¯</span>
                            </div>
                        `;
                        return;
                    }
                    
                    // è·å–æœ€è¿‘çš„æ—¥å¿—
                    const recentLogs = this.systemData.logs.slice(-50).reverse();
                    
                    logsContent.innerHTML = recentLogs.map(log => {
                        const levelClass = log.level.toLowerCase();
                        return `
                            <div class="log-entry">
                                <span class="log-time">[${new Date(log.timestamp).toLocaleTimeString()}]</span>
                                <span class="log-level ${levelClass}">${log.level.toUpperCase()}</span>
                                <span class="log-message">${log.message}</span>
                            </div>
                        `;
                    }).join('');
                } catch (error) {
                    console.error('åˆ·æ–°æ—¥å¿—å¤±è´¥:', error);
                }
            },
            
            // æ¸…ç©ºæ—¥å¿—
            clearLogs() {
                try {
                    if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ—¥å¿—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        this.systemData.logs = [];
                        localStorage.setItem('systemLogs', JSON.stringify(this.systemData.logs));
                        this.refreshLogs();
                        this.showNotification('success', 'æ¸…ç©ºæˆåŠŸ', 'æ‰€æœ‰æ—¥å¿—å·²æ¸…ç©º');
                    }
                } catch (error) {
                    console.error('æ¸…ç©ºæ—¥å¿—å¤±è´¥:', error);
                }
            },
            
            // ä¸‹è½½æ—¥å¿—
            downloadLogs() {
                try {
                    const dataStr = JSON.stringify(this.systemData.logs, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `system_logs_${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showNotification('success', 'ä¸‹è½½æˆåŠŸ', 'æ—¥å¿—æ–‡ä»¶å·²ä¸‹è½½');
                } catch (error) {
                    console.error('ä¸‹è½½æ—¥å¿—å¤±è´¥:', error);
                }
            },
            
            // å¼€å§‹è‡ªåŠ¨åˆ·æ–°
            startAutoRefresh() {
                // æ¯30ç§’åˆ·æ–°ä¸€æ¬¡ç»Ÿè®¡æ•°æ®
                setInterval(() => {
                    if (this.currentSection === 'dashboard') {
                        this.updateStats();
                    }
                }, 30000);
            },
            
            // å¿«é€Ÿæ“ä½œåŠŸèƒ½
            backupData() {
                try {
                    const backup = {
                        users: this.systemData.users,
                        orders: this.systemData.orders,
                        products: this.systemData.products,
                        marketItems: this.systemData.marketItems,
                        logs: this.systemData.logs,
                        settings: this.systemSettings,
                        backupTime: new Date().toISOString()
                    };
                    
                    const dataStr = JSON.stringify(backup, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `backup_${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showNotification('success', 'å¤‡ä»½æˆåŠŸ', 'ç³»ç»Ÿæ•°æ®å·²å¤‡ä»½');
                } catch (error) {
                    console.error('å¤‡ä»½æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // æ¸…ç†ç¼“å­˜
            clearCache() {
                try {
                    // æ¸…ç†localStorageä¸­çš„è¿‡æœŸæ•°æ®
                    const keys = Object.keys(localStorage);
                    keys.forEach(key => {
                        if (key.startsWith('temp_') || key.startsWith('cache_')) {
                            localStorage.removeItem(key);
                        }
                    });
                    
                    this.showNotification('success', 'æ¸…ç†æˆåŠŸ', 'ç¼“å­˜å·²æ¸…ç†');
                } catch (error) {
                    console.error('æ¸…ç†ç¼“å­˜å¤±è´¥:', error);
                }
            },
            
            // æ¸…ç©ºæ‰€æœ‰æ•°æ®
            clearAllData() {
                try {
                    if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        // æ¸…ç©ºæ‰€æœ‰ç³»ç»Ÿæ•°æ®
                        this.systemData = {
                            users: [],
                            orders: [],
                            products: [],
                            marketItems: [],
                            logs: []
                        };
                        
                        // æ¸…ç©ºlocalStorage
                        localStorage.removeItem('allUsers');
                        localStorage.removeItem('userOrders');
                        localStorage.removeItem('mallProducts');
                        localStorage.removeItem('marketItems');
                        localStorage.removeItem('systemLogs');
                        
                        // é‡æ–°åŠ è½½æ˜¾ç¤º
                        this.loadSystemData();
                        this.updateStats();
                        
                        this.showNotification('success', 'æ¸…ç©ºæˆåŠŸ', 'æ‰€æœ‰æ•°æ®å·²æ¸…ç©º');
                    }
                } catch (error) {
                    console.error('æ¸…ç©ºæ‰€æœ‰æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // å¯¼å‡ºæ‰€æœ‰æ•°æ®
            exportAllData() {
                try {
                    const allData = {
                        users: this.systemData.users,
                        orders: this.systemData.orders,
                        products: this.systemData.products,
                        marketItems: this.systemData.marketItems,
                        logs: this.systemData.logs,
                        settings: this.systemSettings,
                        exportTime: new Date().toISOString()
                    };
                    
                    const dataStr = JSON.stringify(allData, null, 2);
                    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                    
                    const exportFileDefaultName = `all_data_${new Date().toISOString().split('T')[0]}.json`;
                    
                    const linkElement = document.createElement('a');
                    linkElement.setAttribute('href', dataUri);
                    linkElement.setAttribute('download', exportFileDefaultName);
                    linkElement.click();
                    
                    this.showNotification('success', 'å¯¼å‡ºæˆåŠŸ', 'æ‰€æœ‰æ•°æ®å·²å¯¼å‡º');
                } catch (error) {
                    console.error('å¯¼å‡ºæ‰€æœ‰æ•°æ®å¤±è´¥:', error);
                }
            },
            
            // ç³»ç»Ÿè®¾ç½®åŠŸèƒ½
            toggleMaintenance() {
                try {
                    this.systemSettings.maintenance = !this.systemSettings.maintenance;
                    
                    if (this.systemSettings.maintenance) {
                        this.addLog('warning', 'ç»´æŠ¤æ¨¡å¼', 'ç³»ç»Ÿå·²è¿›å…¥ç»´æŠ¤æ¨¡å¼');
                        this.showNotification('warning', 'ç»´æŠ¤æ¨¡å¼', 'ç³»ç»Ÿå·²è¿›å…¥ç»´æŠ¤æ¨¡å¼');
                    } else {
                        this.addLog('info', 'ç»´æŠ¤æ¨¡å¼', 'ç³»ç»Ÿå·²é€€å‡ºç»´æŠ¤æ¨¡å¼');
                        this.showNotification('info', 'ç»´æŠ¤æ¨¡å¼', 'ç³»ç»Ÿå·²é€€å‡ºç»´æŠ¤æ¨¡å¼');
                    }
                    
                    // ä¿å­˜è®¾ç½®
                    localStorage.setItem('systemSettings', JSON.stringify(this.systemSettings));
                } catch (error) {
                    console.error('åˆ‡æ¢ç»´æŠ¤æ¨¡å¼å¤±è´¥:', error);
                }
            },
            
            // åˆ‡æ¢è°ƒè¯•æ¨¡å¼
            toggleDebug() {
                try {
                    this.systemSettings.debug = !this.systemSettings.debug;
                    
                    if (this.systemSettings.debug) {
                        this.addLog('info', 'è°ƒè¯•æ¨¡å¼', 'ç³»ç»Ÿå·²è¿›å…¥è°ƒè¯•æ¨¡å¼');
                        this.showNotification('info', 'è°ƒè¯•æ¨¡å¼', 'ç³»ç»Ÿå·²è¿›å…¥è°ƒè¯•æ¨¡å¼');
                    } else {
                        this.addLog('info', 'è°ƒè¯•æ¨¡å¼', 'ç³»ç»Ÿå·²é€€å‡ºè°ƒè¯•æ¨¡å¼');
                        this.showNotification('info', 'è°ƒè¯•æ¨¡å¼', 'ç³»ç»Ÿå·²é€€å‡ºè°ƒè¯•æ¨¡å¼');
                    }
                    
                    // ä¿å­˜è®¾ç½®
                    localStorage.setItem('systemSettings', JSON.stringify(this.systemSettings));
                } catch (error) {
                    console.error('åˆ‡æ¢è°ƒè¯•æ¨¡å¼å¤±è´¥:', error);
                }
            },
            
            // ä¿å­˜è®¾ç½®
            saveSettings() {
                try {
                    this.addLog('info', 'ç³»ç»Ÿè®¾ç½®', 'ç³»ç»Ÿè®¾ç½®å·²ä¿å­˜');
                    this.showNotification('success', 'ä¿å­˜æˆåŠŸ', 'ç³»ç»Ÿè®¾ç½®å·²ä¿å­˜');
                } catch (error) {
                    console.error('ä¿å­˜è®¾ç½®å¤±è´¥:', error);
                }
            },
            
            // é‡ç½®è®¾ç½®
            resetSettings() {
                try {
                    if (confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                        this.systemSettings = {
                            maintenance: false,
                            debug: false,
                            logLevel: 'info'
                        };
                        
                        localStorage.setItem('systemSettings', JSON.stringify(this.systemSettings));
                        
                        this.addLog('warning', 'ç³»ç»Ÿè®¾ç½®', 'ç³»ç»Ÿè®¾ç½®å·²é‡ç½®');
                        this.showNotification('warning', 'é‡ç½®æˆåŠŸ', 'ç³»ç»Ÿè®¾ç½®å·²é‡ç½®');
                    }
                } catch (error) {
                    console.error('é‡ç½®è®¾ç½®å¤±è´¥:', error);
                }
            },
            
            // åŠ è½½è®¾ç½®
            loadSettings() {
                try {
                    const savedSettings = localStorage.getItem('systemSettings');
                    if (savedSettings) {
                        this.systemSettings = JSON.parse(savedSettings);
                    }
                } catch (error) {
                    console.error('åŠ è½½è®¾ç½®å¤±è´¥:', error);
                }
            },
            
            // é€€å‡ºç™»å½•
            logout() {
                try {
                    // ä½¿ç”¨ç”¨æˆ·ç³»ç»Ÿé€€å‡º
                    if (window.userSystem) {
                        window.userSystem.logout();
                    } else {
                        // å¤‡ç”¨æ–¹æ¡ˆ
                        localStorage.removeItem('isLoggedIn');
                        localStorage.removeItem('currentUser');
                        this.showNotification('info', 'é€€å‡ºç™»å½•', 'æ‚¨å·²æˆåŠŸé€€å‡ºç™»å½•');
                        setTimeout(() => {
                            window.location.href = 'login.html';
                        }, 1000);
                    }
                } catch (error) {
                    console.error('é€€å‡ºç™»å½•å¤±è´¥:', error);
                }
            },
            
            // æ˜¾ç¤ºé€šçŸ¥
            showNotification(type, title, message) {
                try {
                    // ç§»é™¤ç°æœ‰é€šçŸ¥
                    const existing = document.querySelector('.notification');
                    if (existing) existing.remove();
                    
                    // åˆ›å»ºæ–°é€šçŸ¥
                    const notification = document.createElement('div');
                    notification.className = `notification ${type}`;
                    notification.innerHTML = `
                        <div class="notification-icon">${type === 'success' ? 'âœ“' : type === 'error' ? 'âœ—' : 'â„¹ï¸'}</div>
                        <div class="notification-content">
                            <div class="notification-title">${title}</div>
                            <div class="notification-message">${message}</div>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    // æ˜¾ç¤ºåŠ¨ç”»
                    setTimeout(() => notification.classList.add('show'), 100);
                    
                    // è‡ªåŠ¨éšè—
                    setTimeout(() => {
                        notification.classList.remove('show');
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                } catch (error) {
                    console.error('æ˜¾ç¤ºé€šçŸ¥å¤±è´¥:', error);
                }
            }
        };
        
        // å…¨å±€å‡½æ•°
        function showSection(section) {
            AdminSystem.showSection(section);
        }
        
        function addUser() {
            AdminSystem.addUser();
        }
        
        function editUser(userId) {
            AdminSystem.editUser(userId);
        }
        
        function deleteUser(userId) {
            AdminSystem.deleteUser(userId);
        }
        
        function addProduct() {
            AdminSystem.addProduct();
        }
        
        function editProduct(productId) {
            AdminSystem.editProduct(productId);
        }
        
        function deleteProduct(productId) {
            AdminSystem.deleteProduct(productId);
        }
        
        function viewOrder(orderId) {
            AdminSystem.viewOrder(orderId);
        }
        
        function deleteOrder(orderId) {
            AdminSystem.deleteOrder(orderId);
        }
        
        function viewMarketItem(itemId) {
            AdminSystem.viewMarketItem(itemId);
        }
        
        function deleteMarketItem(itemId) {
            AdminSystem.deleteMarketItem(itemId);
        }
        
        function refreshStats() {
            AdminSystem.refreshStats();
        }
        
        function exportStats() {
            AdminSystem.exportStats();
        }
        
        function exportUsers() {
            AdminSystem.exportUsers();
        }
        
        function refreshOrders() {
            AdminSystem.refreshOrders();
        }
        
        function exportOrders() {
            AdminSystem.exportOrders();
        }
        
        function exportProducts() {
            AdminSystem.exportProducts();
        }
        
        function refreshMarket() {
            AdminSystem.refreshMarket();
        }
        
        function exportMarket() {
            AdminSystem.exportMarket();
        }
        
        function refreshLogs() {
            AdminSystem.refreshLogs();
        }
        
        function clearLogs() {
            AdminSystem.clearLogs();
        }
        
        function downloadLogs() {
            AdminSystem.downloadLogs();
        }
        
        function backupData() {
            AdminSystem.backupData();
        }
        
        function clearCache() {
            AdminSystem.clearCache();
        }
        
        function clearAllData() {
            AdminSystem.clearAllData();
        }
        
        function exportAllData() {
            AdminSystem.exportAllData();
        }
        
        function toggleMaintenance() {
            AdminSystem.toggleMaintenance();
        }
        
        function toggleDebug() {
            AdminSystem.toggleDebug();
        }
        
        function saveSettings() {
            AdminSystem.saveSettings();
        }
        
        function resetSettings() {
            AdminSystem.resetSettings();
        }
        
        function filterUsers() {
            AdminSystem.filterUsers();
        }
        
        function sortUsers() {
            AdminSystem.sortUsers();
        }
        
        function filterOrders() {
            AdminSystem.filterOrders();
        }
        
        function sortOrders() {
            AdminSystem.sortOrders();
        }
        
        function filterProducts() {
            AdminSystem.filterProducts();
        }
        
        function sortProducts() {
            AdminSystem.sortProducts();
        }
        
        function filterMarket() {
            AdminSystem.filterMarket();
        }
        
        function sortMarket() {
            AdminSystem.sortMarket();
        }
        
        function filterLogs(level) {
            AdminSystem.filterLogs(level);
        }
        
        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('=== ç®¡ç†åå°ç³»ç»Ÿåˆå§‹åŒ– ===');
            AdminSystem.init();
        });
    </script>
</body>
</html>